<?php $base_url = $this->config->item('base_url'); 

// Added By Nirav
if($transport_details['st_trans_type']=='P')
{
	$legs_filled=0;
	if(isset($leg_details) && !empty($leg_details)) 
	{
		foreach($leg_details as $key=>$value){
			/*if($value['route_type_id'] == '0' || $value['route_type_id'] == '1' || $value['route_type_id'] == '2' )
			{*/
				if($value['in_multi_user'] == '0')
				{
					if($value['participants_cnt'] != 0 || $value['non_doobert_participants_cnt'] != 0)
					{
						$legs_filled++;
					}
				} else if($value['in_multi_user'] == '1'){
					if($value['participants_cnt']  ==  $value['in_user_num'] || $value['non_doobert_participants_cnt'] == $value['in_user_num'] || ($value['participants_cnt'] + $value['non_doobert_participants_cnt']) ==  $value['in_user_num'])
					{
						$legs_filled++;
					}
				}
			/*}*/ 
		}
		$legs_covered =  $legs_filled/count($leg_details)*100;
	} else {	
		$legs_covered = 0;
	} 
}else{
	$legs_covered = ($transport_details['cover_dis_per']>100) ? "100" : $transport_details['cover_dis_per'];
}	
$cover_dist = ($transport_details['cover_dis_per']>100) ? "100" : $transport_details['cover_dis_per'];				

?>
<!DOCTYPE html>
<!--[if IE 8]> <html lang="en" class="ie8 no-js"> <![endif]-->
<!--[if IE 9]> <html lang="en" class="ie9 no-js"> <![endif]-->
<!--[if !IE]><!-->
<html lang="en" class="no-js">
<!--<![endif]-->
<!-- BEGIN HEAD -->
<head>
<meta charset="utf-8"/>
<title><?php echo $transport_details['st_org_name']; ?>'s Transportation - Doobert</title>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<meta content="" name="description"/>
<meta content="" name="author"/>
<?PHP include APPPATH."views/includes/head-links.php"; ?>

<!-- BEGIN PAGE LEVEL STYLES -->
<link rel="stylesheet" type="text/css" href="<?php echo $base_url; ?>assets/plugins/clockface/css/clockface.css"/>
<link rel="stylesheet" type="text/css" href="<?php echo $base_url; ?>assets/plugins/bootstrap-timepicker/css/bootstrap-timepicker.min.css"/>
<link rel="stylesheet" type="text/css" href="<?php echo $base_url; ?>assets/plugins/bootstrap-datetimepicker/css/datetimepicker.css"/>
<link rel="stylesheet" type="text/css" href="<?php echo $base_url; ?>assets/plugins/bootstrap-fileinput/bootstrap-fileinput.css"/>
<link rel="stylesheet" type="text/css" href="<?php echo $base_url; ?>assets/css/pages/timeline.css"/>
<link rel="stylesheet" type="text/css" href="<?php echo $base_url; ?>assets/css/animalvcard.css"/>
<link rel="stylesheet" type="text/css" href="<?php echo $base_url; ?>assets/plugins/bootstrap-datepicker/css/datepicker.css"/>
<link rel="stylesheet" type="text/css" href="<?php echo $base_url; ?>assets/plugins/bootstrap-daterangepicker/daterangepicker-bs3.css"/>
<?PHP include APPPATH."views/includes/fb_share_meta.php"; ?>
<!-- END PAGE LEVEL STYLES -->

<link rel="stylesheet" type="text/css" href="<?php echo base_url();  ?>assets/plugins/jquery-ui/jquery-ui-1.10.3.custom.min.css"/>
<script type="text/javascript">
var page_id = "<?php echo isset($legs_page)?$legs_page:"1"; ?>";
var start_li = '';
</script>
<script>
(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&appId=1402734139994869&version=v2.0";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));
</script>
</head>
<!-- BEGIN BODY -->
<body class="page-header-fixed transportations transportations-show">

<!--Menu Active Link-->
<?php $tab = 3; $subtab = 3.1; ?>

<!-- BEGIN HEADER -->
<?PHP include APPPATH."views/includes/head-content-login.php"; ?>
<!-- END HEADER -->
<?php //echo "<pre>";print_r($transport_details);die;;?>
<div class="clearfix"> </div>
<!-- BEGIN CONTAINER -->
<div class="page-container">
  <div class="row no-margin">   
  </div>
  <div class="clearfix"></div>
  <div class="row page-title-bg no-margin">
    <div class="pull-left inner-bg"> 
      <!-- BEGIN PAGE TITLE & BREADCRUMB-->
      <div class="col-lg-6 col-md-6 myaccount no-space">
        <h3 class="page-title"><?php echo $transport_details['st_org_name']; ?>'s Transportation</h3>
      </div>
      <div class="app-breadcrumb col-lg-6 col-md-6 no-space">
        <ul class="breadcrumb">
          <li><?php echo $transport_details['st_org_name']; ?>'s Transportation</li>
        </ul>
      </div>
      <!-- END PAGE TITLE & BREADCRUMB--> 
    </div>
  </div>
  <div class="clearfix"> </div>
  <!-- BEGIN HORIZONTAL MENU PAGE SIDEBAR -->
  <div class="page-sidebar-wrapper">
  </div>
  <!-- END BEGIN HORIZONTAL MENU PAGE SIDEBAR --> 
  <!-- BEGIN CONTENT -->
  
  <div class="page-content-wrapper">
    <div class="page-content marl0" id="create-legs"> 
      <!-- BEING PAGE CONTENT-->
      <div class="row content-wrapper marlr0">
        <div class="row dobt-form no-margin">
          <div class="gr-wrap col-lg-3 col-md-4 col-sm-12 column1 transport-btm-bdr" id="leftcolumn">
          <div class="transport-top-left-heading">
            <div class="id">#DBT<?php echo $transport_details['in_transportation_id'];?></div>
            <div class="calendar"><?php echo date("l, M d",strtotime($transport_details['dt_target']));?></div>
            <div class="clearfix"></div>
			</div>
			<div id="leftheight1">
			<div class="fromtolocation">
                <div class="row no-margin">
                  <div class="gr-wrap col-lg-12 col-md-12 col-sm-12">
                    <p class="trans-from-info"><span>From:</span> <?php echo ($transport_details['st_from_city']?$transport_details['st_from_city'].", ":"").($transport_details['st_from_state']?$transport_details['st_from_state'].", ":""); ?> on <span class="date"><?php echo date("M d",strtotime($transport_details['dt_pickup_date']));?></span></p>
                    <p class="trans-to-info"><span>To:</span> <?php echo ($transport_details['st_to_city']?$transport_details['st_to_city'].", ":"").($transport_details['st_to_state']?$transport_details['st_to_state'].", ":""); ?> on <span class="date"><?php echo date("M d",strtotime($transport_details['dt_target']));?></span></p>
                  </div>
                </div>
              </div>
			  
            <div class="milescovered">
			<i class="fa fa-thumbs-up"></i><span class="completed"><?php //echo $cover_dist = ($transport_details['cover_dis_per']>100) ? "100" : $transport_details['cover_dis_per'];?><?php echo number_format($legs_covered,"2",".","");  ?>%</span> of <?php echo number_format($transport_details['in_tot_distance'],"2",".","");?> miles covered</div>
            <div class="clearfix"></div>
             <?php $title = 'DOOBERT -Transportation #DBT'.htmlspecialchars($transport_details['in_transportation_id']);
					if($transport_details['perc']>0)
						{
							$transport_comp_perc = (($transport_details['perc']>100)? "100%":$transport_details['perc']."%");
						}
						else
						{
							$transport_comp_perc = "0%";
						}
						
						$description = "";
						
						$description .= date("l, M",strtotime($transport_details['dt_target']));
						$description .= date(" d",strtotime($transport_details['dt_target']));
						$description .= "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DBT".$transport_details['in_transportation_id']."&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;";
						$description .= "\r\n";
						$description .= $transport_details['st_from_street']? $this->common_function->custom_htmlentities($transport_details['st_from_street']).",":"";
						$description .= $transport_details['st_from_city']? $this->common_function->custom_htmlentities($transport_details['st_from_city']).",":"";
						$description .= $transport_details['st_from_state']? $this->common_function->custom_htmlentities($transport_details['st_from_state']).",":"";
						$description .= $transport_details['st_from_zip']? $this->common_function->custom_htmlentities($transport_details['st_from_zip']).",":"";
						$description .= ' to ';
						$description .= $transport_details['st_to_street']? $this->common_function->custom_htmlentities($transport_details['st_to_street']).",":"";
						$description .= $transport_details['st_to_city']? $this->common_function->custom_htmlentities($transport_details['st_to_city']).",":"";
						$description .= $transport_details['st_to_state']? $this->common_function->custom_htmlentities($transport_details['st_to_state']).",":"";
						$description .= $transport_details['st_to_zip']? $this->common_function->custom_htmlentities($transport_details['st_to_zip']).",":"";
						$description .= "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;";
						$description .= "\r\n";
						$description .= $transport_comp_perc ." of ".($transport_details['in_tot_distance']!=''? $transport_details['in_tot_distance']:"0").'miles covered.';
						
						$description_str = str_replace('&nbsp;',' ',$description);
						$description_str = str_replace(array("\r\n","\r","\n"), "<br>",$description_str);
						
						$UrlTopass_t  =  base_url()."org-transportation-scheduled/".$transport_details['in_transportation_id'];
						
						if($transport_details['st_org_image']!='' && file_exists($this->config->item('upload')."org_doc/".$transport_details['st_org_image']))
						{
						  $fb_image  = $this->config->item('upload_url')."org_doc/".$transport_details['st_org_image'];
						}
						else
						{
							$fb_image  = base_url()."assets/img/fb-doobert-logo.jpg"; 
						}
						
						//$UrlTopass  = base_url()."org_transportation/share_transport/".$transport_details['in_transportation_id'];
				
				?>
                
              <div class="transport-share floatl marl14">
            <span class="share-on">Share on: </span><br>
            <span class="fb-icon"><div class="share-wrap">
            <div class="fb-share-button" data-href="<?php echo $UrlTopass_t;?>" data-width="100px" data-height="100px" data-type="button" data-action="recommend" data-show-faces="true" data-share="true"></div>
			</div></span>
            
           
                </span> <span class="twitter-icon">
             <a href="https://twitter.com/share" class="twitter-share-button" data-count="none" data-url="<?php echo base_url().'org-transportation-scheduled/'.$transport_details['in_transportation_id']; ?>" data-title="<?php echo $title; ?>" data-text="<?php echo $description; ?>"></a>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
				 </span> <span> 
				 <script type="text/javascript">
							  window.___gcfg = {
							  lang: 'en-US',
							  parsetags: 'onload'
							  };
							</script>
							<script src="https://apis.google.com/js/client:platform.js" async defer></script>
										
									  <a class="g-interactivepost" data-contenturl="<?php echo base_url().'org-transportation-scheduled/'.$transport_details['in_transportation_id']; ?>" data-clientid="424502894030-f5b5hcso2c4pr57dkh0fsu1eicg6dmj7.apps.googleusercontent.com"
									  data-cookiepolicy="single_host_origin"                     
									  data-calltoactionurl="<?php echo base_url().'org-transportation-scheduled/'.$transport_details['in_transportation_id']; ?>"
                                      data-prefilltext="<?php echo $description; ?>">
									  <img src="<?php echo base_url(); ?>assets/img/G-Plus.jpg" alt="G-Plus" title="G-Plus" /></a>
								  
							</script>
                         </span> <span>   
                            <a href="javascript:void(0)" onClick="$('#share_transport_id').val('<?php echo $transport_details['in_transportation_id']; ?>');$('#txtsubject').val('<?php echo $title; ?>');display_share_email_popup();" data-toggle="modal" class="marl5"><img src="<?php echo base_url(); ?>assets/img/mail.jpg" alt="Email" title="Email" /></a></span></div>
              
              
            
            <div class="clearfix"></div>
            
			<div class="recommend-changes-info">
			
				<a href="javascript:void(0);" class="btn pink" id="recommend-legs">Recommend Changes to Animal Rescue Legs</a>
				<?php if ($transport_details['st_trans_type']=='D') { ?> 
                <a class="btn light-green sign-up-legs-btn" href="<?php echo base_url(); ?>">SignUp for Legs</a>
				<?php } ?>
                <p class="suggestion-text">Are you an animal rescue pilot that can fly them further?  Do you have ideas for a better routing or different legs that the transport coordinator should consider?  Click to let them know your suggestions</p>
                <div id="recommend-own-box" style="display:none;">
                	<h3><i class="fa fa-road"></i> Recommend Own Leg</h3>
                    <div class="leg-type">
                    <div class="radio-list">
                    <ul>
                    <li class="leg-type-label">Leg Type? <span class="required-filed">*</span></li>
                    	<li><label class="radio-inline" for="legground">
                        <input type="radio" name="legtype" id="legground" value="1" checked >Ground Leg</label>
                        </li>
                        <li><label class="radio-inline" for="legaviation">
                        <input type="radio" name="legtype" id="legaviation" value="2">Aviation Leg</label></li>
                    </ul></div>
                    </div>
					
					<form class="horizontal-form" role="form" name="recommend_leg" id="recommend_leg" action="<?php echo base_url() ?>org_transportation/recommend_leg" method="post">
						
						<?php /*
						<div id="zip-search" class="modal fade" tabindex="-1" aria-hidden="true">
						<input type="hidden" class="form-control" id="pick_zip" name="pick_zip" maxlength="50" value="">
						  <input type="hidden" class="form-control" id="pick_country" name="pick_country" maxlength="50" value="">
						  <div class="modal-dialog">
							<div class="modal-content">
							  <div class="modal-body">
								<button type="button" class="close" data-dismiss="modal" aria-hidden="true" title="Close"></button>
								<div class="scroller" style="height:200px" data-always-visible="1" data-rail-visible1="1">
								  <p>Don't know the zip code? Search for it here</p>
								  <div class="form-group">
									<input type="text" placeholder="Enter City Name" id="pick_city" name="pick_city" maxlength="50" value="" class="form-control">
								  </div>
								  <div class="form-group">
									<select id="pickup_state" name="pickup_state" class="form-control">
									  <option value="">Select State</option>
									  <optgroup label="USA States">
									  <?php
																					foreach($state_list as $key1=>$value1)
																					{
																					?>
									  <option value="<?php echo $key1;?>"><?php echo $value1;?></option>
									  <?php   
																				   }
																				?>
									  </optgroup>
									  <optgroup label="CANADA States">
									  <?php
																					foreach($c_state_list as $key1=>$value1)
																					{
																					?>
									  <option value="<?php echo $key1;?>"><?php echo $value1;?></option>
									  <?php   
																				   }
																				?>
									  </optgroup>
									</select>
								  </div>
								  <div class="form-group">
									<button type="button" class="btn search-btn" title="Search" onClick="get_zipcode('pick_city','pickup_state','popup_zipcode','pick_country');">Search</button>
									<div id="popup_zip_div">
									  <input type="text" placeholder="Zip code will appear here" class="form-control display-zipcode" id="popup_zipcode" name="popup_zipcode" readonly>
									</div>
								  </div>
								</div>
							  </div>
							  <div class="modal-footer">
								<button type="button" class="btn light-green" id="origin_zipcode" name="origin_zipcode" onClick="change_origin_details();">Select as Origin Zip Code</button>
								<button type="button" class="btn light-green" id="destination_zipcode" name="destination_zipcode" onClick="change_destination_details();" style="display:none;">Select as Destination Zip Code</button>
							  </div>
							</div>
						  </div>
						</div>
						
						
						<div id="drop-zip-search" class="modal fade" tabindex="-1" aria-hidden="true">
						
						  <div class="modal-dialog">
							<div class="modal-content">
							  <div class="modal-body">
							  <input type="hidden" class="form-control" id="drop_zip" name="drop_zip" maxlength="50" value="">
						  <input type="hidden" class="form-control" id="drop_country" name="drop_country" maxlength="50" value="">
								<button type="button" class="close" data-dismiss="modal" aria-hidden="true" title="Close"></button>
								<div class="scroller" style="height:200px" data-always-visible="1" data-rail-visible1="1">
								  <p>Don't know the zip code? Search for it here</p>
								  <div class="form-group">
									<input type="text" placeholder="Enter City Name" id="drop_city" name="drop_city" maxlength="50" value="" class="form-control">
								  </div>
								  <div class="form-group">
									<select id="drop_state" name="drop_state" class="form-control">
									  <option value="">Select State</option>
									  <optgroup label="USA States">
									  <?php
																					foreach($state_list as $key1=>$value1)
																					{
																					?>
									  <option value="<?php echo $key1;?>"><?php echo $value1;?></option>
									  <?php   
																				   }
																				?>
									  </optgroup>
									  <optgroup label="CANADA States">
									  <?php
																					foreach($c_state_list as $key1=>$value1)
																					{
																					?>
									  <option value="<?php echo $key1;?>"><?php echo $value1;?></option>
									  <?php   
																				   }
																				?>
									  </optgroup>
									</select>
								  </div>
								  <div class="form-group">
									<button type="button" class="btn search-btn" title="Search" onClick="get_zipcode_drop('drop_city','drop_state','popup_zipcode_drop','drop_country');">Search</button>
									<div id="popup_zip_div_drop">
									  <input type="text" placeholder="Zip code will appear here" class="form-control display-zipcode" id="popup_zipcode_drop" name="popup_zipcode_drop" readonly>
									</div>								
									
								  </div>
								</div>
							  </div>
							  <div class="modal-footer">	
								<button type="button" class="btn light-green" id="destination_zipcode" name="destination_zipcode" onClick="change_destination_details();">Select as Destination Zip Code</button>
							  </div>
							</div>
						  </div>
						</div>
						<?php */ ?>
						
					<input type="hidden" id="recommend_transport_id" name="recommend_transport_id" value="<?php echo isset($transport_details['in_transportation_id']) && $transport_details['in_transportation_id'] != '' ? $transport_details['in_transportation_id'] : '' ; ?>">
					<input type="hidden" id="recommend_user_id" name="recommend_user_id" value="<?php echo ($this->session->userdata('userid')) ? $this->session->userdata('userid') : '' ; ?>">
                    <div id="ground-leg">
                    
                    <div class="form-group">
                              <label class="control-label" for="pick-up-location">Pick Up Location: <span class="required-filed">*</span></label>
                              <input type="text" class="form-control" id="pick_up_location" name="pick_up_location" value=""  placeholder="Enter From City, State or Zip">
                              <!--<span>Don't know the zip code? <a href="#zip-search" data-toggle="modal" id="p_zip_search" onClick="$('#pick_city').val('');$('#pick_state').val('');$('#popup_zipcode').val('');$('#zipcode_list').val('');$('#zipcode_list').hide();$('#origin_zipcode').show();$('#destination_zipcode').hide();$('#popup_zip_div').show();">Click here to search</a></span>-->
                    </div>
                            
                    <div class="form-group">
                    <input type="text" class="form-control" id="pick_street" name="pick_street" value="" maxlength="250" placeholder="Street Address">
                    </div>
                    
                    
                   <div class="form-group">
                   <label class="control-label" for="drop-off-location">Drop Off Location: <span class="required-filed">*</span></label>
                              <input type="text" class="form-control" id="drop_off_location" name="drop_off_location" value="" maxlength="250" placeholder="Enter To City, State or Zip">
                             <!-- <span>Don't know the zip code? <a href="#drop-zip-search" data-toggle="modal" id="d_zip_search" onClick="$('#pick_city').val('');$('#pick_state').val('');$('#popup_zipcode').val('');$('#zipcode_list').val('');$('#zipcode_list').hide();$('#origin_zipcode').hide();$('#destination_zipcode').show();$('#popup_zip_div').show();">Click here to search</a></span>-->
                   </div>
                            
                    <div class="form-group">
                    <input type="text" class="form-control" id="drop_street" name="drop_street" value="" maxlength="250" placeholder="Street Address">
                    </div> 
					<?php if(!$this->session->userdata('userid')) { ?>
					<div class="form-group">
                    <label class="control-label" for="contact-name">Contact Details: <span class="required-filed">*</span></label>
                    <input type="text" class="form-control marb10" id="contact_name" name="contact_name" value="" maxlength="250" placeholder="Your Name">
                    <input type="text" class="form-control" id="contact_email" name="contact_email" value="" maxlength="250" placeholder="Your Email Address">
                    </div> 
					<?php } ?>
                    <div class="form-group padb5">
                    <label for="note-comments">Notes/Comments:</label>
                    <textarea rows="5" name="note-comments" id="note-comments" class="form-control" placeholder=""></textarea>
                    </div> 
                    <!--<a href="#thanku-suggest-leg" data-toggle="modal" class="btn pink sugest-leg-btn" title="Suggest Leg">Suggest Leg</a>-->
					<button class="btn pink sugest-leg-btn" title="Suggest Leg" type="submit" id="suggest_leg">Suggest Leg</button>
                    <a href="javascript:void(0);" class="btn gray" title="Cancel" id="cancel_recommend">Cancel</a>  
                    </div>
					<input type="hidden" value="suggest_leg" name="action_recommend" id="action_recommend" />
					</form>
					
					<form class="horizontal-form" role="form" name="recommend_leg_avia" id="recommend_leg_avia" action="<?php echo base_url() ?>org_transportation/recommend_leg_avia" method="post">
					<input type="hidden" id="recommend_transport_id_avia" name="recommend_transport_id_avia" value="<?php echo isset($transport_details['in_transportation_id']) && $transport_details['in_transportation_id'] != '' ? $transport_details['in_transportation_id'] : '' ; ?>">
					<input type="hidden" id="recommend_user_id_avia" name="recommend_user_id_avia" value="<?php echo ($this->session->userdata('userid')) ? $this->session->userdata('userid') : '' ; ?>">
					
					<div id="aviation-leg" style="display:none;">
                    <div class="form-group">
                              <label class="control-label" for="pickup_airport">From Location/Airport ID: <span class="required-filed">*</span></label>
                              <input type="text" class="form-control" id="pickup_airport" name="pickup_airport" value="" maxlength="250" placeholder="Enter From City, State or Zip/Airport ID">
							   <input type="hidden" id="pickup_airport_city" name="pickup_airport_city" maxlength="50">
                              <input type="hidden" id="pickup_airport_state" name="pickup_airport_state" maxlength="50">
                              <!--<span>Don't know the zip code? <a href="javascript:void(0);">Click here to search</a></span>-->
                            </div>
                    <div class="form-group">
                              <label class="control-label" for="dropoff_airport">To Location/Airport ID: <span class="required-filed">*</span></label>
                              <input type="text" class="form-control" id="dropoff_airport" name="dropoff_airport" value="" maxlength="250" placeholder="Enter To City, State or Zip/Airport ID">
							  <input type="hidden" id="dropoff_airport_city" name="dropoff_airport_city" maxlength="50">
                              <input type="hidden" id="dropoff_airport_state" name="dropoff_airport_state" maxlength="50">
                              <!--<span>Don't know the zip code? <a href="javascript:void(0);">Click here to search</a></span>-->
                            </div>
					<?php if(!$this->session->userdata('userid')) { ?>		
                    <div class="form-group">
                    <label class="control-label" for="contact-name">Contact Details: <span class="required-filed">*</span></label>
                    <input type="text" class="form-control marb10" id="contact_name_avia" name="contact_name_avia" value="" maxlength="250" placeholder="Your Name">
                    <input type="text" class="form-control" id="contact_email_avia" name="contact_email_avia" value="" maxlength="250" placeholder="Your Email Address">
                    </div> 
					<?php } ?>
                    <div class="form-group padb5">
                    <label for="note-comments1">Notes/Comments:</label>
                    <textarea rows="5" name="note_comments_avia" id="note_comments_avia" class="form-control" placeholder=""></textarea>
                    </div> 
                    <!--<a href="#thanku-suggest-leg" data-toggle="modal" class="btn pink sugest-leg-btn suggest_leg" title="Suggest Leg">Suggest Leg</a>-->
					<button class="btn pink sugest-leg-btn" title="Suggest Leg" type="submit" id="suggest_leg_aviation">Suggest Leg</button>
                    <a href="javascript:void(0);" class="btn gray" title="Cancel" id="cancel_recommend_avia">Cancel</a>  
                    </div> 
					<input type="hidden" value="suggest_leg_aviation" name="action_recommend_avia" id="action_recommend_avia" />
					</form>					
                </div>
             </div>
            <div class="animal-block1">
                <h2>Animal(s) Rescued in this Transportation</h2>
				<ul>
				<?php if(isset($transport_animals) && !empty($transport_animals)){ ?>	
				<?php for($a=0;$a<count($transport_animals);$a++)
					 {
						if(isset($transport_animals[$a]) && !empty($transport_animals[$a])){
							$link_name 	= $this->common_function->get_filtered_name($transport_animals[$a]['st_animal_name']);
							$url_link 	= base_url()."animal-".$transport_animals[$a]['in_animal_id']."-".$link_name."/";		
				?>
				    <?php $st_file_name = $this->common_model->get_animal_photo($transport_animals[$a]['in_animal_id']);
	  
                      if($st_file_name!='' && file_exists($this->config->item('upload')."animal_images/140x140/".$st_file_name))
                      {
                          $image_url  = $this->config->item('upload_url')."animal_images/140x140/".$st_file_name;
                      }
                      else
                      {
                          $image_url  = $this->config->item('upload_url')."animal_images/140x140/no_photo_icon.png";
                      }
					?>
					  <?php 
						if(file_exists($this->config->item('upload')."demeanor/31x31/".$transport_animals[$a]['st_demeanor_image']) && file_exists($this->config->item('upload')."demeanor/60x60/".$transport_animals[$a]['st_demeanor_image']))
						{
								$demenor_url = $this->config->item('upload_url')."demeanor/31x31/".$transport_animals[$a]['st_demeanor_image'];
								$demenor_thumb_url = $this->config->item('upload_url')."demeanor/60x60/".$transport_animals[$a]['st_demeanor_image'];
						}
						else
						{
								$demenor_url = $this->config->item('upload_url')."demeanor/31x31/no_photo_icon.png";
								$demenor_thumb_url = $this->config->item('upload_url')."demeanor/60x60/no_photo_icon.png";
						}
					?>
                	<li>
                    	<span class="left-img"><img src="<?php echo $image_url; ?>" alt="<?php echo $transport_animals[$a]['st_animal_name'];?>" title="<?php echo $transport_animals[$a]['st_animal_name'];?>" /></span>
                        <span class="cont"><a target="_blank" href="<?php echo base_url().'animal-'; ?><?php echo $transport_animals[$a]['in_animal_id']; ?>  -  <?php echo $this->common_function->get_filtered_name($transport_animals[$a]['st_animal_name']); ?>"><?php echo $transport_animals[$a]['st_animal_name'];?></a><span><?php echo $transport_animals[$a]['st_animal_breed_name']." ".$transport_animals[$a]['st_animal_type_name'];?></span></span>
                        <span class="right-img"><a href="javascript:void(0);" class="preview" rel="popover" data-class="bdrt-tip <?php echo $transport_animals[$a]['st_css_class'];?>" data-placement="left" data-original-title="Couch Potato" data-content="<img src='<?php echo $demenor_thumb_url; ?>'/> <?php echo $transport_animals[$a]['st_demeanor_desc'];?>"><img src="<?php echo $demenor_url; ?>" alt="Mittens" title="Mittens" /></a></span>
                        <div class="clear"></div>
                        <p><?php if(!empty($transport_animals[$a]['st_profile_story']) && isset($transport_animals[$a]['st_profile_story'])) { ?>
								<?php echo substr($transport_animals[$a]['st_profile_story'],0,100);  ?>... <a target="_blank" href="<?php echo base_url().'animal-'; ?><?php echo $transport_animals[$a]['in_animal_id']; ?>  -  <?php echo $this->common_function->get_filtered_name($transport_animals[$a]['st_animal_name']); ?>"  >Read More</a>
								<?php }  ?>
						</p>
                    </li>
					 <?php } } ?>
                
				<?php } ?>
				</ul>
                </div>
            <div class="animal-block2">
            <h2>Animal Rescue Transportation created by</h2>
				<?php 		//$picture = $this->common_function->get_picture($transport_details['in_organization_id']);
				//$profile_image = '';
				//print_r($transport_details);
				if(!empty($transport_details['st_org_image']) != '' &&  isset($transport_details['st_org_image']) && file_exists($this->config->item('upload').'org_doc/thumb/'.$transport_details['st_org_image'])) 
				{
					$profile_image = $transport_details['st_org_image'];
					$org_profile_src = $this->config->item('upload_url').'org_doc/thumb/'.$profile_image; 
				} else {
					$profile_image = 'temp-logo.jpg';
					$org_profile_src = $this->config->item('upload_url').'org_doc/thumb/'.$profile_image; 
				}	
			?>
            <div class="rescue-transport-usa"><span class="rescue-usa-img"><img src="<?php echo $org_profile_src; ?>" alt="<?php echo $transport_details['st_org_name'];?>" title="<?php echo $transport_details['st_org_name'];?>" /></span> <span><a target="_blank" href="<?php echo base_url(); ?>organization-<?php echo $transport_details['in_organization_id']; ?>-<?php echo $this->common_function->get_filtered_name($transport_details['st_org_name']); ?>"><?php echo $transport_details['st_org_name'];?></a></span></div>
            <p>	<?php if(!empty($transport_details['st_profile_desc']) && isset($transport_details['st_profile_desc'])) { ?>
				<?php echo substr($transport_details['st_profile_desc'],0,100);  ?>.. <a target="_blank" href="<?php echo base_url(); ?>organization-<?php echo $transport_details['in_organization_id']; ?>-<?php echo $this->common_function->get_filtered_name($transport_details['st_org_name']); ?>"  >Read More</a>
				<?php } ?>
			</p>
            </div>
            <div class="animal-block3">
            <h2>What is Doobert.com?</h2>
			<?php //print_r($transport_details); ?>
            <p>Doobert is about one thing - bringing us all together to help rescue as many animals as we can. With the help of this easy-to-use tool, you can volunteer at a rescue or shelter, sign up to be an animal transporter, or help raise funds for a spacific animal transport. The software makes it easy to set up the route and for drivers and pilots and rescue groups to coordinate entire trips in just minutes.</p>
            <a target="_blank" href="<?php echo base_url(); ?>" class="btn pink" title="Join Doobert">Join Doobert</a>
            </div>
			</div>
          </div>
          <div class="gr-wrap col-lg-9 col-md-8 col-sm-12 tabs">
            <div class="bg">
              <ul class="nav nav-pills" style="margin-bottom:0;float:left" id="info_ul">
                <?php if(empty($leg_page_link)){ ?>
                <li id="r_map"  class="active"><a href="#tab_2_2" id="route_tab" data-toggle="tab">Route</a> </li>
                <?php } ?>
                <?php 
				  for($m=1;$m<=count($leg_page_link);$m++)
				  { 
				  	if($leg_page_link[$m]['selected']==$m)
					{
						?>
                <script type="text/javascript">
					   var end_li ="<?php echo $leg_page_link[$m]['end_li']?>"; 
					   var start_li ="<?php echo $leg_page_link[$m]['start_li']?>"; 
					   </script>
                <?php } ?>
                <li id="r_map<?php echo $m;?>"  class="icon_class <?php if($leg_page_link[$m]['selected']==$m){ echo "active"; }  ?>"><a href="<?php echo $this->config->item('base_url')."org-transportation-scheduled/".$this->session->userdata('transport_id')."/".$m; ?>" id="route_tab_<?php echo $m;?>"><?php echo ($m=='1')?"Legs":"";?> <?php echo $leg_page_link[$m]['text'];?></a> </li>
                <?php } ?>				
              </ul>
			  <?php if ($transport_details['st_trans_type']=='P') { ?> 
					<span class="btn light-green transport-view-map map"><i class="fa fa-eye"></i> View Map</span>
				<?php }else{ ?>
				 <span class="btn light-green transport-view-map map"><i class="fa fa-eye-slash"></i> Hide Map</span>				 
                  <?php } ?>
				  
              <div class="clearfix"></div>
            </div>
            <div class="clearfix"></div>
            <div class="tab-content">
              <div class="tab-pane fade map01 column2 active in" id="tab_2_2">
                <?PHP
				 $display  	= '';
				 $div		= '';
				 $type 		= "false";
				 $atype  	= "false";
				 $legs 		= '';
				 $date_js  	= '';
				
				 if($transport_details['st_trans_type']=='P')
				 {
					 $display = "style=\"display:none;\"";
					 $type =  "false";
				 }
				 else
				 { 
				 	if(isset($single_join) && $single_join=="true"){   //For a aviation or driver route selection.
					//if(isset($join) || isset($ajoin)){  //For a aviation and one driver route selection.
							$type = isset($join)?$join:"false"; //For a aviation and one driver route selection.
							$atype = isset($ajoin)?$ajoin:"false";//For a aviation and one driver route selection.					
							$date_js = "yes";
							if(((isset($transport_type) && $transport_type=='1')) || $atype=='true' && $type=="false")
							{
								$div = '<div  class="fl" id="can-save1"><a rel="nofollow" href="'.base_url().'org-transportation-scheduled/'.$transport_details['in_transportation_id'].'/" data-method="post" class="button btn pink-btn">Save Legs <i class="fa fa-angle-right"></i></a></div>';
							}
							else
							{
								$div = '<div  class="fl" id="can-save"><a rel="nofollow" href="'.base_url().'org-transportation-scheduled/'.$transport_details['in_transportation_id'].'/" data-method="post" class="button btn pink-btn">Save Legs <i class="fa fa-angle-right"></i></a></div>';
							}
					}
					
					else
					{
						 $type =  "false";
						 $atype = "false";
						 $single_join = "false";
						 $display = "style=\"display:none;\"";
						
					}
					if($cover_dist>=100)
					{
						$type =  "false";
						$atype = "false";
						$single_join = "false";
						$display = "style=\"display:none;\"";
					}
				}
					
					if(((isset($transport_type) && $transport_type=='1')) || $atype=='true' && $type=="false")
					{
						//$type = $atype;
						#============== For aviation map=================#
						include APPPATH."views/includes/transport-routes_aviation.php";
					}
					else
					{
						 $type =  $type;
						#============== For route map=================#
						 include APPPATH."views/includes/transport-routes.php"; 						 
					}
				?>
				
				<div id="map-hide" class="gr-wrap col-lg-12 col-md-12 col-sm-12 view_map_tg">
				<div class="clearfix"></div>
				<div class="transport-legs-detail">
			    <form class="horizontal-form" role="form" id="legs_select" name="legs_select" enctype="multipart/form-data" action="" method="post">
				<input type="hidden" value="" name="action" id="action" />
				</form>
			
				<?php 
				$count_driver = 0;
				if(isset($leg_details) && !empty($leg_details))
				{
				?>
					<ul>
					<?php 
					$i=1;
					$leave='n';
					$a = 1;
					$leave_mark = "";
					foreach($leg_details as $key=>$value)
					{
						$contct_legs=unserialize($value['st_contact']);
						$enable_select_leg = 1;
						//echo "<pre>-----";print_r($contct);die;
							if(empty($value['st_contact']))
							{
								$first_legs ='yes';
							}
							else
							{
								$first_legs ='no';
							}
						
						$class= $this->common_function->color_class[$a];
						if($a==8)
						{
							$a=1;
						}
						else
						{
							$a++;
						}
						if($value['user_id']==$this->session->userdata('userid'))
						{
							$leave='y';
						}
						
						$participants_user_ids = array();
						foreach($value['leg_participant_details'] as $user_key=>$participants)
						{
							$participants_user_ids[] =  $participants['in_user_id'];
						}
						if($value['in_multi_user'] == 1 && $value['in_user_num'] > 1 && ($value['in_user_num'] - ($value['participants_cnt']+$value['non_doobert_participants_cnt'])) == 0)
						{ 
							$enable_select_leg = 0;
						}
						if($value['in_multi_user'] == 0 && $value['in_user_num'] == 0 && ($value['participants_cnt']+$value['non_doobert_participants_cnt']) > 0)
						{
							$enable_select_leg = 0;
						}
					?>
						<!--<li>-->
						<?php if($enable_select_leg == 1) {  ?> <li> <?php } else { ?> <li class="filled-box"><?php } ?>
							<h3><i class="fa fa-flag orange"></i> Leg-<?php echo $i ;?> 
							<span><?php if($value['route_type_id'] == '0' && $value['in_multi_user'] == '1' && $value['in_user_num'] > 1 && ($value['participants_cnt'] == 0)) { ?>
						(<?php echo $value['in_user_num']; ?> driver(s) needed)
						<?php } ?>
						<?php if($value['route_type_id'] == '0' && $value['in_multi_user'] == '1' && $value['in_user_num'] > 1 && ($value['participants_cnt'] != 0) && ($value['in_user_num'] - $value['participants_cnt']) != 0) { ?>
						(<?php echo ($value['in_user_num'] - $value['participants_cnt']); ?> driver(s) needed)
						<?php } ?>
						<?php if($value['route_type_id'] == '1' && $value['in_multi_user'] == '1' && $value['in_user_num'] > 1 && ($value['participants_cnt'] == 0)) { ?>
						(<?php echo $value['in_user_num']; ?> pilot(s) needed)
						<?php }?>
						<?php if($value['route_type_id'] == '1' && $value['in_multi_user'] == '1' && $value['in_user_num'] > 1 && ($value['participants_cnt'] != 0) && ($value['in_user_num'] - $value['participants_cnt']) != 0) { ?>
						(<?php echo ($value['in_user_num']-$value['participants_cnt']); ?> pilot(s) needed)
						<?php } ?></span>
							 <?php if($enable_select_leg == 0) { ?>
							  <span class="filled-text"><i class="fa fa-check blue"></i> Filled</span>
							  <?php } ?>
							</h3>
							<div class="leg-inner-cont">
							<?php if($value['route_type_id'] == '1' || $value['route_type_id'] == '0') { ?>
							<p><span>From:</span> <?php echo ((isset($value['pick_street']) && $value['pick_street'] != '') ?$value['pick_street'].", ":"").(isset($value['pick_city']) ?$value['pick_city'].", ":"").(isset($value['pick_state'])?$value['pick_state']:"").(isset($value['pick_zip'])?", ".$value['pick_zip']:""); ?> </p>
							<p><span>To:</span> <?php echo ((isset($value['drop_street']) && $value['drop_street'] != '') ?$value['drop_street'].", ":"").(isset($value['drop_city'])?$value['drop_city'].", ":"").(isset($value['drop_state'])?$value['drop_state']:"").(isset($value['drop_zip'])?", ".$value['drop_zip']:""); ?></p>
							 <!--<p><span>Distance:</span> <?php echo number_format($value['leg_distance'],"2",".","").' miles';?></span></p> -->
							<p><span>Distance:</span> <?php echo round($value['leg_distance']).' miles';?></span></p>
							<?php } ?>
							
							<?php if($value['route_type_id'] == '2') { ?>
							<p><strong>Overnight Leg: </strong></b><?php echo (isset($value['st_street']) && $value['st_street'] != '' ?$value['st_street'].", ":"").(isset($value['st_city']) ?$value['st_city'].", ":"").(isset($value['st_state'])?$value['st_state']:"").(isset($value['st_zip'])?", ".$value['st_zip']:""); ?></p>
							 <p class="inline"><strong>Comments: </strong><?php echo (isset($value['st_meeting_location']) && $value['st_meeting_location'] != '') ? stripslashes($value['st_meeting_location']) : '-'; ?></p>
							<?php } ?>
							<?php if(isset($value['pick_start_time']) || isset($value['pick_timezone'])) { ?>
							<p class="leg-start"><span>Start:</span> <?php echo date("M d - h:i A",strtotime($value['pick_start_time']))." - ".$value['pick_timezone'];?></p>
							 <?php } ?>
							 <?php if(isset($value['drop_start_time']) || isset($value['drop_timezone'])) { ?>
							<p><span>End:</span> <?php echo date("M d - h:i A",strtotime($value['drop_start_time']))." - ".$value['drop_timezone'];?></p>
							  <?php } ?>
							 <?php /* if($value['route_type_id'] == '1' || $value['route_type_id'] == '0') { ?> 
							<p><span>Meeting Location:</span> <?php echo (isset($value['st_meeting_location']) && $value['st_meeting_location'] != '') ?stripslashes($value['st_meeting_location']) : '-'; ?></p>
							<?php } */?>
							
							</div>
							 <?php if($enable_select_leg == 1) { ?>
							<div class="bottom-part">
							<div class="bottom-cont">
							<a href="javascript:void(0);" onClick="$('#action').val('join');" name="select_leg" id="select_leg" class="btn orange" title="Select Leg">Select Leg</a>
							</div>
							</div>
							 <?php } ?>
						</li>
						 <?php 
						$i++;
					}
					?>
					</ul>
					<?php
				} ?>
				</div>
				</div>
				
              </div>
            </div>
          </div>
          <div class="clearfix"></div>
        </div>
      </div>
      <!-- END PAGE CONTENT--> 
    </div>
  </div>
  <!-- END CONTENT --> 
<!-- END CONTAINER -->
</div>
<a href="#" class="crunchify-top" id="crunchify-top" title="Top">â†‘</a>


<div class="modal fade bs-modal-lg in" id="email-config" tabindex="-1" role="basic" aria-labelledby="myModalLabel" aria-hidden="true">
                            <form class="horizontal-form" role="form" name="tell_a_friend" id="tell_a_friend" action="<?php echo base_url() ?>transportation/tell_a_friend" method="post">
                              <div class="modal-dialog">
                                <div class="modal-content">
                                	<input type="hidden" id="share_transport_id" name="share_transport_id" value="">
                                    
                                    <div class="modal-header">
                                        <button aria-hidden="true" data-dismiss="modal" class="close" type="button"></button>
                                        <h4 class="modal-title">Send Email</h4>
                                    </div>
                            
                                  <div class="modal-body">
                                   <p align="right"><span class="required-filed">*</span> required fields.</p>
                                   
                                    <div class="form-group "><label class="control-label" for="txttoname">To Name: <span class="required-filed">*</span></label><input type="text" class="form-control" id="txttoname" name="txttoname"></div>
                                    
                            <div class="form-group "><label class="control-label" for="txtemail">To Email: <span class="required-filed">*</span></label><input type="text" class="form-control" id="txtemail" name="txtemail"></div>
                            
                           <?php /*?> <div class="form-group "><label class="control-label" for="txtfrom">From <span class="required-filed">*</span></label><input type="text" class="form-control" id="txtfrom" name="txtfrom" value="<?php echo $this->session->userdata('user_name').' '.$this->session->userdata('last_name'); ?>"></div><?php */?>
                           <input type="hidden" class="form-control" id="txtfrom" name="txtfrom" value="<?php echo $this->session->userdata('user_name').' '.$this->session->userdata('last_name'); ?>">
                            
                            <?php /*?><div class="form-group ">
                            <label class="control-label" for="txtsubject">Subject <span class="required-filed">*</span></label>
                            <input type="text" class="form-control" id="txtsubject" name="txtsubject" value="">
                            </div><?php */?>
                            
                            <input type="hidden" class="form-control" id="txtsubject" name="txtsubject" value="">
                            
                            <div class="form-group no-margin"><label class="control-label " for="txtMessage">Message <span class="required-filed">*</span></label><textarea id="txtMessage" name="txtMessage" class="form-control" rows="10"></textarea></div>
                            <input type="hidden" name="frm_action" id="frm_action" value="submit" />
                                  </div>
                                  <div class="modal-footer no-margin no-border no-top-space"><button aria-hidden="true" name="send_mail" id="send_mail" class="btn green" type="submit" title="Send Email">Send Email</button>
                                  <span class="display_loader" style="display:none;"> <img id="loadimg_mail" src="<?php echo base_url(); ?>assets/img/ajax-loading.gif" alt="loader" /> </span>
                                  </div>
                                </div>
                                <!-- /.modal-content --> 
                              </div>
                              <!-- /.modal-dialog --> 
                              </form>
                            </div> 
							
	<!-- Contact US Form -->
  <div class="modal fade" id="map-user-contact" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" data-backdrop="static" data-keyboard="false">
                    <div class="modal-dialog">
                        <form class="horizontal-form" role="form" id="send-request" name="send_request" action="" method="post">
                            <input type="hidden" id="contact_name" name="contact_name" value="">
                            <input type="hidden" id="contact_email" name="contact_email" value="">
							<input type="hidden" id="org_id" name="org_id" value="">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <button aria-hidden="true" data-dismiss="modal" class="close empty_dates" type="button" title="Close"></button>
                                    <h4 class="modal-title">Contact Request</h4>
                                </div>							
                                <div class="modal-body">
                                    <div class="form-group col-md-12 padl0 padr0">
                                       <input id="user-name" name="user-name"  class="form-control" Placeholder="Enter Your Name">
                                    </div>
									<div class="form-group col-md-12 padl0 padr0">
                                       <input id="user-email" name="user-email" onkeyup="remove_empty_spaces($(this),event)" class="form-control" Placeholder="Enter Your Email">
                                    </div>
                                    <div class="form-group col-md-12 padl0 padr0">
                                       <textarea id="contactmessage" name="contactmessage" rows="3" class="form-control" maxlenght="500" Placeholder="Enter Your Message" ></textarea>
                                    </div>
                                    <div class="form-group col-md-12 padl0 padr0 btm-button marb0">
                                            <a href="javascript:void(0);" class="btn orange fr" id="send_request_btn" title="Send">Send</a>
                                           <!-- <input type="submit" class="btn orange mart20 fr wht"  id="send_request_btn" value="Send">-->
                                    </div>
                                    <div class="clearfix"></div>
                                </div>
                            </div>
                        </form>
                        <!-- /.modal-content --> 
                        </div>
                    </div>

<!-- End Contact Us Form --> 

	<!-- Start Thank You Message -->
					 <div class="modal fade" id="thankyou-config" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header"> 
                            <button aria-hidden="true" data-dismiss="modal" class="close" type="button"></button>
                            <h4 class="modal-title">THANK YOU</h4>
                        </div>
                        <div class="modal-body"><h5>Your contact request was sent successfully.</h5></div>
                        <div class="modal-footer text-center no-margin"><a class="btn blue" data-dismiss="modal" title="Close">Close</a> </div>
                    </div>
                    <!-- /.modal-content --> 
                </div>
                <!-- /.modal-dialog --> 
            </div>
			<!-- End Thank you Message -->
						
 


 
<?PHP include APPPATH."views/includes/footer.php" ?>


<!-- BEGIN thanku-suggest-leg MODAL POPUP-->
<div class="modal fade" id="thanku-suggest-leg" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header"> 
        <button aria-hidden="true" data-dismiss="modal" class="close" type="button"></button>
        <h4 class="modal-title">Thank you for suggesting a leg!</h4>
      </div>
      <div class="modal-body">We've notified the transport coordinator and if they choose your suggestion they will modify the transport legs accordingly.</div>
      <div class="modal-footer text-center no-margin">
		<button class="btn blue" data-dismiss="modal" title="OK" type="button">OK</button> 
	  </div> 
    </div>
    <!-- /.modal-content --> 
  </div>
  <!-- /.modal-dialog --> 
</div>
<!-- END thanku-suggest-legMODAL POPUP-->

<!--End Page Lavel CSS--> 


<!-- BEGIN PAGE LEVEL PLUGINS --> 
<script type="text/javascript" src="<?php echo base_url(); ?>assets/plugins/bootstrap-datepicker/js/bootstrap-datepicker.js"></script> 
<script type="text/javascript" src="<?php echo base_url(); ?>assets/plugins/clockface/js/clockface.js"></script> 
<script type="text/javascript" src="<?php echo base_url(); ?>assets/plugins/bootstrap-datetimepicker/js/bootstrap-datetimepicker.min.js"></script> 
<script type="text/javascript" src="<?php echo base_url(); ?>assets/scripts/custom/components-pickers.js"></script> 
<script type="text/javascript" src="<?php echo base_url(); ?>assets/plugins/bootstrap-fileinput/bootstrap-fileinput.js"></script> 
<script type="text/javascript" src="<?php echo base_url(); ?>assets/plugins/gritter/js/jquery.gritter.js"></script> 
<script type="text/javascript" src="<?php echo base_url(); ?>assets/plugins/jquery.pulsate.min.js"></script> 
<script type="text/javascript" src="<?php echo base_url(); ?>assets/plugins/jquery-bootpag/jquery.bootpag.min.js"></script> 
<script type="text/javascript" src="<?php echo base_url(); ?>assets/plugins/holder.js"></script> 
<script src="<?php echo base_url(); ?>assets/plugins/jquery-validation/dist/jquery.validate.min.js" type="text/javascript"></script> 
<!-- END PAGE LEVEL PLUGINS --> 

<!-- BEGIN PAGE LEVEL SCRIPTS --> 
<script src="<?php echo base_url(); ?>assets/scripts/custom/ui-general.js"></script> 
<script src="<?php echo base_url(); ?>assets/scripts/custom/components-pickers.js"></script> 
<!-- END PAGE LEVEL SCRIPTS --> 

<!-- END JAVASCRIPTS --> 
<script>
function display_share_email_popup()
	{
		$('#email-config').modal('show');
		//val=document.getElementById('txtMessage').value;
		//val = val.replace(/<br\s*\/?>/mg,"\n");
		//alert(val);
		//$('#txtMessage').html(val);
		
	}
	
jQuery(document).ready(function() {       
   // initiate layout and plugins
   UIGeneral.init();
   ComponentsPickers.init();
   
   $("#pick_up_location,#pick_street,#drop_off_location,#drop_street,#contact_name,#contact_email,#note-comments,#pickup_airport,#dropoff_airport,#contact_name_avia,#contact_email_avia,#note_comments_avia").val("");
   
   
   $('#send_request_btn').live('click',function(){
					var mess='';
					mess = $('#contactmessage').val(); 
					var username = $("#user-name").val();
					var useremail = $("#user-email").val();
					var org_id = $("#org_id").val();
					var validatemail= 	validateEmail(useremail);
					//alert(validatemail);	
					//alert(mess);		
                    if(mess == '' || name == '' || email == '')
                    {
						alert('Please complete your information.');
						//alert('Please complete the form details.');
						//$.modal.close();
                        return false;
                    }
					else if(validatemail==false)
					{
						alert('Please enter valid email address.');
						$("#user-email").val('');
                        return false;
					}else
                    {
					var name  = $('#contact_name').val();
                    var email = $('#contact_email').val();
					
						 $.ajax({
								type: "POST",
								url: '<?php echo base_url(); ?>rescue_map/map_send_mail',
								beforeSend: function(){
								$('#map-user-contact').modal('toggle');	
								//$.modal.close();
								//$('#user-contact').hide();
								//$.modal.close();
								$('#loader').show();
								},
								data: {contact_name:name , contact_email:email ,contactmessage:mess , username:username , useremail:useremail , org_id:org_id},
			 // data : { },
								dataType:'json',
			  					complete: function(){
								$('#loader').hide();
				    			},
								  success:function(data){
									if(data.success == 1)
										$('.modal-title').html('Thank You')	
										$('#contactmessage').val('');
										$('#contact_name').val('');	
										$('#contact_email').val('');
										$("#user-name").val('');
										$("#user-email").val('');
										$("#org_id").val('');
										$('#thankyou-config').modal('show');
								}, 
                        //return true;
						 });
                    }
		}); //send_request_btn2	
   
   
   $('#map-seach-wrap').hide();
$('#tell_a_friend').validate({
					errorElement: 'span', //default input error message container
					errorClass: 'help-block', // default input error message class
					focusInvalid: true, // do not focus the last invalid input
					rules: {
						txttoname: {
							required: true
						},
						txtemail: {
							required: true,
							email:true
						},
						txtMessage: {
							required: true
						}
					},
			
					messages: {
						txttoname: {
							required: 'Please enter receiver name.'
						},
						txtemail: {
							required: 'Please enter receiver email.',
							emauil: 'Please enter valid receiver email.'
						},
						txtMessage: {
							required: 'Please enter message.'
						}
						
					},
			
					invalidHandler: function (event, validator) { //display error alert on form submit   
						$('#tell_a_friend').show();
						
						var errors = validator.numberOfInvalids();
						if (errors) {
						  var message = errors == 1
							? 'You missed 1 field. It has been highlighted'
							: 'You missed ' + errors + ' fields. They have been highlighted';
						  alert(message);
						}
					},
			
					highlight: function (element) { // hightlight error inputs
						$(element)
							.closest('.form-group').addClass('has-error'); // set error class to the control group
					},
			
					success: function (label) { //alert(label);
						label.closest('.form-group').removeClass('has-error');
						label.remove();
					},
			
					errorPlacement: function (error, element) { 
						error.addClass('help-block').insertAfter(element.closest('.form-control'));
					}
			
				});
        
		
		$('#send_mail').live('click',function(){
	if($('#tell_a_friend').valid() == false) {
		return false;
	} else {
		$('#send_mail').hide();
		
		if($.browser.msie) {
				$('.display_loader').html('<img id="loadimg" src="<?php echo base_url(); ?>assets/img/ajax-loading.gif" alt="loader" />');
			}
		$('.display_loader').show();
		
		$('#loadimg_mail').show();
		$('#email-config').modal('hide');
		
		if($.browser.msie) {
			$('.display_loader').html('<div id="loader" style="display: none;"><img src="<?php echo base_url(); ?>assets/img/ajax-modal-loading.gif" width="32" height="32" align="absmiddle">&nbsp;<span id="loadertext">Loading...</span></div>');
		}
		
		$('.display_loader').show();
		$('#loader').show();
	}
	});   

	$('#recommend_leg').validate({
					errorElement: 'span', //default input error message container
					errorClass: 'help-block', // default input error message class
					focusInvalid: true, // do not focus the last invalid input
					rules: {
						pick_up_location: {
							required: true
						},
						drop_off_location: {
							required: true
						},
						contact_name: {
							required: {
								depends: function(){
										if($('#recommend_user_id').val() == ''){ 
											return true;
										} else {
											return false;
										}
									}
								}
						},
						contact_email: {
							required: {
								depends: function(){
										if($('#recommend_user_id').val() == ''){ 
											return true;
										} else {
											return false;
										}
									}
								},
							email: true	
						}
					},
			
					messages: {
						pick_up_location: {
							required: 'Please Enter Pick Up Location.'
						},
						drop_off_location: {
							required: 'Please Enter Drop Off Location.'
						},
						contact_name: {
							required: 'Please Enter Your Name.'
						},
						contact_email: {
							required: 'Please Enter Your Email.'
						}
					},
			
					invalidHandler: function (event, validator) { //display error alert on form submit   
						$('#suggest_leg').show();
						
						var errors = validator.numberOfInvalids();
						if (errors) {
						  var message = errors == 1
							? 'You missed 1 field. It has been highlighted'
							: 'You missed ' + errors + ' fields. They have been highlighted';
						  alert(message);
						}
					},
			
					highlight: function (element) { // hightlight error inputs
						$(element)
							.closest('.form-group').addClass('has-error'); // set error class to the control group
					},
			
					success: function (label) { //alert(label);
						label.closest('.form-group').removeClass('has-error');
						label.remove();
					},
			
					errorPlacement: function (error, element) { 
						error.addClass('help-block').insertAfter(element.closest('.form-control'));
					}
			
				});
        
		

		$('#suggest_leg').live('click',function(){
			//alert('validate suggest leg');
	if($('#recommend_leg').valid() == false) {
		return false;
	} else {
		$('#suggest_leg').hide();
		
		if($.browser.msie) {
				$('.display_loader').html('<img id="loadimg" src="<?php echo base_url(); ?>assets/img/ajax-loading.gif" alt="loader" />');
			}
		$('.display_loader').show();
		
		$('#loadimg_mail').show();
		$('#email-config').modal('hide');
		
		if($.browser.msie) {
			$('.display_loader').html('<div id="loader" style="display: none;"><img src="<?php echo base_url(); ?>assets/img/ajax-modal-loading.gif" width="32" height="32" align="absmiddle">&nbsp;<span id="loadertext">Loading...</span></div>');
		}
		
		$('.display_loader').show();
		$('#loader').show();
	}
	});   
	
	
	$('#recommend_leg_avia').validate({
					errorElement: 'span', //default input error message container
					errorClass: 'help-block', // default input error message class
					focusInvalid: true, // do not focus the last invalid input
					rules: {
						pickup_airport: {
							required: true
						},
						dropoff_airport: {
							required: true
						},
						contact_name_avia: {
							required: {
								depends: function(){
										if($('#recommend_user_id_avia').val() == ''){ 
											return true;
										} else {
											return false;
										}
									}
								}
						},
						contact_email_avia: {
							required: {
								depends: function(){
										if($('#recommend_user_id_avia').val() == ''){ 
											return true;
										} else {
											return false;
										}
									}
								},
							email: true
						}
					},
			
					messages: {
						pickup_airport: {
							required: 'Please Enter From Location.'
						},
						dropoff_airport: {
							required: 'Please Enter To Location.'
						},
						contact_name_avia: {
							required: 'Please Enter Your Name.'
						},
						contact_email_avia: {
							required: 'Please Enter Your Email.'
						}
					},
			
					invalidHandler: function (event, validator) { //display error alert on form submit   
						$('#suggest_leg').show();
						
						var errors = validator.numberOfInvalids();
						if (errors) {
						  var message = errors == 1
							? 'You missed 1 field. It has been highlighted'
							: 'You missed ' + errors + ' fields. They have been highlighted';
						  alert(message);
						}
					},
			
					highlight: function (element) { // hightlight error inputs
						$(element)
							.closest('.form-group').addClass('has-error'); // set error class to the control group
					},
			
					success: function (label) { //alert(label);
						label.closest('.form-group').removeClass('has-error');
						label.remove();
					},
			
					errorPlacement: function (error, element) { 
						error.addClass('help-block').insertAfter(element.closest('.form-control'));
					}
			
				});
        
		

		$('#suggest_leg_aviation').live('click',function(){
			//alert('validate suggest leg aviation');
	if($('#recommend_leg_avia').valid() == false) {
		return false;
	} else {
		$('#suggest_leg').hide();
		
		if($.browser.msie) {
				$('.display_loader').html('<img id="loadimg" src="<?php echo base_url(); ?>assets/img/ajax-loading.gif" alt="loader" />');
			}
		$('.display_loader').show();
		
		$('#loadimg_mail').show();
		$('#email-config').modal('hide');
		
		if($.browser.msie) {
			$('.display_loader').html('<div id="loader" style="display: none;"><img src="<?php echo base_url(); ?>assets/img/ajax-modal-loading.gif" width="32" height="32" align="absmiddle">&nbsp;<span id="loadertext">Loading...</span></div>');
		}
		
		$('.display_loader').show();
		$('#loader').show();
	}
	});   
	
	
	$('#pick_up_location').autocomplete ({
	source: function (request, response)
    {
			request.term = $.trim(request.term);
			var str	= request.term;
			var letters = /^[a-zA-Z ]+$/;	
			if(str.match(letters))
			{
				request.term = str; 
			} else {
				str = str.toUpperCase();
				request.term = str.replace(/\s/g, ''); 
			}
        $.ajax(
        {
            url: "<?php echo base_url(); ?>org_transportation/get_zip_code2/" ,
            dataType: "json",
			async:false,
            data:
            {
                term: request.term,
				city: $("#pick_city" ).val(),
				state: $("#pickup_state" ).val()
            },
            success: function (data)
            {
				if(data=="1")
				{
					window.location.href="<?php echo base_url() ?>";
				}
				else
				{
                	response(data);
				}
            }
        });
    },
	minLength:1,
	open: function() { $('.ui-menu').width($("#pick_up_location" ).width()) },
	focus: function( event, ui ) {
			var id = ui.item.label;
			var name = ui.item.value;
			$("#pick_up_location" ).val(name);
			$("#pick_zip" ).val(name);
			$("#pick_country" ).val(ui.item.st_country);
			country_state(ui.item.st_country,"pick");
			$("#pick_city").val(ui.item.city);
			$("#pickup_state").val(ui.item.state_prefix);	
			return false;			
	},     
	select: function( event, ui ) {
		var id = ui.item.label;
		var name = ui.item.value;
		$("#pick_zip" ).val(name);
		$("#pick_up_location" ).val(id);
		$("#pick_country" ).val(ui.item.st_country);
		country_state(ui.item.st_country,"pick");
		$("#pick_city" ).val(ui.item.city);
		$("#pickup_state" ).val(ui.item.state_prefix);
		return false;
	}
	});

	$('#pick_up_location').live('change',function(){
	//var selected_zipcode = $(this).val();
	var selected_zipcode = $.trim($(this).val());
	var str	= selected_zipcode; 
	//selected_zipcode = str.replace(/\s/g, ''); 
	var letters = /^[a-zA-Z ]+$/;	
	if(str.match(letters))
	{
			 selected_zipcode = str; 
	} else {
			 str = str.toUpperCase();  	
			 selected_zipcode = str.replace(/\s/g, ''); 
	}
	//alert(selected_zipcode);
	//alert($("#pick_city" ).val());
	var select_pickup_city = $("#pick_city" ).val();
	//alert(select_pickup_city);
	var select_pickup_state = $("#pickup_state" ).val();
	//alert(select_pickup_state);
	var select_pickup_country = $("#pick_country" ).val();
	//alert(select_pickup_country);
	//alert($("#pick_zip").val());
	//alert($("#pick_zip").val().indexOf(','));

	if ($("#pick_up_location").val().indexOf(',') != -1 && $("#pick_up_location").val().indexOf('USA') != -1 && $("#pick_up_location").val().indexOf('Canada') != -1) {
		if(selected_zipcode != '' && select_pickup_city != '' && select_pickup_state != '' && select_pickup_country != '')
		{
			$("#pick_up_location").val(selected_zipcode+', '+select_pickup_city+', '+select_pickup_state+', '+select_pickup_country);
		}
	}
	else
	{
		if(selected_zipcode!=''){
		$.ajax({
				url: "<?php echo base_url(); ?>org_transportation/get_zip_code2/" ,
				dataType: "json",
				async:false,
				data:
				{
					term: selected_zipcode,
					city: $("#pick_city" ).val(),
					state: $("#pickup_state" ).val()
				},
				success: function (data)
				{
					//alert(data);
					//alert(data.length);
					//console.log(data);
					//console.log(data[0].label);
					if(data)
					{
					$("#pick_up_location").val(data[0].label);
					$("#pick_zip").val(data[0].value);
					$("#pick_country").val(data[0].st_country);
					country_state(data[0].st_country,"pick");
					$("#pick_city").val(data[0].city);
					$("#pickup_state").val(data[0].state_prefix);
					}
					else
					{
						if($("#pick_up_location").val().indexOf(',') == -1)
						{
							alert('Please enter valid from location');	
							$("#pick_up_location").val("");
						}
					}
				}
			});		
		}//!=''	
	}
	});
	
	
	
	$('#drop_off_location').autocomplete ({
	source: function (request, response)
    {
		request.term = $.trim(request.term);
		var str	= request.term;
		var letters = /^[a-zA-Z ]+$/;	
		if(str.match(letters))
		{
			request.term = str; 
		} else {
			str = str.toUpperCase();
			request.term = str.replace(/\s/g, ''); 
		}	
        $.ajax(
        {
            url: "<?php echo base_url(); ?>org_transportation/get_zip_code2/" ,
            dataType: "json",
            data:
            {
                term: request.term,
				city: $("#drop_city" ).val(),
				state: $("#drop_state" ).val()
            },
            success: function (data)
            {
				if(data=="1")
				{
					window.location.href="<?php echo base_url() ?>";
				}
				else
				{
                	response(data);
				}
            }
        });
    },
	minLength:1,
	open: function() { $('.ui-menu').width($("#drop_off_location" ).width()) },
	focus: function( event, ui ) {
			var id = ui.item.label;
			var name = ui.item.value;
			$("#drop_off_location" ).val(name);
			$("#drop_zip" ).val(name);
			$("#drop_country" ).val(ui.item.st_country);
			country_state(ui.item.st_country,"pick");
			$("#drop_city" ).val(ui.item.city);
			$("#drop_state" ).val(ui.item.state_prefix);
			
			return false;
	},     
	select: function( event, ui ) {
		var id = ui.item.label;
		var name = ui.item.value;
		//$("#pick_zip" ).val(name);
		$("#drop_off_location" ).val(id);
		$("#drop_zip" ).val(name);
		$("#drop_country" ).val(ui.item.st_country);
		country_state(ui.item.st_country,"pick");
		$("#drop_city" ).val(ui.item.city);
		$("#drop_state" ).val(ui.item.state_prefix);
		
		return false;
	}
	});
	
	
	$('#drop_off_location').live('change',function(){
	//var selected_zipcode = $(this).val();
	var selected_zipcode = $.trim($(this).val());
	var str	= selected_zipcode; 
	//selected_zipcode = str.replace(/\s/g, ''); 
	var letters = /^[a-zA-Z ]+$/;	
	if(str.match(letters))
	{
			 selected_zipcode = str; 
	} else {
			 str = str.toUpperCase();  	
			 selected_zipcode = str.replace(/\s/g, ''); 
	}
//alert(selected_zipcode);
//alert($("#drop_city" ).val());
var select_dropoff_city = $("#drop_city" ).val();
//alert(select_dropoff_city);
var select_dropoff_state = $("#drop_state" ).val();
//alert(select_dropoff_state);
var select_dropoff_country = $("#drop_country" ).val();
//alert(select_dropoff_country);

//alert($("#drop_zip").val().indexOf(','));
if ($("#drop_off_location").val().indexOf(',') != -1 && $("#drop_off_location").val().indexOf('USA') != -1 && $("#drop_off_location").val().indexOf('Canada') != -1) {
	if(selected_zipcode != '' && select_dropoff_city != '' && select_dropoff_state != '' && select_dropoff_country != '')
	{
		$("#drop_off_location").val(selected_zipcode+', '+select_dropoff_city+', '+select_dropoff_state+', '+select_dropoff_country);
	}
}
else
{
	if(selected_zipcode!=''){
 $.ajax({
            url: "<?php echo base_url(); ?>org_transportation/get_zip_code2/" ,
            dataType: "json",
            data:
            {
                term: selected_zipcode,
				city: $("#drop_city" ).val(),
				state: $("#drop_state" ).val()
            },
            success: function (data)
            {
				//alert(data);
				//alert(data.length);
				//console.log(data);
				//console.log(data[0].label);
				if(data)
				{
				$("#drop_off_location" ).val(data[0].label);
				$("#drop_zip" ).val(data[0].value);
				$("#drop_country" ).val(data[0].st_country);
				country_state(data[0].st_country,"drop");
				$("#drop_city" ).val(data[0].city);
				$("#drop_state" ).val(data[0].state_prefix);
				}
				else
				{
					if($("#drop_off_location").val().indexOf(',') == -1)
					{
						alert('Please enter valid to location');	
						$("#drop_off_location").val("");
					}
				}
            }
        });	
	}//!=''		
}
});


$('#pickup_airport').autocomplete ({
		source: function (request, response)
   		 {
			request.term = $.trim(request.term);
			var str	= request.term;
			var letters = /^[a-zA-Z ]+$/;	
			if(str.match(letters))
			{
				request.term = str; 
			} else {
				str = str.toUpperCase();
				request.term = str.replace(/\s/g, ''); 
			}	 
			$.ajax(
			{
				//url: "<?php echo base_url(); ?>org_transportation/get_airports_by_zipcode/" ,
				url: "<?php echo base_url(); ?>org_transportation/get_airports_by_zipcode_or_airport_id/" ,
				dataType: "json",
				data:
				{
					term: request.term
				},
				success: function (data)
				{
					//alert(data);
					//return false;
					//response(data);
					if(data=="1")
					{
						window.location.href="<?php echo base_url() ?>";
					}
					/*if(data == null || data === '')
					{
						alert('Please enter valid from Zipcode/Airport ID');
						$("#pickup_airport").val('');
					}
					else*/
					if(1)
					{
						response(data);
					}
					
				}
			});
  	  	},
		minLength:1,
		open: function() { $('.ui-menu').width($("#pickup_airport" ).width()) },
		focus: function( event, ui ) {
				var id = ui.item.label;
				//alert(id);
				var name = ui.item.value;
				$( "#pickup_airport" ).val(name);
				$( "#pickup_airport_state" ).val(ui.item.st_state);
				$( "#pickup_airport_city" ).val(ui.item.st_city);
				return false;
		},     
		select: function( event, ui ) {
			var id = ui.item.label;
			var name = ui.item.value;
			$("#pickup_airport" ).val(name);
			$("#pickup_airport_state" ).val(ui.item.st_state);
			$("#pickup_airport_city" ).val(ui.item.st_city);
			return false;
		}
	});	
		
$('#pickup_airport').live('change',function(){
//var selected_zipcode = $(this).val();
var selected_zipcode = $.trim($(this).val());
var str	= selected_zipcode; 
//selected_zipcode = str.replace(/\s/g, ''); 
var letters = /^[a-zA-Z ]+$/;	
if(str.match(letters))
{
			 selected_zipcode = str; 
} else {
			 str = str.toUpperCase();  	
			 selected_zipcode = str.replace(/\s/g, ''); 
}
//alert($("#pick_city" ).val());
var select_pickup_city = $("#pickup_airport_city" ).val();
//alert(select_pickup_city);
var select_pickup_state = $("#pickup_airport_state" ).val();
//alert(select_pickup_state);
//var select_pickup_country = $("#pickup_country" ).val();
//alert(select_pickup_country);
//alert($("#pick_zip").val());
//alert($("#pick_zip").val().indexOf(','));

if ($("#pickup_airport").val().indexOf(',') != -1 && $("#pickup_airport").val().indexOf('USA') != -1 && $("#pickup_airport").val().indexOf('Canada') != -1) {
	if(selected_zipcode != '' && select_pickup_city != '' && select_pickup_state != '' && select_pickup_country != '')
	{
		//$("#pickup_location").val(selected_zipcode+', '+select_pickup_city+', '+select_pickup_state+', '+select_pickup_country);
	}
}
else
{
	if(selected_zipcode!=''){
	 $.ajax({
            url: "<?php echo base_url(); ?>org_transportation/get_airports_by_zipcode_or_airport_id/" ,
            dataType: "json",
            data:
            {
                term: selected_zipcode,
				city: $("#pickup_airport_city" ).val(),
				state: $("#pickup_airport_state" ).val()
            },
            success: function (data)
            {
				//alert(data);
				//alert(data.length);
				//console.log(data);
				//console.log(data[0].label);
				if(data)
				{
				var name = data[0].label;
				//alert(name);
				$( "#pickup_airport" ).val(data[0].label);
				$( "#pickup_airport_state" ).val(data[0].st_state);
				$( "#pickup_airport_city" ).val(data[0].st_city);
				}
				else
				{
					if(data == null || data === '')
					{
						alert('Please enter valid from location');
						$("#pickup_airport").val('');
					}
				}
				
            }
        });	
	}//!=''		
}
});
	
	$('#dropoff_airport').autocomplete ({
		source: function (request, response)
   		 {
			 request.term = $.trim(request.term);
			var str	= request.term;
			var letters = /^[a-zA-Z ]+$/;	
			if(str.match(letters))
			{
				request.term = str; 
			} else {
				str = str.toUpperCase();
				request.term = str.replace(/\s/g, ''); 
			}
			$.ajax(
			{
				url: "<?php echo base_url(); ?>org_transportation/get_airports_by_zipcode_or_airport_id/" ,
				dataType: "json",
				data:
				{
					term: request.term
				},
				success: function (data)
				{
					if(data=="1")
					{
						window.location.href="<?php echo base_url() ?>";
					}
					/*if(data == null || data === '')
					{
						alert('Please enter valid to Zipcode/Airport ID');
						$("#dropoff_airport").val('');
					}
					else*/
					if(1)
					{
						response(data);
					}
				}
			});
  	  	}, 
		minLength:1,
		open: function() { $('.ui-menu').width($("#dropoff_airport" ).width()) },
		focus: function( event, ui ) {
				var id = ui.item.label;
				var name = ui.item.value;
				$("#dropoff_airport" ).val(name);
				$("#dropoff_airport_state" ).val(ui.item.st_state);
				$("#dropoff_airport_city" ).val(ui.item.st_city);
				return false;
		},     
		select: function( event, ui ) {
			var id = ui.item.label;
			var name = ui.item.value;
			$("#dropoff_airport" ).val(name);
			$("#dropoff_airport_state" ).val(ui.item.st_state);
			$("#dropoff_airport_city" ).val(ui.item.st_city);
			return false;
		}
	});	
});
$('#dropoff_airport').live('change',function(){
//var selected_zipcode = $(this).val();
var selected_zipcode = $.trim($(this).val());
var str	= selected_zipcode; 
//selected_zipcode = str.replace(/\s/g, '');
var letters = /^[a-zA-Z ]+$/;	
if(str.match(letters))
{
			 selected_zipcode = str; 
} else {
			 str = str.toUpperCase();  	
			 selected_zipcode = str.replace(/\s/g, ''); 
} 
//alert($("#pick_city" ).val());
var select_pickup_city = $("#dropoff_airport_city" ).val();
//alert(select_pickup_city);
var select_pickup_state = $("#dropoff_airport_state" ).val();
//alert(select_pickup_state);
//var select_pickup_country = $("#pickup_country" ).val();
//alert(select_pickup_country);
//alert($("#pick_zip").val());
//alert($("#pick_zip").val().indexOf(','));

if ($("#dropoff_airport").val().indexOf(',') != -1 && $("#dropoff_airport").val().indexOf('USA') != -1 && $("#dropoff_airport").val().indexOf('Canada') != -1) {
	if(selected_zipcode != '' && select_pickup_city != '' && select_pickup_state != '' && select_pickup_country != '')
	{
		//$("#pickup_location").val(selected_zipcode+', '+select_pickup_city+', '+select_pickup_state+', '+select_pickup_country);
	}
}
else
{
	if(selected_zipcode!=''){
	  $.ajax({
            url: "<?php echo base_url(); ?>org_transportation/get_airports_by_zipcode_or_airport_id/" ,
            dataType: "json",
            data:
            {
                term: selected_zipcode,
				city: $("#dropoff_airport_city" ).val(),
				state: $("#dropoff_airport_state" ).val()
            },
            success: function (data)
            {
				//alert(data);
				//alert(data.length);
				//console.log(data);
				//console.log(data[0].label);
				if(data)
				{
				var name = data[0].label;
				//alert(name);
				$( "#dropoff_airport" ).val(data[0].label);
				$( "#dropoff_airport_state" ).val(data[0].st_state);
				$( "#dropoff_airport_city" ).val(data[0].st_city);
				}
				else
				{
					if(data == null || data === '')
					{
						alert('Please enter valid to location');
						$("#dropoff_airport").val('');
					}
				}
				
            }
        });	
	}//!=''		
}
}); 
	
	
	function change_origin_details()
{
	if($("#pick_city").val() == '')
	{
		alert('Please enter city name.');
		return false;
	}
	if($("#pickup_state").val() == '')
	{
		alert('Please select state name.');
		return false;
	}
	if($("#popup_zipcode").val() == '')
	{
		alert('Origin zip code is required.');
		return false;
	}
	//alert($('#pick_country').val());
	//$('#pick_zip').val($('#popup_zipcode').val()+", "+$('#pick_city').val()+", "+$('#pick_state').val()+", "+$('#pick_country').val());
	//$('#pick_zip').val($('#zipcode_list').val()+", "+$('#pick_city').val()+", "+$('#pick_state').val()+", "+$('#pick_country').val());	
	//$('#pick_up_location').val($('#zipcode_list').val()+", "+$('#pick_city').val()+", "+$('#pickup_state').val()+", "+$('#pick_country').val());
	$('#pick_up_location').val($('#zipcode_list').val()+", "+$('#pick_city').val()+", "+$('#pickup_state').val());	
	$('#zip-search').modal('hide');
	//$('#pick_city').val('');
	//$('#pick_state').val('');
	//$('#pick_country').val('');
	$('#popup_zipcode').val('');
	$('#popup_zip_div').show();
	var str_zipcode1 = '<input type="text" readonly="" name="popup_zipcode" id="popup_zipcode" class="form-control display-zipcode" placeholder="Zip code will appear here">';
	$('#popup_zip_div').html(str_zipcode1);	
	
}





function change_destination_details()
{   
	if($("#drop_city").val() == '')
	{
		alert('Please enter city name.');
		return false;
	}
	if($("#drop_state").val() == '')
	{
		alert('Please select state name.');
		return false;
	}
	if($("#popup_zipcode_drop").val() == '')
	{
		alert('Destination zip code is required.');
		return false;
	}
	//$('#drop_zip').val($('#popup_zipcode').val()+", "+$('#pick_city').val()+", "+$('#pick_state').val()+", "+$('#pick_country').val());
	//$('#drop_off_location').val($('#zipcode_list').val()+", "+$('#drop_city').val()+", "+$('#drop_state').val()+", "+$('#drop_country').val());
	$('#drop_off_location').val($('#zipcode_list').val()+", "+$('#drop_city').val()+", "+$('#drop_state').val());
	$('#drop-zip-search').modal('hide');
	//$('#pick_city').val('');
	//$('#pick_state').val('');
	//$('#pick_country').val('');
	$('#popup_zipcode_drop').val('');
	$('#popup_zip_div').show();
	var str_zipcode1 = '<input type="text" readonly="" name="popup_zipcode_drop" id="popup_zipcode_drop" class="form-control display-zipcode" placeholder="Zip code will appear here">';
	$('#popup_zip_div_drop').html(str_zipcode1);	
	
}

function country_state(country_name,state_id)
{
			//var country_name = $(this).val();
			//var state_id = $(this).attr('data-address');
			var state_list = '';
			if(country_name == 'USA') {
					state_list += '<option value="">Select</option>';
					state_list += '<?php foreach($this->common_function->state_list as $key=>$val) { ?>';
					state_list += ' <option value="<?php echo $key; ?>"><?php echo $val;  ?></option>';
					state_list += '<?php } ?>';
				
			} else {
					state_list += '<option value="">Select</option>';
					state_list += '<?php foreach($this->common_function->canadian_state_list as $key=>$val) { ?>';
					state_list += ' <option value="<?php echo $key; ?>"><?php echo $val;  ?></option>';
					state_list += '<?php } ?>';
					
			}
			$('#'+state_id+'_state').html(state_list);
}
</script> 
<!-- END PAGE LEVEL SCRIPTS --> 
<!--Date Picker--> 
<script>
heightFix ();			 
function heightFix (){
	var leftcol = $('#leftcolumn').height();
	var mapheight = leftcol;
    var minheightstyles = {'min-height':875};
	$('#tab_2_2, #tab_2_1, #tab_2_3,#route-map,#map,#avia-route').height(mapheight);
    $('#tab_2_2, #tab_2_1, #tab_2_3,#route-map,#map,#avia-route').css(minheightstyles)  
} 

(function($,sr){
  var debounce = function (func, threshold, execAsap) {
      var timeout;

      return function debounced () {
          var obj = this, args = arguments;
          function delayed () {
              if (!execAsap)
                  func.apply(obj, args);
              timeout = null;
          };

          if (timeout)
              clearTimeout(timeout);
          else if (execAsap)
              func.apply(obj, args);

          timeout = setTimeout(delayed, threshold || 100);
      };
  }
  // smartresize 
  jQuery.fn[sr] = function(fn){  return fn ? this.bind('resize', debounce(fn)) : this.trigger(sr); };

})(jQuery,'smartresize');

// usage:
$(window).smartresize(function(){
  heightFix ();
});

$(document).ready(function(){
var height_scroll =  $('.multi-legs ul').height();
var height_scroll2 = 0;
if(start_li!='' && start_li>0)
{
var height_scroll2=0;
$(".multi-legs ul li:lt("+(start_li-1)+")").each(function() {
   height_scroll2 += $(this).outerHeight(true); // to include margins
});
//console.log(height_scroll);
//console.log(height_scroll2);
//$('.multi-legs').animate({scrollTop: height_scroll2}, 'slow');
$( ".multi-legs" ).scrollTop( height_scroll2);
}
});		
</script> 
<script type="text/javascript">
$(window).load(function(){
	
	<?php if($this->session->flashdata('success_recommend')): ?>
		$('#thanku-suggest-leg').modal('show');
		<?php endif; ?>

	var current_notification = $('.timeline-red').length;
    	current_notification = parseInt(current_notification)+parseInt($('.timeline-yellow').length);
		current_notification = parseInt(current_notification)+parseInt($('.timeline-green').length);
	var total_rows = '<?php echo $totalrecord; ?>';
	//alert(total_rows);
	if(current_notification == total_rows) {
		$('.view_more').hide();
	} else {
		$('.view_more').show();
	}
	
});

</script> 
<script>
$(document).ready(function(){
var user_vehicle_count = $('#user_vehicle_count').val();
//alert(user_vehicle_count);
if(user_vehicle_count == 0){
$("#change_vehicle_info,#change_vehicle").hide();
}

$('#recommend-legs').click(function () {
	   $('#recommend-legs').hide('fast');
	   $('.suggestion-text').hide('fast');
	   $('#recommend-own-box').show('fast');
	   $(".view_map_tg").attr('id' , 'grid-view');
	   //alert($('#recommend-own-box').height());
	   //setTimeout(function(){ $(window).trigger('resize'); }, 200);	
	   //$("#main-transportation-route").height($("#leftheight").height());
	   //$("#route-map").height('1013');
	   //$("#route-map").css('height','1013');
	   //initialize();
	  
});

$('#cancel_recommend').click(function () {
	//$("#main-transportation-route").height($("#leftheight").height());
	
	   $('#recommend-legs').show('fast');
	   $('.suggestion-text').show('fast');
	   $('#recommend-own-box').hide('fast');
	    if($.trim($('.transport-view-map')[0].outerText)=="View Map")
			$(".view_map_tg").attr('id','grid-view');
		else
			$(".view_map_tg").attr('id','map-hide');
	    
	   //setTimeout(function(){ $(window).trigger('resize'); }, 200);	
 //$("#route-map").css('height','364');
	//initialize();
});

$('#cancel_recommend_avia').click(function () {
					//$("#main-transportation-route").height($("#leftheight").height());
					
					   $('#recommend-legs').show('fast');
					   $('.suggestion-text').show('fast');
					   $('#recommend-own-box').hide('fast');
					    $(".view_map_tg").attr('id' , 'map-hide');
					   //setTimeout(function(){ $(window).trigger('resize'); }, 200);	
					   //$("#route-map").css('height','364');
					   //initialize();
				});

$('#legground').click(function () {
	   $('#aviation-leg').hide('fast');
	   $('#ground-leg').show('fast');
	   //setTimeout(function(){ $(window).trigger('resize'); }, 200);
});
$('#legaviation').click(function () {
	  $('#ground-leg').hide('fast');
	  $('#aviation-leg').show('fast');
	  //setTimeout(function(){ $(window).trigger('resize'); }, 200);
 });
				
});
</script> 
<!-- END JAVASCRIPTS --> 

<!-- END PAGE LEVEL SCRIPTS --> 
<script type="text/javascript">

var decodeEntities = (function () {
        //create a new html document (doesn't execute script tags in child elements)
        var doc = document.implementation.createHTMLDocument("");
        var element = doc.createElement('div');

        function getText(str) {
            element.innerHTML = str;
            str = element.textContent;
            element.textContent = '';
            return str;
        }

        function decodeHTMLEntities(str) {
            if (str && typeof str === 'string') {
                var x = getText(str);
                while (str !== x) {
                    str = x;
                    x = getText(x);
                }
                return x;
            }
        }
        return decodeHTMLEntities;
    })();
	
$(window).resize(function() {
	//$('.ui-autocomplete').hide();
});


$('#select_leg').live('click',function(){
		//alert($('#action').val());
		$('#buttons3').hide();
		$(".cancel_leg").hide();
		$(".loder_cancel").hide();
		$("#select_leg").hide();
		$('#loadimg').show();
		$('#legs_select').submit();
		return true;
});

$( ".map" ).click(function() {
  $( ".view-map-cont" ).toggle();
  //alert($(".transport-view-map").html());
		if($(".transport-view-map").html() == '<i class="fa fa-eye"></i> View Map')
		{
			//$("#main-transportation-route").height($("#leftheight").height());
			$(".transport-view-map").html('<i class="fa fa-eye-slash"></i> Hide Map'); 
			$(".view_map_tg").attr('id' , 'map-hide');  // Set id for each div 
			initialize();			
		}
		else if($(".transport-view-map").html() == '<i class="fa fa-eye-slash"></i> Hide Map')
		{
			//$("#main-transportation-route").height($("#leftheight").height());
			$(".transport-view-map").html('<i class="fa fa-eye"></i> View Map');
			$(".view_map_tg").attr('id' , 'grid-view');
		}
});

</script> 
<script>            
	jQuery(document).ready(function() {
	
	<?php if($transport_details['st_trans_type']=='P') { ?>
		$("#main-transportation-route").attr("style", "position:relative; display: none;") 
		$(".view_map_tg").attr('id' , 'grid-view');  // Set id for each div 
	<?php } ?>
	
		var offset = 220;
		var duration = 500;
		jQuery(window).scroll(function() {
			if (jQuery(this).scrollTop() > offset) {
				jQuery('.crunchify-top').fadeIn(duration);
			} else {
				jQuery('.crunchify-top').fadeOut(duration);
			}
		});
 
		jQuery('.crunchify-top').click(function(event) {
			event.preventDefault();
			jQuery('html, body').animate({scrollTop: 0}, duration);
			return false;
		})
		
			var isMobile = {
			Android: function() {
				return navigator.userAgent.match(/Android/i);
			},
			BlackBerry: function() {
				return navigator.userAgent.match(/BlackBerry/i);
			},
			iOS: function() {
				return navigator.userAgent.match(/iPhone|iPad|iPod/i);
			},
			Opera: function() {
				return navigator.userAgent.match(/Opera Mini/i);
			},
			Windows: function() {
				return navigator.userAgent.match(/IEMobile/i);
			},
			any: function() {
				return (isMobile.Android() || isMobile.BlackBerry() || isMobile.iOS() || isMobile.Opera() || isMobile.Windows());
			}
		};
		
		if(isMobile.any()) {
			//alert('this is mobile');
			$('#crunchify-top').addClass('crunchify-top-display-important');	
			$('#crunchify-top').removeClass('crunchify-top-hide-important');	
				
		}else{
			//alert('this is not mobile');
			$('#crunchify-top').removeClass('crunchify-top-display-important');
			$('#crunchify-top').addClass('crunchify-top-hide-important');			
			} 
	});
	
	function initialize() {		
// create the map
	//alert('display map');
	 return Doobert.components.transportation_route.Base = flight.component(function () {
            return this.after("initialize", function () {
                var t = this;
                return void 0 !== Doobert.components.Overlay && Doobert.components.Overlay.attachTo("#main-transportation-route"), 
				this.trigger("map.initialize", {
                    routeMapSelector: "#route-map"
                })
            })
        }), Doobert.components.transportation_route.Base.attachTo("#main-transportation-route")
		
	}	
</script>

<script>
$(window).load(function() {
	//$("#main-transportation-route").height($("#leftheight").height());
	$("#transport-legs-detail").height($("#leg-inner-cont").height());
})
$( window ).resize(function() {
  //$("#main-transportation-route").height($("#leftheight").height());
  $("#transport-legs-detail").height($("#leg-inner-cont").height());
})
</script>
<script>



function get_zipcode(city,state,zip,country)
{
	//alert($("#"+city).val());
	//alert($("#"+state).val());
	
	if($("#"+city).val() == '')
	{
		alert('Please enter city name.');
		return false;
	}
	if($("#"+state).val() == '')
	{
		alert('Please select state name.');
		return false;
	}
	if($("#"+state).val()!='' && $("#"+city).val()!='')
	{
		
		$.ajax({
			  type: "POST",
			  url: '<?php echo base_url(); ?>org_transportation/get_zip_code_data/',
			  beforeSend: function(){
				 $('#loader').show();
			  },
			  data: {
				  state:$("#"+state).val(),
				  city:$("#"+city).val(),
				  action:"zip"
			  },
			  dataType:"json",
			  
			  complete: function(){
				$('#loader').hide();
			  },
			  success:function(data){
				  //alert(data.zipcodes);
					var arr_zipcodes = data.zipcodes;												
					//alert(arr_zipcodes.length);
					//return false;
					var str_zipcode = '';
					
					if(arr_zipcodes.length > 0) {
					str_zipcode += "<select name='zipcode_list' id='zipcode_list' class='form-control' style='width:100%;'>";	
						$.each( arr_zipcodes, function( key, value ) {	
							
							str_zipcode += "<option";
							str_zipcode += " value = "+value.zip_code+">";
							str_zipcode += value.zip_code;
							str_zipcode += "</option>";	
						});
						str_zipcode += "</select>";	
						//alert(str_zipcode);
						$('#popup_zip_div').html(str_zipcode);					
					} else {
						alert('Zip code not found for provided city/state.');
				return false;
					}
			  }	
		   });
	 	
	}
}

function get_zipcode_drop(city,state,zip,country)
{  
	//alert($("#"+city).val());
	//alert($("#"+state).val());
	if($("#"+city).val() == '')
	{
		alert('Please enter city name.');
		return false;
	}
	if($("#"+state).val() == '')
	{
		alert('Please select state name.');
		return false;
	}
	if($("#"+state).val()!='' && $("#"+city).val()!='')
	{
		
		$.ajax({
			  type: "POST",
			  url: '<?php echo base_url(); ?>org_transportation/get_zip_code_data/',
			  beforeSend: function(){
				 $('#loader').show();
			  },
			  data: {
				  state:$("#"+state).val(),
				  city:$("#"+city).val(),
				  action:"zip"
			  },
			  dataType:"json",
			  
			  complete: function(){
				$('#loader').hide();
			  },
			  success:function(data){
				  //alert(data.zipcodes);
					var arr_zipcodes = data.zipcodes;												
					//alert(arr_zipcodes.length);
					//return false;
					var str_zipcode = '';
					
					if(arr_zipcodes.length > 0) {
					str_zipcode += "<select name='zipcode_list' id='zipcode_list' class='form-control' style='width:40%;'>";	
						$.each( arr_zipcodes, function( key, value ) {	
							
							str_zipcode += "<option";
							str_zipcode += " value = "+value.zip_code+">";
							str_zipcode += value.zip_code;
							str_zipcode += "</option>";	
						});
						str_zipcode += "</select>";	
						//alert(str_zipcode);
						$('#popup_zip_div_drop').html(str_zipcode);					
					} else {
						alert('Zip code not found for provided city/state.');
				return false;
					}
			  }	
		   });	 	
	}
}
</script>



<script>
equalheight = function(container){

var currentTallest = 0,
     currentRowStart = 0,
     rowDivs = new Array(),
     $el,
     topPosition = 0;
 $(container).each(function() {

   $el = $(this);
   $($el).height('auto')
   topPostion = $el.position().top;

   if (currentRowStart != topPostion) {
     for (currentDiv = 0 ; currentDiv < rowDivs.length ; currentDiv++) {
       rowDivs[currentDiv].height(currentTallest);
     }
     rowDivs.length = 0; // empty the array
     currentRowStart = topPostion;
     currentTallest = $el.height();
     rowDivs.push($el);
   } else {
     rowDivs.push($el);
     currentTallest = (currentTallest < $el.height()) ? ($el.height()) : (currentTallest);
  }
   for (currentDiv = 0 ; currentDiv < rowDivs.length ; currentDiv++) {
     rowDivs[currentDiv].height(currentTallest);
   }
 });
}

$(window).load(function() {
  equalheight('.transport-legs-detail li');
});

$(window).resize(function(){
  equalheight('.transport-legs-detail li');
});


$(window).load(function() {
  equalheight('.transport-legs-detail h3');
});

$(window).resize(function(){
  equalheight('.transport-legs-detail h3');
});

$(window).load(function() {
  equalheight('.transport-legs-detail .leg-inner-cont');
});

$(window).resize(function(){
  equalheight('.transport-legs-detail .leg-inner-cont');
});
</script>
<script>
$(window).smartresize(function() {
		jQuery(".gr-wrap .volunteered-box-info .top-part").height('auto');
	    jQuery(".gr-wrap .volunteered-box-info .volunteer-middle-slider-part").height('auto');
		jQuery(".gr-wrap .volunteered-box-info .bottom-part").height('auto');
      
        function equalHeight(group) {
            tallest = 0;
            group.each(function() {
                thisHeight = jQuery(this).height();
                if (thisHeight > tallest) {
                    tallest = thisHeight;
                }
            });
            group.height(tallest);
        }
		equalHeight(jQuery(".gr-wrap .volunteered-box-info .top-part"));
		equalHeight(jQuery(".gr-wrap .volunteered-box-info .volunteer-middle-slider-part"));
		equalHeight(jQuery(".gr-wrap .volunteered-box-info .bottom-part"));
    });
</script>
<script>
$('.preview').popover({'trigger':'hover','html':true,'animation':false});
</script>
</body>
<!-- END BODY -->
</html>