<?php
$base_url = $this->config->item('base_url');
$admin_base_url = $this->config->item('admin_base_url');
$page = "questions";
?>

<!DOCTYPE html>
<!-- 
Template Name: DMK Education Portal - Responsive Admin Dashboard Template build with Twitter Bootstrap 3.3.6
Version: 4.5.5
Author: Pulse Solutions
Website: http://www.pulsesolutions.com/
Contact: dilip@pulsesolutions.net
Follow: www.twitter.com/pulsesolutions
Dribbble: www.dribbble.com/pulsesolutions
Like: www.facebook.com/pulsesolutions
Purchase: http://themeforest.net/item/metronic-responsive-admin-dashboard-template/4021469?ref=keenthemes
License: You must have a valid license purchased only from themeforest(the above link) in order to legally use the theme for your project.
-->
<!--[if IE 8]> <html lang="en" class="ie8 no-js"> <![endif]-->
<!--[if IE 9]> <html lang="en" class="ie9 no-js"> <![endif]-->
<!--[if !IE]><!-->
<html lang="en">
    <!--<![endif]-->
    <!-- BEGIN HEAD -->

    <head>
        <meta charset="utf-8" />
        <title>MyDMK | Manage Predefined Questions</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta content="width=device-width, initial-scale=1" name="viewport" />
        <meta content="" name="description" />
        <meta content="" name="author" />

        <!-- BEGIN GLOBAL MANDATORY, THEME GLOBAL, THEME LAYOUT STYLES -->
        <?php include('includes/common-styles.php'); ?>
        <!-- END GLOBAL MANDATORY, THEME GLOBAL, THEME LAYOUT STYLES -->

        <!-- BEGIN GLOBAL MANDATORY STYLES -->

        <!-- END GLOBAL MANDATORY STYLES -->

        <!-- BEGIN PAGE LEVEL PLUGINS FOR EVENTS PAGE -->
        <link href="<?php echo $base_url; ?>assets/global/plugins/datatables/datatables.min.css" rel="stylesheet" type="text/css" />
        <link href="<?php echo $base_url; ?>assets/global/plugins/icheck/skins/all.css" rel="stylesheet" type="text/css" />
        <link href="<?php echo $base_url; ?>assets/global/plugins/datatables/plugins/bootstrap/datatables.bootstrap.css" rel="stylesheet" type="text/css" />
        <link href="<?php echo $base_url; ?>assets/global/plugins/select2/css/select2.min.css" rel="stylesheet" type="text/css" />
        <link href="<?php echo $base_url; ?>assets/global/plugins/select2/css/select2-bootstrap.min.css" rel="stylesheet" type="text/css" />
        <link href="<?php echo $base_url; ?>assets/global/plugins/bootstrap-datepicker/css/bootstrap-datepicker.min.css" rel="stylesheet" type="text/css" />
        <!-- END PAGE LEVEL PLUGINS FOR EVENTS PAGE -->

        <!-- BEGIN THEME GLOBAL STYLES -->

        <!-- END THEME GLOBAL STYLES -->

        <!-- BEGIN THEME LAYOUT STYLES -->

        <!-- END THEME LAYOUT STYLES -->
       <!--<link rel="shortcut icon" href="favicon.ico" />-->

        <!-- BEGIN COMMON POPUPS -->
        <?php include('includes/common-popups.php'); ?>
        <!-- END COMMON POPUPS -->

    </head>
    <!-- END HEAD -->

    <body class="page-header-fixed page-sidebar-closed-hide-logo page-content-white">
        <!-- BEGIN HEADER -->
        <?php include('includes/header.php'); ?>
        <!-- END HEADER --> 
        <!-- BEGIN HEADER & CONTENT DIVIDER -->
        <div class="clearfix"> </div>
        <!-- END HEADER & CONTENT DIVIDER --> 
        <!-- BEGIN CONTAINER -->
        <div class="page-container"> 
            <!-- BEGIN SIDEBAR -->
            <?php include('includes/navigation.php'); ?>
            <!-- END SIDEBAR --> 
            <!-- BEGIN CONTENT -->
            <div class="page-content-wrapper"> 
                <!-- BEGIN CONTENT BODY -->
                <div class="page-content"> 
                    <!-- BEGIN PAGE HEADER-->
                    <div id="loader" style="display: none;"><img src="<?php echo base_url(); ?>assets/pages/img/loader.gif" width="45" height="45" align="absmiddle">&nbsp;<span id="loadertext">Loading...</span></div>
                    <?php if ($this->session->userdata('event_added')) { ?>
                        <div class="alert alert_success">
                            <button class="close" title="Close" data-close="alert"></button>
                            <span><?php echo $this->session->userdata('event_added'); ?>  </span> 
                        </div> 
                        <?php
                        $this->session->unset_userdata('event_added');
                    }
                    ?>
                    <?php if ($this->session->userdata('copy_event')) { ?>
                        <div class="alert alert_success">
                            <button class="close" title="Close" data-close="alert"></button>
                            <span><?php echo $this->session->userdata('copy_event'); ?>  </span> 
                        </div> 
                        <?php
                        $this->session->unset_userdata('copy_event');
                    }
                    ?>
                    <div class="page-bar">
                        <h3 class="page-title">Manage Predefined Questions</h3>
                        <div class="actions">
                            <div class="btn-group btn-group-devided">
								<a href="<?php echo $admin_base_url; ?>questions/add" class="btn grey-salsa"> Add New <i class="fa fa-plus"></i></a>
							</div>
                        </div>
                    </div>

                    <!-- END PAGE HEADER-->

                    <div class="clearfix"></div>

                    <!-- BEGIN BORDERED TABLE PORTLET-->
                    <div id="event_div">
                        <div class="portlet light bordered">

                           
							
							<div class="row" style="margin-top:18px;">
								
				
								
								<div class="col-md-3 col-sm-3 search-input-box">
									<div id="custom-search-input" class="col-md-11 col-xs-12">
										
											<div class="input-group col-md-12">
												<input type="text" class="search-query" name="search_text" id="search_text" placeholder="Enter Keywords" value="<?php if(isset($search_text_val)){echo $search_text_val ;} ?>"/>
												<span class="input-group-btn">
													<button id="submit_search" class="btn btn-danger" type="button"> <i class="fa fa-search" aria-hidden="true"></i> </button>
												</span>
											</div>
											
									</div>
								</div>
							
							
								
                                <div class="col-lg-1 col-md-6 col-sm-6 col-xs-12 filters-info">
										<button onClick="clearFilter()" class="btn grey-salsa">Clear Filters</button>
								</div>
                           
						  
						   
							</div>
						   
                            <div class="portlet-body">
                               <div class="table-scrollable">
									<table class="table table-bordered table-hover teams_table" id="teams_table">
                                    <thead>
                                    <input type="hidden" name="sort" id="sort" value="">
                                    <input type="hidden" name="order" id="order" value="ASC"> 
                                    <tr>
										<th >&nbsp </th>
                                        <th width="200"><a href="javascript:void(0)" onClick="get_sorted_category('st_type')"> Type <span id="st_type" class="sortimg"></span></a></th>
										<th width="500"><a href="javascript:void(0)" onClick="get_sorted_category('st_question')"> Questions <span id="st_question" class="sortimg"></span></a></th>
										<th width="200"><a href="javascript:void(0)" onClick="get_sorted_category('in_ques_type')"> Question Type <span id="in_ques_type" class="sortimg"></span></a></th>
                                        <th width="200"><a href="javascript:void(0)" onClick="get_sorted_category('in_required')"> Mandatory <span id="in_ques_type" class="sortimg"></span></a></th>
                                        <th width="200"><a href="javascript:void(0)" onClick="get_sorted_category('dt_created')"> Date Created <span id="dt_created" class="sortimg"></span></a></th>
										<th width="200"><a href="javascript:void(0)" onClick="get_sorted_category('dt_modified')"> Date Modified <span id="dt_modified" class="sortimg"></span></a></th>
                                        <th width="200"><a href="javascript:void(0)" onClick="get_sorted_category('in_status')"> Status <span id="in_status" class="sortimg"></span></a></th>
										<th style="width:76px">&nbsp;</th>
                                    </tr>
                                    </thead>
                                    <tbody id="category_data">
                                       
                                    </tbody>
                                </table>
								</div>

                            </div>
                            <!-- END BORDERED TABLE PORTLET-->
                            <div class="clearfix"></div>
							
                            <!-- BEGIN TABLE PEGINATION-->
                            <?php // if(isset($total_rows) and $total_rows>0){?>
                            <div class="row" id="bootom_row">
                                <div class="col-md-12 col-sm-12">
                                    <div class="row">
										 <div class="col-md-1 col-sm-1" >
                                           
											
											<input type="button" value="Delete" name="delete_row" id="delete_row" class="btn green" onclick="delete_checked()"> 
									
                                          
                                        </div>
                                        <div class="col-md-5 col-sm-4">
                                            <div class="dataTables_length" id="sample_3_length">
                                                <label>Show
                                                    <select id="per-page" name="sample_3_length" aria-controls="sample_3" class="form-control input-sm input-xsmall input-inline filter_category">
                                                        <option value="10" <?php
                                                        if (isset($per_page) and $per_page == 10) {
                                                            echo 'selected';
                                                        }
                                                        ?>>10</option>
                                                        <option value="15" <?php
                                                        if (isset($per_page) and $per_page == 15) {
                                                            echo 'selected';
                                                        }
                                                        ?>>15</option>
                                                        <option value="20" <?php
                                                        if (isset($per_page) and $per_page == 20) {
                                                            echo 'selected';
                                                        }
                                                        ?>>20</option>
                                                        <option value="-1" <?php
                                                        if (isset($per_page) and isset($total_rows) and $per_page == $total_rows) {
                                                            echo 'selected';
                                                        }
                                                        ?>>All</option>
                                                    </select>
                                                </label>
                                            </div>
											
											  <div class="dataTables_info" id="sample_3_info" role="status" aria-live="polite"></div>
											<?php
												/* if($to == '-1')
												{
													?>
													  <div class="dataTables_info" id="sample_3_info" role="status" aria-live="polite">Showing 1 to <?php echo $total_rows; ?> of <?php echo $total_rows; ?> records.</div>
													 <?php
												}
												else{
												?>
												  <div class="dataTables_info" id="sample_3_info" role="status" aria-live="polite">Showing <?php echo $from; ?> to <?php echo $to; ?> of <?php echo $total_rows; ?> records.</div>
												<?php
												} */
											?>
                                          
                                        </div>
                                       
									   <div class="col-md-6 col-sm-6" id="dobt-pagination">
                                           
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <?php // } ?>
                            <!-- END TABLE PEGINATION--> 
                        </div>
                    </div>
					
                    <div class="clearfix"></div>
                </div>
                <!-- END CONTENT BODY --> 
            </div>
            <!-- END CONTENT --> 
        </div>
        <!-- END CONTAINER --> 
        <!-- BEGIN FOOTER -->
        <?php include('includes/footer.php'); ?>
        <!-- END FOOTER --> 

        <!-- BEGIN CORE PLUGINS, THEME GLOBAL, THEME LAYOUT SCRIPTS -->
        <?php include('includes/common-scripts.php'); ?>
        <!-- END CORE PLUGINS, THEME GLOBAL, THEME LAYOUT SCRIPTS --> 

        <!--[if lt IE 9]>
        
        <![endif]--> 

        <!-- BEGIN CORE PLUGINS --> 

        <!-- END CORE PLUGINS --> 

        <!-- BEGIN THEME GLOBAL SCRIPTS --> 

        <!-- END THEME GLOBAL SCRIPTS --> 
        <!-- BEGIN PAGE LEVEL PLUGINS EVENTS PAGE--> 
        <script src="<?php echo $base_url; ?>assets/global/plugins/bootstrap-datepicker/js/bootstrap-datepicker.min.js" type="text/javascript"></script> 
        <script src="<?php echo $base_url; ?>assets/global/plugins/icheck/icheck.min.js" type="text/javascript"></script> 
        <script src="<?php echo $base_url; ?>assets/global/scripts/datatable.js" type="text/javascript"></script> 
        <script src="<?php echo $base_url; ?>assets/global/plugins/datatables/datatables.min.js" type="text/javascript"></script> 
        <script src="<?php echo $base_url; ?>assets/global/plugins/datatables/plugins/bootstrap/datatables.bootstrap.js" type="text/javascript"></script> 
        <script src="<?php echo $base_url; ?>assets/global/plugins/select2/js/select2.full.min.js" type="text/javascript"></script> 
        <!-- END PAGE LEVEL PLUGINS EVENTS PAGE--> 

        <!-- BEGIN PAGE LEVEL SCRIPTS EVENTS PAGE--> 
        <script src="<?php echo $base_url; ?>assets/pages/scripts/components-date-time-pickers.min.js" type="text/javascript"></script>
        <script src="<?php echo $base_url; ?>assets/pages/scripts/form-icheck.min.js" type="text/javascript"></script>  
        <!-- <script src="<?php // echo $base_url; ?>assets/pages/scripts/table-datatables-managed.js" type="text/javascript"></script> -->
        <script src="<?php echo $base_url; ?>assets/pages/scripts/table-datatables-editable.js" type="text/javascript"></script> 
        <script src="<?php echo $base_url; ?>assets/pages/scripts/components-select2.min.js" type="text/javascript"></script> 
		
		<script src="<?php echo $base_url; ?>assets/plugins/jquery-1.10.2.min.js" type="text/javascript"></script>
        <!-- END PAGE LEVEL SCRIPTS EVENTS PAGE--> 

        <!-- BEGIN THEME LAYOUT SCRIPTS --> 

        <!-- END THEME LAYOUT SCRIPTS --> 

        <!-- BEGIN ADDITIONAL CUSTOM SCRIPTS --> 
        <script src="<?php echo $base_url; ?>assets/layouts/layout/scripts/custom.js" type="text/javascript"></script> 
        <!-- END ADDITIONAL CUSTOM SCRIPTS -->
		
		<script type="text/javascript">
            	// $('.checkbox').iCheck({
  // labelHover: false,
  // cursor: true
// });
	
		// $("input[type=checkbox]").uniform({buttonClass: 'checker'});
											// $(":checkbox").uniform({checkboxClass: 'checker'});
            function question_type(str){
                var arr = new Array();
                arr['Feedback'] = 'Event Feedback';
                arr['Onboarding'] = 'Clinic Onboarding';
                arr['Distributor'] = 'Clinic Distributor';
                arr['Ignite'] = 'Ignite';
                return arr[str];
            }


			$(document).ready(function(){
			
                    '<?php if($this->session->userdata('message')) { ?>'
                        //alert('message');
                        $("#modal_message_succes_fail").html('<?php echo $this->session->userdata('message'); ?>');
                        $("#dmk_resources_uploaded-success").modal('show');
                    '<?php   $this->session->unset_userdata('message');} ?>'  
				
				 $('#submit_search').on('click',function(){
					   filter_category();	
				   });
				   
				   $("#search_text").keyup(function(event){
							if(event.keyCode == 13){
							filter_category();	
						}
					});
					
					$('#sel_status').on('change',function(){
						filter_category();
					});
					
					$('#per-page').on('change',function(){
						filter_category();
					});
					
					autoload_category();
					
					$('#dobt-pagination').on('click','ul#test_pagination>li>a',function(){
						 
							 
							 $.ajax({
							  type: "POST",
							  url: $(this).attr('href'),
							  beforeSend: function(){
								  $('#loader').show();
							  },
							 data:{ 
									ajax:true, 
									
								 },
								
							 dataType:'json',
							  
							 complete: function(){
								$('#loader').hide();
								
							  },
							
							 success:function(data){
								  
								 console.log(data);
								  
								   $("#category_data").empty();
							  var row = '';
							  if(data.questions.length > 0)
							  {
										for(var i=0; i<data.questions.length;i++)
										{
											
											var in_ques_id = data.questions[i].in_ques_id;
                                            var st_type = data.questions[i].st_type;
											//var in_attribute_val = data.concerns[i].in_attribute_val;
											var st_question = data.questions[i].st_question;
											var in_ques_type = data.questions[i].in_ques_type;
                                            var in_required = data.questions[i].in_required;
                                            var in_status = data.questions[i].in_status;
											var ques_type_name;
											if(in_ques_type==1)
												ques_type_name="Input Text";
											if(in_ques_type==2)
												ques_type_name="Radio Button";
											if(in_ques_type==3)
												ques_type_name="Checkbox";
											if(in_ques_type==4)
												ques_type_name="Drop Down";
											if(in_ques_type==5)
												ques_type_name="Textarea";
											if(in_ques_type==6)
												ques_type_name="Upload Documents";												
												
											
											var dt_created = data.questions[i].dt_created;
											var dt_modified = data.questions[i].dt_modified;
											if(dt_created!=null  && dt_created!=undefined)
											{
												
												var dt_up=dt_created.split(" ");
											
												dt_created = dt_up[0].split('-');
												dt_created = dt_created[2] + '/' + dt_created[1] + '/' + dt_created[0].slice(-4);
												// alert(dt_created);
												
											}else
											{
												dt_created="";
											}
											if(dt_modified!=null && typeof dt_modified!='undefined' && dt_modified!="")
											{
											
												var dt_up=dt_modified.split(" ");
											
												dt_modified = dt_up[0].split('-');
												dt_modified = dt_modified[2] + '/' + dt_modified[1] + '/' + dt_modified[0].slice(-4);
												// alert(dt_modified);
											}else
											{
												dt_modified="";
											}
											if (in_status == 1) {
                                                status = 'Active';
                                            }else{
                                                status = 'InActive';
                                            }
                                            row += '<tr>';
                                            row += '<td><div class="input-group">'+
                                                            '<div class="icheck-inline">'+
                                                               '<label>'+
                                                                  ' <input type="checkbox" data-id='+in_ques_id+' class="checkbox" >'+
                                                                '</label>'+
                                                           '</div>'+
                                                       '</div></td>';
                                            row += '<td>'+question_type(st_type)+'</td>';           
                                            row += '<td>'+st_question+'</td>';
                                            row += '<td>'+ques_type_name+'</td>';
                                            if (in_required == 1) {
                                                row += '<td> Required </td>';
                                            }else{
                                                row += '<td> Optional </td>';
                                            }
                                            row += '<td>'+dt_created+'</td>';
                                            row += '<td>'+dt_modified+'</td>';
                                            row += '<td>'+status+'</td>';
    										if(status == 1){
    											label = 'label-green';
    											 
    										}else{
    											label = 'label-dark-gray';
    										}
    										row += '<td><a href="<?php echo $admin_base_url; ?>questions/edit/'+in_ques_id+'" class="label label-sm label-light-gray popovers" data-container="body" data-trigger="hover" data-placement="top" data-content="Edit" title="Edit"><i class="fa fa-pencil" aria-hidden="true"></i></a>&nbsp;<a onClick="return delete_record('+in_ques_id+')" href="javascript:;" class="label label-sm label-light-gray popovers remove_href" data-container="body" data-trigger="hover" data-placement="top" data-content="Edit" title="Delete"><i class="fa fa-trash" aria-hidden="true"></i></a></td>';
    										row += '</tr>';
												
										}
										$('#category_data').append(row);
										 $('#dobt-pagination').empty();
								   $('#dobt-pagination').append(data.pagination);
								   $('#sample_3_info').html('');
								 
									var str = 'Showing '+ data.from +' to '+ data.to + ' of '+ data.total_records + ' entries.';	
										
									$('#sample_3_info').html(str);	
								}
								  else
								  {
									var row ='<tr><td colspan="8" class="text-center">No Records Found.</td>';
									row +='</tr>';
									  
									$('#category_data').append(row);
								  }
										
								
							 $(":checkbox").uniform({checkboxClass: 'checker'}); 	
									
									
									
									
							  },
						});
					
						
						 
					});
	

            });
			
			function get_sorted_category(col)
			{
				var search_text = $('#search_text').val();
				// var sel_status = $('#sel_status').val();
				var rec_per_page = $('#per-page').val();
				var order = $('#order').val();
				$(".sortimg").empty();
				if(order == ''){
					order = 'ASC';
				}
				if(order == 'ASC')
				{
					$('#'+col).html('<img src="<?php echo $base_url; ?>assets/global/img/sort_asc.png" width="19" height="19" alt="">');
					$('#order').val('DESC');
				}
				else if(order == 'DESC')
				{
					$('#order').val('ASC');
					$('#'+col).html('<img src="<?php echo $base_url; ?>assets/global/img/sort_desc.png" width="19" height="19" alt="">');
				}
				
				
				$.ajax({
						  type: "POST",
						  url: "<?php echo $admin_base_url; ?>questions/ajax_load_categories/",
						  beforeSend: function(){
							  $('#loader').show();
						  },
						data:{ 
								ajax:true, 
								search_text : search_text,
								// sel_status : sel_status,
								rec_per_page : rec_per_page,
								sel_sort : col,
								sel_order : order,
								
							 },
						 	
						 dataType:'json',
						  
						 complete: function(){
							$('#loader').hide();
							
						  },
						
						 success:function(data){
							  
							 console.log(data);
							  
							   $("#category_data").empty();
							  var row = '';
							  if(data.questions.length > 0)
							  {
										for(var i=0; i<data.questions.length;i++)
										{
											
											var in_ques_id = data.questions[i].in_ques_id;
                                            var st_type = data.questions[i].st_type;
											//var in_attribute_val = data.concerns[i].in_attribute_val;
											var st_question = data.questions[i].st_question;
											var in_ques_type = data.questions[i].in_ques_type;
                                            var in_required = data.questions[i].in_required;
                                            var in_status = data.questions[i].in_status;
											var ques_type_name;
											if(in_ques_type==1)
												ques_type_name="Input Text";
											if(in_ques_type==2)
												ques_type_name="Radio Button";
											if(in_ques_type==3)
												ques_type_name="Checkbox";
											if(in_ques_type==4)
												ques_type_name="Drop Down";
											if(in_ques_type==5)
												ques_type_name="Textarea";
											if(in_ques_type==6)
												ques_type_name="Upload Documents";												
												
											
											var dt_created = data.questions[i].dt_created;
											var dt_modified = data.questions[i].dt_modified;
										    if(dt_created!=null  && dt_created!=undefined)
											{
												
												var dt_up=dt_created.split(" ");
											
												dt_created = dt_up[0].split('-');
												dt_created = dt_created[2] + '/' + dt_created[1] + '/' + dt_created[0].slice(-4);
												// alert(dt_created);
												
											}else
											{
												dt_created="";
											}
											if(dt_modified!=null && typeof dt_modified!='undefined' && dt_modified!="")
											{
											
												var dt_up=dt_modified.split(" ");
											
												dt_modified = dt_up[0].split('-');
												dt_modified = dt_modified[2] + '/' + dt_modified[1] + '/' + dt_modified[0].slice(-4);
												// alert(dt_modified);
											}else
											{
												dt_modified="";
											}
											if (in_status == 1) {
                                                status = 'Active';
                                            }else{
                                                status = 'InActive';
                                            }
                                            row += '<tr>';
                                            row += '<td><div class="input-group">'+
                                                            '<div class="icheck-inline">'+
                                                               '<label>'+
                                                                  ' <input type="checkbox" data-id='+in_ques_id+' class="checkbox" >'+
                                                                '</label>'+
                                                           '</div>'+
                                                       '</div></td>';
                                            row += '<td>'+question_type(st_type)+'</td>';
                                            row += '<td>'+st_question+'</td>';
                                            row += '<td>'+ques_type_name+'</td>';
                                            if (in_required == 1) {
                                                row += '<td> Required </td>';
                                            }else{
                                                row += '<td> Optional </td>';
                                            }
                                            row += '<td>'+dt_created+'</td>';
                                            row += '<td>'+dt_modified+'</td>';
                                            row += '<td>'+status+'</td>';
											if(status == 1){
												label = 'label-green';
												 
											}else{
												label = 'label-dark-gray';
											}
											row += '<td><a href="<?php echo $admin_base_url; ?>questions/edit/'+in_ques_id+'" class="label label-sm label-light-gray popovers" data-container="body" data-trigger="hover" data-placement="top" data-content="Edit" title="Edit"><i class="fa fa-pencil" aria-hidden="true"></i></a></td>';
											row += '</tr>';	
										}
										$('#category_data').append(row);
							  }
							  else
							  {
								var row ='<tr><td colspan="8" class="text-center">No Records Found.</td>';
								row +='</tr>';
								  
								$('#category_data').append(row);
							  }
									
							   $('#dobt-pagination').empty();
							   $('#dobt-pagination').append(data.pagination);
							   $('#sample_3_info').html('');
							 
								var str = 'Showing '+ data.from +' to '+ data.to + ' of '+ data.total_records + ' entries.';	
									
								$('#sample_3_info').html(str);	
								
						
							 $(":checkbox").uniform({checkboxClass: 'checker'}); 	
								
								
						  },
					});
				
				
			}
			
			function filter_category()
			{
				
				var search_text = $('#search_text').val();
				// var sel_status = $('#sel_status').val();
				var rec_per_page = $('#per-page').val();
				
				$.ajax({
						  type: "POST",
						  url: "<?php echo $admin_base_url; ?>questions/ajax_load_categories/",
						  beforeSend: function(){
							  $('#loader').show();
						  },
						data:{ 
								ajax:true, 
								search_text : search_text,
								// sel_status : sel_status,
								rec_per_page : rec_per_page,
								
							 },
						 	
						 dataType:'json',
						  
						 complete: function(){
							$('#loader').hide();
							
						  },
						
						 success:function(data){
							console.log(data);
							  
							  $("#category_data").empty();
							  var row = '';
							  if(data.questions.length > 0)
							  {
										for(var i=0; i<data.questions.length;i++)
										{
											
											var in_ques_id = data.questions[i].in_ques_id;
                                            var st_type = data.questions[i].st_type;
											//var in_attribute_val = data.concerns[i].in_attribute_val;
											var st_question = data.questions[i].st_question;
											var in_ques_type = data.questions[i].in_ques_type;
                                            var in_required = data.questions[i].in_required;
                                            var in_status = data.questions[i].in_status;
											var ques_type_name;
											if(in_ques_type==1)
												ques_type_name="Input Text";
											if(in_ques_type==2)
												ques_type_name="Radio Button";
											if(in_ques_type==3)
												ques_type_name="Checkbox";
											if(in_ques_type==4)
												ques_type_name="Drop Down";
											if(in_ques_type==5)
												ques_type_name="Textarea";
											if(in_ques_type==6)
												ques_type_name="Upload Documents";												
												
											
											var dt_created = data.questions[i].dt_created;
											var dt_modified = data.questions[i].dt_modified;
											if(dt_created!=null  && dt_created!=undefined)
											{
												
												var dt_up=dt_created.split(" ");
											
												dt_created = dt_up[0].split('-');
												dt_created = dt_created[2] + '/' + dt_created[1] + '/' + dt_created[0].slice(-4);
												// alert(dt_created);
												
											}else
											{
												dt_created="";
											}
											if(dt_modified!=null && typeof dt_modified!='undefined' && dt_modified!="")
											{
											
												var dt_up=dt_modified.split(" ");
											
												dt_modified = dt_up[0].split('-');
												dt_modified = dt_modified[2] + '/' + dt_modified[1] + '/' + dt_modified[0].slice(-4);
												// alert(dt_modified);
											}else
											{
												dt_modified="";
											}
											if (in_status == 1) {
                                                status = 'Active';
                                            }else{
                                                status = 'InActive';
                                            }
                                            row += '<tr>';
                                            row += '<td><div class="input-group">'+
                                                            '<div class="icheck-inline">'+
                                                               '<label>'+
                                                                  ' <input type="checkbox" data-id='+in_ques_id+' class="checkbox" >'+
                                                                '</label>'+
                                                           '</div>'+
                                                       '</div></td>';                                           
                                            row += '<td>'+question_type(st_type)+'</td>';
											 row += '<td>'+st_question+'</td>';
                                            row += '<td>'+ques_type_name+'</td>';
                                            if (in_required == 1) {
                                                row += '<td> Required </td>';
                                            }else{
                                                row += '<td> Optional </td>';
                                            }
                                            row += '<td>'+dt_created+'</td>';
                                            row += '<td>'+dt_modified+'</td>';
                                            row += '<td>'+status+'</td>';
											if(status == 1){
												label = 'label-green'; 
											}else{
												label = 'label-dark-gray';
											}
											row += '<td><a href="<?php echo $admin_base_url; ?>questions/edit/'+in_ques_id+'" class="label label-sm label-light-gray popovers" data-container="body" data-trigger="hover" data-placement="top" data-content="Edit" title="Edit"><i class="fa fa-pencil" aria-hidden="true"></i></a></td>';
											row += '</tr>';
												
										}
										$('#category_data').append(row);
										
							  }
							  else
							  {
								var row ='<tr><td colspan="8" class="text-center">No Records Found.</td>';
								row +='</tr>';
								  
								$('#category_data').append(row);
							  }
									
							   $('#dobt-pagination').empty();
							   $('#dobt-pagination').append(data.pagination);
							   $('#sample_3_info').html('');
							 
								var str = 'Showing '+ data.from +' to '+ data.to + ' of '+ data.total_records + ' entries.';	
									
								$('#sample_3_info').html(str);	
								
							 $(":checkbox").uniform({checkboxClass: 'checker'}); 	
								
								
								
						  },
					});
				
					
			}
			
			function autoload_category()
			{
				var search_text = $('#search_text').val();
				// var sel_status = $('#sel_status').val();
				
					$.ajax({
						  type: "POST",
						  url: "<?php echo $admin_base_url; ?>questions/ajax_load_categories/",
						  beforeSend: function(){
							  $('#loader').show();
						  },
						data:{ 
								ajax:true, 
								//sel_status : 1,
								// sel_status : sel_status,
								search_text : search_text
								
							 },
						 	
						 dataType:'json',
						  
						 complete: function(){
							$('#loader').hide();
							
						  },
						
						 success:function(data){
							  
							console.log(data);
							  
							  $("#category_data").empty();
							  var row = '';
							  if(data.questions.length > 0)
							  {
										for(var i=0; i<data.questions.length;i++)
										{
											
											var in_ques_id = data.questions[i].in_ques_id;
											//var in_attribute_val = data.concerns[i].in_attribute_val;
                                            var st_type = data.questions[i].st_type;
											var st_question = data.questions[i].st_question;
											var in_ques_type = data.questions[i].in_ques_type;
                                            var in_required = data.questions[i].in_required;
                                            var in_status = data.questions[i].in_status;
											var ques_type_name;
											if(in_ques_type==1)
												ques_type_name="Input Text";
											if(in_ques_type==2)
												ques_type_name="Radio Button";
											if(in_ques_type==3)
												ques_type_name="CheckBox";
											if(in_ques_type==4)
												ques_type_name="DropDown";
											if(in_ques_type==5)
												ques_type_name="Textarea";
											if(in_ques_type==6)
											ques_type_name="Upload Documents";												

											var dt_created = data.questions[i].dt_created;
											var dt_modified = data.questions[i].dt_modified;
											if(dt_created!=null  && dt_created!=undefined){
												var dt_up=dt_created.split(" ");
												dt_created = dt_up[0].split('-');
												dt_created = dt_created[2] + '/' + dt_created[1] + '/' + dt_created[0].slice(-4);
											}else{
												dt_created="";
											}

											if(dt_modified!=null && typeof dt_modified!='undefined' && dt_modified!=""){
												var dt_up=dt_modified.split(" ");
												dt_modified = dt_up[0].split('-');
												dt_modified = dt_modified[2] + '/' + dt_modified[1] + '/' + dt_modified[0].slice(-4);
											}else{
												dt_modified="";
											}
                                            if (in_status == 1) {
                                                status = 'Active';
                                            }else{
                                                status = 'InActive';
                                            }
											row += '<tr>';
											row += '<td><div class="input-group">'+
                                                            '<div class="icheck-inline">'+
                                                               '<label>'+
                                                                  ' <input type="checkbox" data-id='+in_ques_id+' class="checkbox" >'+
                                                                '</label>'+
                                                           '</div>'+
                                                       '</div></td>';
                                            row += '<td>'+question_type(st_type)+'</td>';
										    row += '<td>'+st_question+'</td>';
										    row += '<td>'+ques_type_name+'</td>';
                                            if (in_required == 1) {
                                                row += '<td> Required </td>';
                                            }else{
                                                row += '<td> Optional </td>';
                                            }
                                            row += '<td>'+dt_created+'</td>';
										    row += '<td>'+dt_modified+'</td>';
                                            row += '<td>'+status+'</td>';
											if(status == 1){
												label = 'label-green';	 
											}else{
												label = 'label-dark-gray';
											}
											row += '<td><a href="<?php echo $admin_base_url; ?>questions/edit/'+in_ques_id+'" class="label label-sm label-light-gray popovers" data-container="body" data-trigger="hover" data-placement="top" data-content="Edit" title="Edit"><i class="fa fa-pencil" aria-hidden="true"></i></a>&nbsp;<a onClick="return delete_record('+in_ques_id+')" href="javascript:;" class="label label-sm label-light-gray popovers remove_href" data-container="body" data-trigger="hover" data-placement="top" data-content="Edit" title="Delete"><i class="fa fa-trash" aria-hidden="true"></i></a></td>';
											row += '</tr>';
												
										}
										$('#category_data').append(row);
										  $('#dobt-pagination').empty();
							   $('#dobt-pagination').append(data.pagination);
							   $('#sample_3_info').html('');
							
							 $(":checkbox").uniform({checkboxClass: 'checker'});
								var str = 'Showing '+ data.from +' to '+ data.to + ' of '+ data.total_records + ' entries.';	
									
								$('#sample_3_info').html(str);	
							  }
							  else
							  {
								var row ='<tr><td colspan="8" class="text-center">No Records Found.</td>';
								row +='</tr>';
								  
								$('#category_data').append(row);
								$('#bootom_row').empty();
							  }
									
							 
								
								
								
								
						  },
					});
				
					
					
					
			}
			
		
			
			
			
			function getAjaxdata2()
			{
				return false;
			}
	
			 function clearFilter()
			{
				
			   setCookie("cat_filter", 'filter', 365);
			   window.location='<?php echo $admin_base_url; ?>questions';
			}
			
			function setCookie(cname, cvalue, exdays) {
				var d = new Date();
				d.setTime(d.getTime() + (exdays*24*60*60*1000));
				var expires = "expires="+ d.toUTCString();
				document.cookie = cname + "=" + cvalue + "; " + expires + ";path=/";
			}
			

	 
	 function delete_checked()
	 {
		 var delete_ids=[];
		 $('.checkbox').each(function(){
			if($(this).prop('checked') === true){
		        // alert($(this).data('id'));
				delete_ids.push($(this).data('id'));
				
			}else
			{
				
			}
		});
		if(delete_ids.length!=0){
		var myJSON = JSON.stringify(delete_ids);
		// alert(myJSON);
		
		if(confirm("Are you sure, do you want to delete the checked records?"))
		{
		$.ajax(
							{
								url: "<?php echo $admin_base_url; ?>questions/delete_checked/",
								dataType: "json",
								method: "post",
								data:
								{
									selected: myJSON
								},
								success: function (data)
								{
									if(data==1)
									{
										location.reload();
									}else
									{
										alert("failed");
									}
									
								}
							});
		}else
		{
			return false;
		}
		}else
		{
			alert("Please select the check Box...!!");
		}
	 }
	 function delete_record(id)
	 {
		 
		if(confirm("Are you sure, do you want to delete the record?"))
		{
		$.ajax(
							{
								url: "<?php echo $admin_base_url; ?>questions/delete_record/",
								dataType: "json",
								method: "post",
								data:
								{
									deleted_id: id
								},
								success: function (data)
								{
									if(data==1)
									{
										
											 location.reload();
									}else
									{
										
											alert("Somthing Went Wrong..!!!");
									}
									
								}
							});
		}else
		{
			return false;
		}
	 }
	 function show_delete()
	 {
		 	$("#delete_row").show();
	 }
	

        </script>


    </body>
</html>