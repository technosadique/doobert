<?php 
$base_url = $this->config->item('base_url');
$owner_id = $this->common_function->get_org_owner_id($this->session->userdata('userid'),$this->session->userdata('org_id'));


$check_per_flag = '';
$user_permission = $this->common_function->get_permission($this->session->userdata('userid'),$this->session->userdata('org_id'));
	
	
	
$tc_user = array();
if(!empty($user_permission)) {
	$tc_user = unserialize($user_permission);
}
if(empty($profile_setting))
{
	$first ='yes';
}
else
{
	$first ='no';
}

if(isset($profile_setting['st_contact'])!='')
{ 			  
	$contact = unserialize($profile_setting['st_contact']); 							   
} 
else {
	$contact = '';
}	


// Added By Nirav
if($transport_details['st_trans_type']=='P')
{
	$legs_filled=0;
	if(isset($leg_details) && !empty($leg_details)) 
	{
		foreach($leg_details as $key=>$value){
			/*if($value['route_type_id'] == '0' || $value['route_type_id'] == '1' || $value['route_type_id'] == '2' )
			{*/
				if($value['in_multi_user'] == '0')
				{
					if($value['participants_cnt'] != 0 || $value['non_doobert_participants_cnt'] != 0)
					{
						$legs_filled++;
					}
				} else if($value['in_multi_user'] == '1'){
					if($value['participants_cnt']  ==  $value['in_user_num'] || $value['non_doobert_participants_cnt'] == $value['in_user_num'] || ($value['participants_cnt'] + $value['non_doobert_participants_cnt']) ==  $value['in_user_num'])
					{
						$legs_filled++;
					}
				}
			/*}*/ 
		}
		$legs_covered =  $legs_filled/count($leg_details)*100;
	} else {	
		$legs_covered = 0;
	} 
}else{
	$legs_covered = ($transport_details['cover_dis_per']>100) ? "100" : $transport_details['cover_dis_per'];
	}	

$cover_dist = ($transport_details['cover_dis_per']>100) ? "100" : $transport_details['cover_dis_per'];	
?>
<?php	
$curr_strtotime =  strtotime("now");
$UrlTopass  = "https://".$_SERVER['HTTP_HOST'].$_SERVER['REQUEST_URI'];
//$UrlTopass  = base_url()."org_transportation/share_transport/".$transport_details['in_transportation_id']."/";
//$UrlTopass_t  = "https://apps.facebook.com/doobert-rescue/";
//$UrlTopass_t  = base_url()."org_transportation/share_transport";
//$UrlTopass =  "http://".$_SERVER['HTTP_HOST']."/org-transportation-scheduled/".$transport_details['in_transportation_id']."/";
// $UrlTopass =  base_url()."transport_fbshare";
// $UrlTopass =  base_url()."transport_fbshare/".$transport_details['in_transportation_id']."/";
  
if($transport_details['st_org_image']!='' && file_exists($this->config->item('upload')."org_doc/".$transport_details['st_org_image']))
{
  $fb_image  = $this->config->item('upload_url')."org_doc/".$transport_details['st_org_image'];
}
else
{
 	$fb_image  = base_url()."assets/img/fb-doobert-logo.jpg"; 
}

if($transport_details['perc']>0)
{
	$transport_comp_perc = ($transport_details['perc']>100)? "100%":$transport_details['perc']."%";
}
else
{
	$transport_comp_perc = "0%";
}
$main_image = isset($main_image) && $main_image != '' ? $main_image : '';	
?>
<!DOCTYPE html>
<!--[if IE 8]> <html lang="en" class="ie8 no-js"> <![endif]-->
<!--[if IE 9]> <html lang="en" class="ie9 no-js"> <![endif]-->
<!--[if !IE]><!-->
<html lang="en" class="no-js">
<!--<![endif]-->
<!-- BEGIN HEAD --><head>
<meta charset="utf-8"/>
<title><?php echo $transport_details['st_org_name']; ?>'s Transportation - Doobert</title>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>


<meta property="fb:app_id" content="752816098131950" />
<meta property="og:type" content="website" />
<?php /*
<meta property="og:title" content="DOOBERT -Transportation #DBT<?php echo htmlspecialchars($transport_details['in_transportation_id']);?>" />
<meta property="og:image" content="<?php echo $fb_image; ?>" />
*/ ?>

<meta property="og:title" content="" />
<meta property="og:image" content="<?php echo base_url()."upload/fb_transport_share/".$main_image; ?>" />

<meta property="og:site_name" content="DOOBERT - transportation" />
<meta property="og:url" content="<?php echo $UrlTopass; ?>" />
<meta property="og:description" content="DOOBERT -Transportation #DBT<?php echo htmlspecialchars($transport_details['in_transportation_id']);?>" />
<?php /*
<meta property="og:description" content="<?php echo date("l, M",strtotime($transport_details['dt_target']));?><?php echo date(" d",strtotime($transport_details['dt_target']))." ";?><?php echo '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'; ?>DBT<?php echo $transport_details['in_transportation_id'];?><?php echo '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'; ?><?php echo "\r\n"; ?><?php echo ($transport_details['st_from_street']? $this->common_function->custom_htmlentities($transport_details['st_from_street']).",":""); echo ($transport_details['st_from_city']?$this->common_function->custom_htmlentities($transport_details['st_from_city']).", ":""); echo ($transport_details['st_from_state']?$this->common_function->custom_htmlentities($transport_details['st_from_state']):""); echo ($transport_details['st_from_zip']?", ".$this->common_function->custom_htmlentities($transport_details['st_from_zip']):""); ?> to <?php echo ($transport_details['st_to_street']? $this->common_function->custom_htmlentities($transport_details['st_to_street']).", ":""); echo ($transport_details['st_to_city']?$this->common_function->custom_htmlentities($transport_details['st_to_city']).", ":""); echo ($transport_details['st_to_state']?$this->common_function->custom_htmlentities($transport_details['st_to_state']):"");echo ($transport_details['st_to_zip']?", ".$this->common_function->custom_htmlentities($transport_details['st_to_zip']):""); ?><?php echo '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'; ?><?php echo "\r\n"; ?><?php echo $transport_comp_perc; ?> of <?php echo ($transport_details['in_tot_distance']!=''? $transport_details['in_tot_distance']:"0");?> miles covered." />
*/ ?>
<meta property="og:updated_time" content="<?php echo time(); ?>" />

<?PHP //include APPPATH."views/includes/head-links.php"; ?>
<?PHP include APPPATH."views/includes/head-links-inside.php" ?>
<!-- BEGIN PAGE LEVEL STYLES -->
<link rel="stylesheet" type="text/css" href="<?php echo base_url(); ?>assets/plugins/clockface/css/clockface.css"/>
<link rel="stylesheet" type="text/css" href="<?php echo base_url(); ?>assets/plugins/bootstrap-timepicker/css/bootstrap-timepicker.min.css"/>
<link rel="stylesheet" type="text/css" href="<?php echo base_url(); ?>assets/plugins/bootstrap-datetimepicker/css/datetimepicker.css"/>
<link rel="stylesheet" type="text/css" href="<?php echo base_url(); ?>assets/plugins/bootstrap-fileinput/bootstrap-fileinput.css"/>
<link href="<?php echo base_url(); ?>assets/css/pages/timeline.css?version=14022017" rel="stylesheet" type="text/css"/>
<link href="<?php echo base_url(); ?>assets/css/animalvcard.css" rel="stylesheet" type="text/css"/>


<link rel="stylesheet" type="text/css" href="<?php echo $base_url;?>assets/plugins/bootstrap-datepicker/css/datepicker.css"/>
<link rel="stylesheet" type="text/css" href="<?php echo $base_url;?>assets/plugins/bootstrap-daterangepicker/daterangepicker-bs3.css"/>
<?PHP //include APPPATH."views/includes/fb_share_meta.php"; ?>
<!-- END PAGE LEVEL STYLES -->




<?php //if($this->session->userdata('userid')==$transport_details['in_trans_coods_id']){ ?>
<!-- Multiple file upload start -->
<!-- Generic page styles -->
<link rel="stylesheet" href="<?php echo base_url(); ?>assets/plugins/jquery-file-upload/css/style.css">
<!-- CSS to style the file input field as button and adjust the Bootstrap progress bars -->
<link rel="stylesheet" href="<?php echo base_url(); ?>assets/plugins/jquery-file-upload/css/jquery.fileupload.css">
<link rel="stylesheet" href="<?php echo base_url(); ?>assets/plugins/jquery-file-upload/css/jquery.fileupload-ui.css">
<!-- CSS adjustments for browsers with JavaScript disabled -->


<noscript>
<link rel="stylesheet" href="<?php echo base_url(); ?>assets/plugins/jquery-file-upload/css/jquery.fileupload-noscript.css">
</noscript>
<noscript>
<link rel="stylesheet" href="<?php echo base_url(); ?>assets/plugins/jquery-file-upload/css/jquery.fileupload-ui-noscript.css">
</noscript>
<!-- Multiple file upload end -->
<?php //} ?>
<link rel="stylesheet" type="text/css" href="<?php echo base_url();  ?>assets/plugins/jquery-ui/jquery-ui-1.10.3.custom.min.css"/>
<link rel="stylesheet" href="<?php echo base_url(); ?>assets/css/prettyPhoto/prettyPhoto.css" type="text/css" media="screen" title="prettyPhoto main stylesheet" charset="utf-8" />
<style type="text/css">
ul.ui-autocomplete {
	
	height: 120px !important;
	overflow: scroll !important;
	overflow-x: hidden !important;
	z-index: 99999999
}/*width: 535px !important;*/
ul#ui-id-1 {
	background: #fff;
	font: 600 14px/20px 'Open Sans', Helvetica, Arial, sans-serif;
	color: #c51f53;
	z-index: 999;
	max-height: 140px !important;
	overflow-x: hidden !important;
}
</style>

<link rel="stylesheet" type="text/css"  href="<?php echo base_url(); ?>assets/css/tipso.css">

<script type="text/javascript">
var page_id = "<?php echo isset($legs_page)?$legs_page:"1"; ?>";
var start_li = '';
var profile_type = "<?php echo isset($profile_type) ? $profile_type : "1"; ?>";
var profile_post = "<?php echo isset($profile_post) ? $profile_post : "1"; ?>";
</script>
</head>
<!-- BEGIN BODY -->
<body class="page-header-fixed transportations transportations-show">

<?php //if($_SERVER['REMOTE_ADDR']=='120.63.155.201' || $_SERVER['REMOTE_ADDR']=='123.238.36.22'){?>
<div id="fb-root"></div>
<script>
(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&appId=316015238585967&version=v2.2";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));
</script>

<?php /*?><div class="social-icons row no-margin no-left-margin">
    <div class="share-wrap" style="float:left;width:15% !important">
    <div class="fb-share-button" data-href="<?php echo ($UrlTopass); ?>" data-width="100px" data-height="100px" data-type="button_count"></div>
    </div>
</div><?php */?>
<?php //}?>
<!--Menu Active Link-->
<?php $tab = 3; $subtab = 3.1; ?>

<!-- BEGIN HEADER -->
<?php if(isset($permission['transport']) && in_array('transport_ed',$permission['transport'])){ ?>
<?PHP $display_menu =  2; 
	   } else { ?>
<?PHP $display_menu =  1; }?>
<?PHP include APPPATH."views/includes/head-content-inside.php" ?>
<?PHP //include APPPATH."views/includes/head-content-login.php"; ?>
<!-- END HEADER -->
<?php //echo "<pre>";print_r($transport_details);die;;?>
<div class="clearfix"> </div>
<!-- BEGIN CONTAINER -->
<div class="page-container">
  <div class="row no-margin">
    <div class="top-searchbar">      
    </div>
  </div>
  <div class="clearfix"></div>
  <div class="row page-title-bg no-margin">
    <div class="pull-left inner-bg"> 
      <!-- BEGIN PAGE TITLE & BREADCRUMB-->
      <div class="col-lg-6 col-md-6 myaccount no-space">
        <h3 class="page-title"><?php echo $transport_details['st_org_name']; ?>'s Transportation</h3>
      </div>
      <div class="app-breadcrumb col-lg-6 col-md-6 no-space">
        <ul class="breadcrumb">
          <li> <a href="<?php echo base_url(); ?>dashboard/">My Account</a> <i class="fa fa-angle-right"></i> </li>
          <li> <a href="<?php echo base_url(); ?>org-dashboard/<?php echo $this->session->userdata('org_id'); ?>/">Organization</a> <i class="fa fa-angle-right"></i> </li>
          <li> <a href="<?php echo base_url()."organization-transportation/";?>">Transportation</a> <i class="fa fa-angle-right"></i> </li>
          <li><?php echo $transport_details['st_org_name']; ?>'s Transportation</li>
        </ul>
      </div>
      <!-- END PAGE TITLE & BREADCRUMB--> 
    </div>
  </div>
  <div class="clearfix"> </div>
  <!-- BEGIN HORIZONTAL MENU PAGE SIDEBAR -->
  <div class="page-sidebar-wrapper">  
  </div>
  <!-- END BEGIN HORIZONTAL MENU PAGE SIDEBAR --> 
  <!-- BEGIN CONTENT -->
  <div class="page-content-wrapper">
    <div class="page-content marl0" id="create-legs">
      <?php /*?><div class="error"> <?php echo $this->session->flashdata('date_error'); ?> </div><?php */?>
      <?php if($this->session->flashdata('date_error'))
	  {
	 ?>
      <div class="alert alert-danger" style="color:#a94442;border-color:#ebccd1;background-color:#f2dede;text-align: center;margin:0">
        <button class="close" data-close="alert"  title="Close"></button>
        <span>
        <?php 
                echo $this->session->flashdata('date_error');
                ?>
        </span> </div>
      <?php } ?>
      <!-- BEING PAGE CONTENT-->
      <div class="row content-wrapper marlr0">
        <div class="row dobt-form no-margin">
          <div class="gr-wrap col-lg-3 col-md-4 col-sm-12 column1" id="leftcolumn">
          <div class="transport-top-left-heading">
            <div class="id">#DBT<?php echo $transport_details['in_transportation_id'];?></div>
            <div class="calendar"><i class="fa fa-calendar"></i><?php echo date("l, M d",strtotime($transport_details['dt_target']));?></div>
            <div class="clearfix"></div>
</div>
			<div id="leftheight1">
             <?php if ($transport_details['st_trans_type']=='D') { ?>
             <div class="driver-specify-leg"><a href="javascript:void(0)" onClick="$('#driver-specify-legs').modal('show');"  data-toggle="modal"><img src="<?php echo base_url(); ?>assets/img/icon-driver-specify-legs.jpg" alt="Driver Specify Legs" title="Driver Specify Legs" /> <img src="<?php echo base_url(); ?>assets/img/orange-left-arrow.png" alt="D" title="" class="orange-left-arrow" /><span>Driver Specify Legs <u>Learn More</u></span></a></div>
            <?php } ?>
            
            
            <div class="fromtolocation">
              <div class="row no-margin">
                  <div class="gr-wrap col-lg-12 col-md-12 col-sm-12">
                    <p class="trans-from-info"><span>From:</span> <?php echo ($transport_details['st_from_city']?$transport_details['st_from_city'].", ":"").($transport_details['st_from_state']?$transport_details['st_from_state'].", ":""); ?> on <span class="date"><?php echo date("M d",strtotime($transport_details['dt_pickup_date']));?></span></p>
                    <p class="trans-to-info"><span>To:</span> <?php echo ($transport_details['st_to_city']?$transport_details['st_to_city'].", ":"").($transport_details['st_to_state']?$transport_details['st_to_state'].", ":""); ?> on <span class="date"><?php echo date("M d",strtotime($transport_details['dt_target']));?></span></p>
                  </div>
                </div>
            </div>
              <?php $title = 'DOOBERT -Transportation #DBT'.htmlspecialchars($transport_details['in_transportation_id']);
					if($transport_details['perc']>0)
						{
							$transport_comp_perc = (($transport_details['perc']>100)? "100%":$transport_details['perc']."%");
						}
						else
						{
							$transport_comp_perc = "0%";
						}
						
						$description = "";
						
						$description .= date("l, M",strtotime($transport_details['dt_target']));
						$description .= date(" d",strtotime($transport_details['dt_target']));
						$description .= "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DBT".$transport_details['in_transportation_id']."&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;";
						$description .= "\r\n";
						$description .= $transport_details['st_from_street']? $this->common_function->custom_htmlentities($transport_details['st_from_street']).",":"";
						$description .= $transport_details['st_from_city']? $this->common_function->custom_htmlentities($transport_details['st_from_city']).",":"";
						$description .= $transport_details['st_from_state']? $this->common_function->custom_htmlentities($transport_details['st_from_state']).",":"";
						$description .= $transport_details['st_from_zip']? $this->common_function->custom_htmlentities($transport_details['st_from_zip']).",":"";
						$description .= ' to ';
						$description .= $transport_details['st_to_street']? $this->common_function->custom_htmlentities($transport_details['st_to_street']).",":"";
						$description .= $transport_details['st_to_city']? $this->common_function->custom_htmlentities($transport_details['st_to_city']).",":"";
						$description .= $transport_details['st_to_state']? $this->common_function->custom_htmlentities($transport_details['st_to_state']).",":"";
						$description .= $transport_details['st_to_zip']? $this->common_function->custom_htmlentities($transport_details['st_to_zip']).",":"";
						$description .= "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;";
						$description .= "\r\n";
						$description .= $transport_comp_perc ." of ".($transport_details['in_tot_distance']!=''? $transport_details['in_tot_distance']:"0").'miles covered.';
						
						$description_str = str_replace('&nbsp;',' ',$description);
						$description_str = str_replace(array("\r\n","\r","\n"), "<br>",$description_str);
						
						$UrlTopass_t  =  base_url()."org-transportation-scheduled/".$transport_details['in_transportation_id'];
						
						if($transport_details['st_org_image']!='' && file_exists($this->config->item('upload')."org_doc/".$transport_details['st_org_image']))
						{
						  $fb_image  = $this->config->item('upload_url')."org_doc/".$transport_details['st_org_image'];
						}
						else
						{
							$fb_image  = base_url()."assets/img/fb-doobert-logo.jpg"; 
						}
				
				?>
				
				<div class="milescovered"><i class="fa fa-thumbs-up"></i>  <span><?php //echo $cover_dist = ($transport_details['cover_dis_per']>100) ? "100" : $transport_details['cover_dis_per'];?> <?php echo round($legs_covered, 2);?>%</span> of <?php echo number_format($transport_details['in_tot_distance'],"2",".","");?> miles covered</div>
            <div class="clearfix"></div>
			
              <div class="confirm-trans">
			  
			  <?php 
					if($transport_details['in_status']=='1')
					{
						 if(isset($permission['transport']) && in_array('transport_cnf',$permission['transport'])){ 
						 ?>
						  <form class="horizontal-form" role="form" onSubmit="return confirm_transportation();"  id="confirm_transport" name="confirm_transport" enctype="multipart/form-data" action="" method="post" data-ajax="false">
							<input type="hidden" name="conf_transport" id="conf_transport" value="confirm" />
						
							<a data-original-title="By confirming the transport the date, legs and animals will be locked in and cannot be edited further" data-placement="top" onClick="$('#confirm_transport').submit();" class="btn light-green" title="Confirm Transportation" name="c_trans" id="c_trans"><i class="fa fa-check"></i> Confirm Transportation</a>
						  </form>
						  <?php 
						 }
					 }
					  ?> 
					  
			  <!-- <a href="http://www.facebook.com" class="btn facebook-btn" target="_blank" title="Share"><i class="fa fa-facebook"></i> Share</a> -->
			  <div class="transport-share"> <span class="share-on">Share on: </span><br>
                <span class="fb-icon">
                <div class="share-wrap">
                  <div class="fb-share-button" data-href="<?php echo $UrlTopass;?>" data-width="100px" data-height="100px" data-layout="button" data-action="recommend" data-show-faces="true" data-share="true"></div>
                </div>
                </span> </span> <span class="twitter-icon"> <a href="https://twitter.com/share" class="twitter-share-button" data-count="none" data-url="<?php echo base_url().'org-transportation-scheduled/'.$transport_details['in_transportation_id']; ?>" data-title="<?php echo $title; ?>" data-text="<?php echo $description; ?>"></a> 
                <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script> 
                </span> <span> 
                <script type="text/javascript">
							  window.___gcfg = {
							  lang: 'en-US',
							  parsetags: 'onload'
							  };
							</script> 
                <script src="https://apis.google.com/js/client:platform.js" async defer></script> 
                <a class="g-interactivepost" data-contenturl="<?php echo base_url().'org-transportation-scheduled/'.$transport_details['in_transportation_id']; ?>" data-clientid="424502894030-f5b5hcso2c4pr57dkh0fsu1eicg6dmj7.apps.googleusercontent.com"
									  data-cookiepolicy="single_host_origin"                     
									  data-calltoactionurl="<?php echo base_url().'org-transportation-scheduled/'.$transport_details['in_transportation_id']; ?>"
                                      data-prefilltext="<?php echo $description; ?>"> <img src="<?php echo base_url(); ?>assets/img/G-Plus.jpg" alt="G-Plus" title="G-Plus" /></a> 
                </script> 
                </span> <span> <a href="javascript:void(0)" onClick="$('#share_transport_id').val('<?php echo $transport_details['in_transportation_id']; ?>');$('#txtsubject').val('<?php echo $title; ?>');display_share_email_popup();" data-toggle="modal" class="marl5"><img src="<?php echo base_url(); ?>assets/img/mail.jpg" alt="Email" title="Email" /></a></span><div class="clear"></div> </div>
              
			  </div>
			  
              
            <div class="clearfix"></div>
             <div class="join-transporation-info">
             <div class="select-style fl select-action">
				<form class="horizontal-form fl" role="form" id="cancel_transport" name="cancel_transport" enctype="multipart/form-data" action="" method="post">
                <input type="hidden" name="cancel_trans" id="cancel_trans" value="cancel" />
				<input type="hidden" name="cancel_trans_text" id="cancel_trans_text" value="" />
				</form>
			 <?php if(isset($permission['transport']) && in_array('transport_ed',$permission['transport'])){ ?>
  				<select id="select-action">
    				<option value="0">Select Action</option>
					
                    <option value="1">Add Animal</option>
                    <?php 
					if($transport_details['in_status']=='1')
					{
					if(isset($permission['transport']) && in_array('transport_del',$permission['transport'])){
					?>
                    <option value="4">Cancel Transport</option>
					<?php } } ?>
					<option value="2">Edit Date</option>
					<?php
					if((isset($permission['transport']) && in_array('transport_ed',$permission['transport']) )|| isset($permission['transport']) && in_array('transport_cr',$permission['transport']))
					  {
						?>
					<option value="5">Edit Legs</option>
					<?php } ?>
                    <option value="3">Edit Transport</option>									
  				</select>
                <?php } ?>	
</div>
				<a href="javascript:void(0);" class="btn dark-blue" title="Join Transportation" style="display:none;">Join Transportation</a>
                <div class="clearfix"></div>
                <?php if(isset($permission['transport']) && in_array('transport_ed',$permission['transport'])){ ?>
                <p>(Actions: Add Animal, Edit Date, Edit Transport, Cancel Transport and Edit Legs) </p>
                <?php } ?>
				<?php if(isset($permission['transport']) && in_array('transport_ed',$permission['transport'])){ ?>
                <p>Note: Add animal button would allow you to select animal for this transportation. <?php if(isset($permission['profile_manager']) && in_array('pr_manager_cr',$permission['profile_manager'])){ ?>
                For adding a new animal into your organization please <a href="<?php echo base_url(); ?>org-animal/" class="click-here-link">click here</a>.
                <?php } ?></p>
				<?php } ?>
             </div>
			 
            <div class="transport-coordinator-info">
            <h3>Transport Coordinator</h3>
            <div class="transport-detail coord">
              <?php 
			  //echo "<pre>";print_r($transport_details);die;
                      if($transport_details['st_profile_image']!='' && file_exists($this->config->item('upload')."profile/63x63/".$transport_details['st_profile_image']))
                      {
                          $image_url  = $this->config->item('upload_url')."profile/63x63/".$transport_details['st_profile_image'];
                      }
                      else
                      {
                          $image_url  = $this->config->item('upload_url')."profile/63x63/no_photo_icon.png";
                      }
					    $check_user_arpa = $this->common_model->check_arpa_certifcate_status($transport_details['in_user_id']);
						if(!empty($check_user_arpa) && $check_user_arpa['st_arpa_cert'] =='Y') { 
							 $title = date('F j, Y',strtotime($check_user_arpa['dt_arpa_cert']));
							$image_cert_url = '<img src="'.base_url().'assets/img/arpa-certified.png" title="'.$title.'" />'; 
						} else {
							$title = '';
							$image_cert_url = '<img src="'.base_url().'assets/img/arpa-certified-grey.png" title="'.$title.'" />'; 
						} 		
				?>
              <div class="logo"> <img src="<?php echo $image_url; ?>" alt="<?php echo $this->session->userdata('org_name'); ?>" title="<?php echo $this->session->userdata('org_name'); ?>"> </div>
             
              <div class="cocordinator-info create-cocordinator-info" title="<?php echo $title; ?>" style="position:relative; background:none;">
                  
                  <?php
				$link_name 	= $this->common_function->get_filtered_name($transport_details['st_display_name']);
				$url_link 	= base_url()."user-".$transport_details['in_user_id']."-".$link_name."/";
				?>
				<?php
					$check_user = $this->common_model->get_user_verified($transport_details['in_user_id']);
 					if(!empty($check_user)) { 
					   $class = 'bg-green-logo get-verified-logo'; 
					   $style='background-position:90% 0%; padding-right:75px;';
					   $title = date('F j, Y',strtotime($check_user['dt_doobert_verified']));
					   $verify_tag = '<img src="'.base_url().'assets/img/green_logo.png" title="'.$title.'" />';
				   }else { $class = 'bg-gray-logo'; $title = ''; $style='';
						$verify_tag = '<img src="'.base_url().'assets/img/gray_logo.png" title="'.$title.'" />';	
				   
				   } ?>
				   
				    <div class="<?php //echo $class; ?>" style="padding-right:75px;">
                	<span class="name"> <a href="<?php echo $url_link;?>" target="_blank"><?php echo $transport_details['st_display_name'];?></a> 
					
					</span>
					<div class="right-verified-logo">	
					<?php echo $verify_tag; ?>
					<?php echo $image_cert_url; ?>
				  </div>
                  <?php if($transport_details['in_public']=='1'){?>
                  <?php if(($first=='no' && is_array($contact) && in_array('st_address1',$contact)) || $first=='yes'){ ?>
                  <p class="map marb0"><i class="fa fa-map-marker"></i>
                    <?php 
				$trans_add = '';
				if(isset($transport_details['st_city']) && $transport_details['st_city'] != ''){
				$trans_add .= $transport_details['st_city'].", ";
				}
				if(isset($transport_details['st_state']) && $transport_details['st_state'] != ''){
				$trans_add .= $transport_details['st_state'].", ";
				}
				if(isset($transport_details['st_zip']) && $transport_details['st_zip'] != ''){
				$trans_add .= $transport_details['st_zip'];
				}				
				echo $trans_add;?>
                  </p>
                  <?php }  ?>
                  <?php } ?>
				  </div>
                </div>
             </div>
			 </div>
              
              <!--New Block starts here-->
              <?php if(isset($transport_details['in_need_trans_monitor']) && $transport_details['in_need_trans_monitor'] == 1) { ?>
              <div class="transport-monitor-info">
              <h3>Transport Monitor <span class="title-tipso" title="The Transport Monitor is a virtual role for monitoring and reporting on this transport on the day the transport takes place.  The Transport Monitor communicates with the volunteer drivers/pilots and the Transport Organization Coordinator regarding the status of the transport overall including adjusting departure and arrival times based upon status received from the volunteers.  The Transport Monitor needs to have access to the internet and a phone so that they can update the participants in the transport.  If you would like to sign-up for this role but have never served in this capacity before, please contact the Transport Coordinator first to discuss what is required. A Transportation can have up to 2 monitors."><i class="fa fa-info-circle info"></i></span></h3>
              <div class="transport-detail monitor">
              
               <?php 
			   
			    $trans_monitor_user_ids = array(); 
				 if(isset($transport_monitors_details))
				 {
					foreach($transport_monitors_details as $key=>$value)
					{
						 $trans_monitor_user_ids[] = $value['in_user_id'];
					}
				 }
			   if($transport_monitors_count < 2 && !in_array($this->session->userdata('userid'),$trans_monitor_user_ids)) { ?>
                  <div class="bordertopwhite"><a href="javascript:void(0);" class="btn btn-lg signup-monitor" onClick="$('#action').val('join_as_monitor');" name="transport_monitor" id="transport_monitor"><i class="fa fa-binoculars"></i> Sign-Up as Transport Monitor</a></div>
                  <img id="loadimg_trans_monitor" style="display:none" src="<?php echo base_url(); ?>assets/img/ajax-loading.gif" alt="loader" />
                  <?php } ?>
                  
                <?php 
			 if(isset($transport_monitors_details))
			 {
				 
				foreach($transport_monitors_details as $trans_key=>$trans_monitor_values)
				{
			  
                      if($trans_monitor_values['st_profile_image']!='' && file_exists($this->config->item('upload')."profile/63x63/".$trans_monitor_values['st_profile_image']))
                      {
                          $image_url  = $this->config->item('upload_url')."profile/63x63/".$trans_monitor_values['st_profile_image'];
                      }
                      else
                      {
                          $image_url  = $this->config->item('upload_url')."profile/63x63/no_photo_icon.png";
                      }
					  
					  
					  $check_user_arpa = $this->common_model->check_arpa_certifcate_status($trans_monitor_values['in_user_id']);
					   if(!empty($check_user_arpa) && $check_user_arpa['st_arpa_cert'] =='Y') { 
							 $title = date('F j, Y',strtotime($check_user_arpa['dt_arpa_cert']));
							$image_cert_url = '<img src="'.base_url().'assets/img/arpa-certified.png" title="'.$title.'"/>'; 
						} else {
							$title = '';
							$image_cert_url = '<img src="'.base_url().'assets/img/arpa-certified-grey.png" title="'.$title.'" />'; 
						}
				?>
                <div <?php if($trans_key != count($transport_monitors_details)-1) { ?> class="monitor_space" <?php }else{ ?> class="mart35" <?php } ?> >
                  <div class="logo"> <img src="<?php echo $image_url; ?>" alt="<?php echo $this->session->userdata('org_name'); ?>" title="<?php echo $this->session->userdata('org_name'); ?>"> </div>
                  <div class="monitor-info" style="position:relative;">
                  <?php 
					  		if($transport_details['in_status']=='1'){
								if((isset($permission['transport']) && in_array('transport_ed',$permission['transport'])) || (isset($permission['transport']) && in_array('transport_cr',$permission['transport'])) || ($trans_monitor_values['in_user_id'] == $this->session->userdata('userid'))){
						?>
                  <div class="leg-cancel-btn-wrap remove-user" style="float:right;">
                    <button style="margin-left:0px;color:#F3F0F0 !important;" aria-hidden="true" onClick="$('#remove_user_id').val('<?php echo $trans_monitor_values['in_user_id'] ;?>');$('#remove_monitor_id').val('<?php echo $trans_monitor_values['in_tr_pr_id'] ;?>');" legtype='remove_as_monitor' class="remove_monitors" type="submit"  title="Remove"><i class="fa fa-times"></i>Remove</button>
                    <img class="loder_cancel fr" id="loadimg_remove_monitors" style="display:none;" src="<?php echo base_url(); ?>assets/img/ajax-loading.gif" alt="loader" /> </div>
                  <div class="modal fade remove_monitor_popup cancel_popup_width" id="remove_monitor_popup_<?php echo $trans_monitor_values['in_tr_pr_id'] ;?>" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
                    <div class="modal-dialog" style="height:auto;color:#000000;width:35%;">
                      <div class="modal-content">
                        <div class="modal-body">
                          <button aria-hidden="true" data-dismiss="modal" class="close" type="button"  title="Close"></button>
                          Are you sure you want to remove ?
                          <div class="clearfix"></div>
                          <br/>
                          <a class="btn pink" data-dismiss="modal" href="javascript:void(0);" onClick="remove_transport_monitor();" title="Remove">Remove</a> <a class="btn pink" data-dismiss="modal" href="javascript:void(0);" onClick="$('.remove_monitor_popup').hide();" title="Cancel">Cancel</a> </div>
                      </div>
                      <!-- /.modal-content --> 
                    </div>
                    <!-- /.modal-dialog --> 
                  </div>
                  <?php } } ?>
                  
                  <?php $check_user = $this->common_model->get_user_verified($trans_monitor_values['in_user_id']);
                   if(!empty($check_user)) {
					   $class = 'bg-green-logo'; 
					   $title = date('F j, Y',strtotime($check_user['dt_doobert_verified']));
					   $verify_tag = '<img src="'.base_url().'assets/img/green_logo.png" title="'.$title.'" />';
				   }else { $class = 'bg-gray-logo'; $title = '';
							$verify_tag = '<img src="'.base_url().'assets/img/gray_logo.png" title="'.$title.'" />';
				   }
                ?>
                  <div class="<?php echo $class; ?>" title="<?php echo $title; ?>">
                      <?php
				$link_name 	= $this->common_function->get_filtered_name($trans_monitor_values['st_display_name']);
				$url_link 	= base_url()."user-".$trans_monitor_values['in_user_id']."-".$link_name."/";
				?>
                      <span class="name"> <a href="<?php echo $url_link;?>" target="_blank"><?php echo $trans_monitor_values['st_display_name'];?></a> </span>
                      
						<div class="right-verified-logo">	
							<?php echo $verify_tag; ?>
							<?php echo $image_cert_url; ?>
						</div>
					  
					  <?php /* <img src='<?php echo $image_cert_url;  ?>' /> */ ?>
					  <?php if($trans_monitor_values['in_public']=='1'){?>
                      <?php if(($first=='no' && is_array($contact) && in_array('st_address1',$contact)) || $first=='yes'){ ?>
                      <p class="map">
                        <?php 
				$trans_add = '';
				if(isset($trans_monitor_values['st_city']) && $trans_monitor_values['st_city'] != ''){
				$trans_add .= $trans_monitor_values['st_city'].", ";
				}
				if(isset($trans_monitor_values['st_state']) && $trans_monitor_values['st_state'] != ''){
				$trans_add .= $trans_monitor_values['st_state'].", ";
				}
				if(isset($trans_monitor_values['st_zip']) && $trans_monitor_values['st_zip'] != ''){
				$trans_add .= $trans_monitor_values['st_zip'];
				}				
				echo $trans_add;?>
                      </p>
                      <?php }  ?>
                      <?php } ?>
                    </div>
                  </div>
                   </div>
                  <?php } } ?>
               </div>               
			   </div>
               <?php } ?>
               <!--New Block ends here-->
			   
			   <div class="recommend-changes-info">
			
				<a href="javascript:void(0);" class="btn pink" id="recommend-legs" title="Recommend Changes to Legs">Recommend Changes to  Animal Rescue Legs</a>
                <p class="suggestion-text">Are you an animal rescue pilot that can fly them further?  Do you have ideas for a better routing or different legs that the transport coordinator should consider?  Click to let them know your suggestions</p>
                <div id="recommend-own-box" style="display:none;">
                	<h3><i class="fa fa-road"></i> Recommend Own Leg</h3>
                    <div class="leg-type">
                    <div class="radio-list">
                    <ul>
                    <li class="leg-type-label">Leg Type? <span class="required-filed">*</span></li>
                    	<li><label class="radio-inline" for="legground">
                        <input type="radio" name="legtype" id="legground" value="1" checked >Ground Leg</label>
                        </li>
                        <li><label class="radio-inline" for="legaviation">
                        <input type="radio" name="legtype" id="legaviation" value="2">Aviation Leg</label></li>
                    </ul></div>
                    </div>
					
					<form class="horizontal-form" role="form" name="recommend_leg" id="recommend_leg" action="<?php echo base_url() ?>org_transportation/recommend_leg" method="post">
					
					<?php /*
						<div id="zip-search" class="modal fade" tabindex="-1" aria-hidden="true">						
						  <div class="modal-dialog">
							<div class="modal-content">
							  <div class="modal-body">
							  <input type="hidden" class="form-control" id="pick_zip" name="pick_zip" maxlength="50" value="">
						  <input type="hidden" class="form-control" id="pick_country" name="pick_country" maxlength="50" value="">
								<button type="button" class="close" data-dismiss="modal" aria-hidden="true" title="Close"></button>
								<div class="scroller" style="height:200px" data-always-visible="1" data-rail-visible1="1">
								  <p>Don't know the zip code? Search for it here</p>
								  <div class="form-group">
									<input type="text" placeholder="Enter City Name" id="pick_city" name="pick_city" maxlength="50" value="" class="form-control">
								  </div>
								  <div class="form-group">
									<select id="pickup_state" name="pickup_state" class="form-control">
									  <option value="">Select State</option>
									  <optgroup label="USA States">
									  <?php
																					foreach($state_list as $key1=>$value1)
																					{
																					?>
									  <option value="<?php echo $key1;?>"><?php echo $value1;?></option>
									  <?php   
																				   }
																				?>
									  </optgroup>
									  <optgroup label="CANADA States">
									  <?php
																					foreach($c_state_list as $key1=>$value1)
																					{
																					?>
									  <option value="<?php echo $key1;?>"><?php echo $value1;?></option>
									  <?php   
																				   }
																				?>
									  </optgroup>
									</select>
								  </div>
								  <div class="form-group">
									<button type="button" class="btn search-btn" title="Search" onClick="get_zipcode('pick_city','pickup_state','popup_zipcode','pick_country');">Search</button>
									<div id="popup_zip_div">
									  <input type="text" placeholder="Zip code will appear here" class="form-control display-zipcode" id="popup_zipcode" name="popup_zipcode" readonly>
									</div>
									
								  </div>
								</div>
							  </div>
							  <div class="modal-footer">
								<button type="button" class="btn light-green" id="origin_zipcode" name="origin_zipcode" onClick="change_origin_details();">Select as Origin Zip Code</button>
								<button type="button" class="btn light-green" id="destination_zipcode" name="destination_zipcode" onClick="change_destination_details();" style="display:none;">Select as Destination Zip Code</button>
							  </div>
							</div>
						  </div>
						</div>
						
						
						<div id="drop-zip-search" class="modal fade" tabindex="-1" aria-hidden="true">
						
						  <div class="modal-dialog">
							<div class="modal-content">
							  <div class="modal-body">
							  <input type="hidden" class="form-control" id="drop_zip" name="drop_zip" maxlength="50" value="">
						  <input type="hidden" class="form-control" id="drop_country" name="drop_country" maxlength="50" value="">
								<button type="button" class="close" data-dismiss="modal" aria-hidden="true" title="Close"></button>
								<div class="scroller" style="height:200px" data-always-visible="1" data-rail-visible1="1">
								  <p>Don't know the zip code? Search for it here</p>
								  <div class="form-group">
									<input type="text" placeholder="Enter City Name" id="drop_city" name="drop_city" maxlength="50" value="" class="form-control">
								  </div>
								  <div class="form-group">
									<select id="drop_state" name="drop_state" class="form-control">
									  <option value="">Select State</option>
									  <optgroup label="USA States">
									  <?php
																					foreach($state_list as $key1=>$value1)
																					{
																					?>
									  <option value="<?php echo $key1;?>"><?php echo $value1;?></option>
									  <?php   
																				   }
																				?>
									  </optgroup>
									  <optgroup label="CANADA States">
									  <?php
																					foreach($c_state_list as $key1=>$value1)
																					{
																					?>
									  <option value="<?php echo $key1;?>"><?php echo $value1;?></option>
									  <?php   
																				   }
																				?>
									  </optgroup>
									</select>
								  </div>
								  <div class="form-group">
									<button type="button" class="btn search-btn" title="Search" onClick="get_zipcode_drop('drop_city','drop_state','popup_zipcode_drop','drop_country');">Search</button>
									<div id="popup_zip_div_drop">
									  <input type="text" placeholder="Zip code will appear here" class="form-control display-zipcode" id="popup_zipcode_drop" name="popup_zipcode_drop" readonly>
									</div>								
									
								  </div>
								</div>
							  </div>
							  <div class="modal-footer">	
								<button type="button" class="btn light-green" id="destination_zipcode" name="destination_zipcode" onClick="change_destination_details();">Select as Destination Zip Code</button>
							  </div>
							</div>
						  </div>
						</div>
						<?php */ ?>
						
					<input type="hidden" id="recommend_transport_id" name="recommend_transport_id" value="<?php echo isset($transport_details['in_transportation_id']) && $transport_details['in_transportation_id'] != '' ? $transport_details['in_transportation_id'] : '' ; ?>">
					<input type="hidden" id="recommend_user_id" name="recommend_user_id" value="<?php echo ($this->session->userdata('userid')) ? $this->session->userdata('userid') : '' ; ?>">
                    <div id="ground-leg">
                    
                    <div class="form-group">
                              <label class="control-label" for="pick-up-location">Pick Up Location: <span class="required-filed">*</span></label>
                              <input type="text" class="form-control" id="pick_up_location" name="pick_up_location" value="" maxlength="250" placeholder="Enter From City, State or Zip">
                              <!--<span>Don't know the zip code? <a href="#zip-search" data-toggle="modal" id="p_zip_search" onClick="$('#pick_city').val('');$('#pick_state').val('');$('#popup_zipcode').val('');$('#zipcode_list').val('');$('#zipcode_list').hide();$('#origin_zipcode').show();$('#destination_zipcode').hide();$('#popup_zip_div').show();">Click here to search</a></span>-->
                            </div>
                            
                    <div class="form-group">
                    <input type="text" class="form-control" id="pick_street" name="pick_street" value="" maxlength="250" placeholder="Enter Street Address">
                    </div>
                    
                    <div class="form-group">
                              <label class="control-label" for="drop-off-location">Drop Off Location: <span class="required-filed">*</span></label>
                              <input type="text" class="form-control" id="drop_off_location" name="drop_off_location" value="" maxlength="250" placeholder="Enter To City, State or Zip">
                             <!--<span>Don't know the zip code? <a href="#drop-zip-search" data-toggle="modal" id="d_zip_search" onClick="$('#pick_city').val('');$('#pick_state').val('');$('#popup_zipcode').val('');$('#zipcode_list').val('');$('#zipcode_list').hide();$('#origin_zipcode').hide();$('#destination_zipcode').show();$('#popup_zip_div').show();">Click here to search</a></span>-->
                   </div>
                            
                    <div class="form-group">
                    <input type="text" class="form-control" id="drop_street" name="drop_street" value="" maxlength="250" placeholder="Enter Street Address">
                    </div> 
					<?php if(!$this->session->userdata('userid')) { ?>
					<div class="form-group">
                    <label class="control-label" for="contact-name">Contact Details: <span class="required-filed">*</span></label>
                    <input type="text" class="form-control marb10" id="contact_name" name="contact_name" value="" maxlength="250" placeholder="Your Name">
                    <input type="text" class="form-control" id="contact_email" name="contact_email" value="" maxlength="250" placeholder="Your Email Address">
                    </div> 
					<?php } ?>
                    <div class="form-group padb5">
                    <label for="note-comments">Notes/Comments:</label>
                    <textarea rows="5" name="note-comments" id="note-comments" class="form-control" placeholder=""></textarea>
                    </div> 
                    <!--<a href="#thanku-suggest-leg" data-toggle="modal" class="btn pink sugest-leg-btn" title="Suggest Leg">Suggest Leg</a>-->
					<button class="btn pink sugest-leg-btn" title="Suggest Leg" type="submit" id="suggest_leg">Suggest Leg</button>
                    <a href="javascript:void(0);" class="btn gray" title="Cancel" id="cancel_recommend">Cancel</a>  
                    </div>
					<input type="hidden" value="suggest_leg" name="action_recommend" id="action_recommend" />
					</form>
					
					<form class="horizontal-form" role="form" name="recommend_leg_avia" id="recommend_leg_avia" action="<?php echo base_url() ?>org_transportation/recommend_leg_avia" method="post">
					<input type="hidden" id="recommend_transport_id_avia" name="recommend_transport_id_avia" value="<?php echo isset($transport_details['in_transportation_id']) && $transport_details['in_transportation_id'] != '' ? $transport_details['in_transportation_id'] : '' ; ?>">
					<input type="hidden" id="recommend_user_id_avia" name="recommend_user_id_avia" value="<?php echo ($this->session->userdata('userid')) ? $this->session->userdata('userid') : '' ; ?>">
					
					<div id="aviation-leg" style="display:none;">
                    <div class="form-group">
                              <label class="control-label" for="pickup_airport">From Location/Airport ID: <span class="required-filed">*</span></label>
                              <input type="text" class="form-control" id="pickup_airport" name="pickup_airport" value="" maxlength="250" placeholder="Enter From City, State or Zip/Airport ID">
							   <input type="hidden" id="pickup_airport_city" name="pickup_airport_city" maxlength="50">
                              <input type="hidden" id="pickup_airport_state" name="pickup_airport_state" maxlength="50">
                              <!--<span>Don't know the zip code? <a href="javascript:void(0);">Click here to search</a></span>-->
                            </div>
                    <div class="form-group">
                              <label class="control-label" for="dropoff_airport">To Location/Airport ID: <span class="required-filed">*</span></label>
                              <input type="text" class="form-control" id="dropoff_airport" name="dropoff_airport" value="" maxlength="250" placeholder="Enter To City, State or Zip/Airport ID">
							  <input type="hidden" id="dropoff_airport_city" name="dropoff_airport_city" maxlength="50">
                              <input type="hidden" id="dropoff_airport_state" name="dropoff_airport_state" maxlength="50">
                              <!--<span>Don't know the zip code? <a href="javascript:void(0);">Click here to search</a></span>-->
                            </div>
					<?php if(!$this->session->userdata('userid')) { ?>		
                    <div class="form-group">
                    <label class="control-label" for="contact-name">Contact Details: <span class="required-filed">*</span></label>
                    <input type="text" class="form-control marb10" id="contact_name_avia" name="contact_name_avia" value="" maxlength="250" placeholder="Your Name">
                    <input type="text" class="form-control" id="contact_email_avia" name="contact_email_avia" value="" maxlength="250" placeholder="Your Email Address">
                    </div> 
					<?php } ?>
                    <div class="form-group padb5">
                    <label for="note-comments1">Notes/Comments:</label>
                    <textarea rows="5" name="note_comments_avia" id="note_comments_avia" class="form-control" placeholder=""></textarea>
                    </div> 
                    <!--<a href="#thanku-suggest-leg" data-toggle="modal" class="btn pink sugest-leg-btn suggest_leg" title="Suggest Leg">Suggest Leg</a>-->
					<button class="btn pink sugest-leg-btn" title="Suggest Leg" type="submit" id="suggest_leg_aviation">Suggest Leg</button>
                    <a href="javascript:void(0);" class="btn gray" title="Cancel" id="cancel_recommend_avia">Cancel</a>  
                    </div> 
					<input type="hidden" value="suggest_leg_aviation" name="action_recommend_avia" id="action_recommend_avia" />
					</form>					
                </div>
             </div>
			  <div class="animal-block1">
                <h2>Animal(s) Rescued in this Transportation</h2>
				<ul>
				<?php if(isset($transport_animals) && !empty($transport_animals)){ ?>	
				<?php for($a=0;$a<count($transport_animals);$a++)
					 {
						if(isset($transport_animals[$a]) && !empty($transport_animals[$a])){
							$link_name 	= $this->common_function->get_filtered_name($transport_animals[$a]['st_animal_name']);
							$url_link 	= base_url()."animal-".$transport_animals[$a]['in_animal_id']."-".$link_name."/";		
				?>
				    <?php $st_file_name = $this->common_model->get_animal_photo($transport_animals[$a]['in_animal_id']);
	  
                      if($st_file_name!='' && file_exists($this->config->item('upload')."animal_images/140x140/".$st_file_name))
                      {
                          $image_url  = $this->config->item('upload_url')."animal_images/140x140/".$st_file_name;
                      }
                      else
                      {
                          $image_url  = $this->config->item('upload_url')."animal_images/140x140/no_photo_icon.png";
                      }
					?>
					  <?php 
						if(file_exists($this->config->item('upload')."demeanor/31x31/".$transport_animals[$a]['st_demeanor_image']) && file_exists($this->config->item('upload')."demeanor/60x60/".$transport_animals[$a]['st_demeanor_image']))
						{
								$demenor_url = $this->config->item('upload_url')."demeanor/31x31/".$transport_animals[$a]['st_demeanor_image'];
								$demenor_thumb_url = $this->config->item('upload_url')."demeanor/60x60/".$transport_animals[$a]['st_demeanor_image'];
						}
						else
						{
								$demenor_url = $this->config->item('upload_url')."demeanor/31x31/no_photo_icon.png";
								$demenor_thumb_url = $this->config->item('upload_url')."demeanor/60x60/no_photo_icon.png";
						}
					?>
                	<li>
                    	<span class="left-img"><img src="<?php echo $image_url; ?>" alt="<?php echo $transport_animals[$a]['st_animal_name'];?>" title="<?php echo $transport_animals[$a]['st_animal_name'];?>" /></span>
                        <span class="cont"><a target="_blank" href="<?php echo base_url().'animal-'; ?><?php echo $transport_animals[$a]['in_animal_id']; ?>  -  <?php echo $this->common_function->get_filtered_name($transport_animals[$a]['st_animal_name']); ?>"><?php echo $transport_animals[$a]['st_animal_name'];?></a><span><?php echo $transport_animals[$a]['st_animal_breed_name']." ".$transport_animals[$a]['st_animal_type_name'];?></span></span>
                        <span class="right-img"><a  href="javascript:void(0);" class="preview" rel="popover" data-class="bdrt-tip <?php echo $transport_animals[$a]['st_css_class'];?>" data-placement="left" data-original-title="Couch Potato" data-content="<img src='<?php echo $demenor_thumb_url; ?>'/> <?php echo $transport_animals[$a]['st_demeanor_desc'];?>"><img src="<?php echo $demenor_url; ?>" alt="Mittens" title="Mittens" /></a></span>
                        <div class="clear"></div>
                        <p><?php if(!empty($transport_animals[$a]['st_profile_story']) && isset($transport_animals[$a]['st_profile_story'])) { ?>
								<?php echo substr($transport_animals[$a]['st_profile_story'],0,100);  ?>.. <a target="_blank" href="<?php echo base_url().'animal-'; ?><?php echo $transport_animals[$a]['in_animal_id']; ?>  -  <?php echo $this->common_function->get_filtered_name($transport_animals[$a]['st_animal_name']); ?>"  >Read More</a>
								<?php }  ?>
						</p>
                    </li>
					 <?php } } ?>
					<!--<li>
                    	<span class="left-img"><img src="<?php echo base_url(); ?>assets/img/dog-img.png" alt="Mittens" title="Mittens" /></span>
                        <span class="cont"><a href="#">Mittens</a><span>Pug Dog</span></span>
                        <span class="right-img"><img src="<?php echo base_url(); ?>assets/img/pet/dog-icon-01.gif" alt="Mittens" title="Mittens" /></span>
                        <div class="clear"></div>
                        <p>Sed ut perspiciatis unde omnis iste natus error sit voluptatem accusantium doloremque laudantium, totam rem aperiam, eaque ipsa quae ab illo inventore veritatis <a href="#">Read More</a></p>
                    </li>
                    <li>
                    	<span class="left-img"><img src="<?php echo base_url(); ?>assets/img/dog-img.png" alt="Milkshake" title="Milkshake" /></span>
                        <span class="cont"><a href="#">Milkshake</a><span>Boxer Dog</span></span>
                        <span class="right-img"><img src="<?php echo base_url(); ?>assets/img/pet/dog-icon-01.gif" alt="Milkshake" title="Milkshake" /></span>
                        <div class="clear"></div>
                        <p>Sed ut perspiciatis unde omnis iste natus error sit voluptatem accusantium doloremque laudantium, totam rem aperiam, eaque ipsa quae ab illo inventore veritatis <a href="">Read More</a></p>
                    </li>-->
                
				<?php } ?>
				</ul>
                </div>
				  <div class="animal-block2">
            <h2>Animal Rescue Transportation created by</h2>
				<?php 		//$picture = $this->common_function->get_picture($transport_details['in_organization_id']);
				//$profile_image = '';
				//print_r($transport_details);
				if(!empty($transport_details['st_org_image']) != '' &&  isset($transport_details['st_org_image']) && file_exists($this->config->item('upload').'org_doc/thumb/'.$transport_details['st_org_image'])) 
				{
					$profile_image = $transport_details['st_org_image'];
					$org_profile_src = $this->config->item('upload_url').'org_doc/thumb/'.$profile_image; 
				} else {
					$profile_image = 'temp-logo.jpg';
					$org_profile_src = $this->config->item('upload_url').'org_doc/thumb/'.$profile_image; 
				}	
			?>
            <div class="rescue-transport-usa"><span class="rescue-usa-img"><img src="<?php echo $org_profile_src; ?>" alt="<?php echo $transport_details['st_org_name'];?>" title="<?php echo $transport_details['st_org_name'];?>" /></span> <span><a target="_blank" href="<?php echo base_url(); ?>organization-<?php echo $transport_details['in_organization_id']; ?>-<?php echo $this->common_function->get_filtered_name($transport_details['st_org_name']); ?>"><?php echo $transport_details['st_org_name'];?></a></span></div>
            <p>	<?php if(!empty($transport_details['st_profile_desc']) && isset($transport_details['st_profile_desc'])) { ?>
				<?php echo substr($transport_details['st_profile_desc'],0,100);  ?>.. <a target="_blank" href="<?php echo base_url(); ?>organization-<?php echo $transport_details['in_organization_id']; ?>-<?php echo $this->common_function->get_filtered_name($transport_details['st_org_name']); ?>"  >Read More</a>
				<?php } ?>
			</p>
            </div>
			<div class="animal-block3">
            <h2>What is Doobert.com?</h2>
			<?php //print_r($transport_details); ?>
            <p>Doobert is about one thing - bringing us all together to help rescue as many animals as we can. With the help of this easy-to-use tool, you can volunteer at a rescue or shelter, sign up to be an animal transporter, or help raise funds for a spacific animal transport. The software makes it easy to set up the route and for drivers and pilots and rescue groups to coordinate entire trips in just minutes.</p>
            </div>
			 
			   </div>
			   </div>
			   
             
              <div class="gr-wrap col-lg-9 col-md-8 col-sm-12 tabs">
                <div class="bg">
                 
                  <ul class="nav nav-pills" style="margin-bottom:0;float:left" id="info_ul">
                    <li id="r_info"  class=""><a href="#tab_2_1" data-toggle="tab">Info</a></li>
                    <?php if(empty($leg_page_link)){ ?>
                    <li id="r_map"  class="active"><a href="#tab_2_2" id="route_tab" data-toggle="tab">Route</a> </li>
                    <?php } ?>
                    <?php for($m=1;$m<=count($leg_page_link);$m++)
						{ 
						if($leg_page_link[$m]['selected']==$m){
						?>
                    <script type="text/javascript">
					   var end_li ="<?php echo $leg_page_link[$m]['end_li']?>"; 
					   var start_li ="<?php echo $leg_page_link[$m]['start_li']?>"; 
					   
					   </script>
                    <?php } ?>
                    <li id="r_map<?php echo $m;?>"  class="icon_class <?php if($leg_page_link[$m]['selected']==$m){ echo "active"; }  ?>"><a href="<?php echo $this->config->item('base_url')."org-transportation-scheduled/".$this->session->userdata('transport_id')."/".$m; ?>" id="route_tab_<?php echo $m;?>"><?php echo ($m=='1')?"Legs":"";?> <?php echo $leg_page_link[$m]['text'];?></a> </li>
                    <?php } ?>
                    <li id="r_feed"><a href="#tab_2_3" data-toggle="tab">Feed</a></li>
                    <li id="r_photos"><a href="#tab_4_3" data-toggle="tab">Photos/Story</a></li>
                  </ul>
                <?php if ($transport_details['st_trans_type']=='P') { ?> 
					<span class="btn light-green transport-view-map map" title="View Map"><i class="fa fa-eye"></i> View Map</span>
				<?php }else{ ?>
				 <span class="btn light-green transport-view-map map" title="Hide Map"><i class="fa fa-eye-slash"></i> Hide Map</span>				 
                  <?php } ?>
				  <?php
				 		$tc_permission = ''; 
						if(isset($tc_user) && !empty($tc_user))
						{ 
							if(array_key_exists('transport',$tc_user))
							{
								$tc_permission = 'Y';								 
							}	
						}			  
				   if(($transport_details['in_trans_coods_id']==$this->session->userdata('userid')) || ($owner_id == $this->session->userdata('userid')) || ($tc_permission == 'Y')) { ?>
				  <span class="btn orange" style='float: right;margin-top: 5px;margin-left: 5px;' title="Print Run Sheet"><a href="<?php echo base_url(); ?>org_transportation/download_transportation_pdf/"  title="Print Run Sheet" style='color: white !important; text-decoration: none;' target="_blank" id="pdf">Print Run Sheet</a></span>
				  <?php }?>
                  <?php if($transport_details['st_trans_type']=='D'){ ?>
                  <?php /*?><a id="driverleginfo_icon" href="#driverleginfo" class="driverleginfo" data-toggle="modal" title="Info"><span class="other-dev">Click here for info</span><span class="mob">For info</span> <i class="fa fa-hand-o-right"></i><i class="fa fa-info-circle"></i></a><?php */?>
                  <?php if(isset($profile_info) && isset($profile_info['st_driver']) && $profile_info['st_driver']=='Y') { ?>
                  <a id="driverleginfo_icon" href="#driverleginfo" class="driverleginfo" data-toggle="modal" title="Info"><span class="other-dev">Drivers click here for info</span><span class="mob">For Drivers info</span> <i class="fa fa-hand-o-right"></i><i class="fa fa-info-circle"></i></a>
                  <?php } ?>
                  <?php if(isset($profile_info) && isset($profile_info['st_pilot']) && $profile_info['st_pilot']=='Y') { ?>
                  <a id="pilotleginfo_icon" href="#pilotleginfo" class="driverleginfo" data-toggle="modal" title="Info"><span class="other-dev">Pilots click here for info</span><span class="mob">For Pilots info</span> <i class="fa fa-hand-o-right"></i><i class="fa fa-info-circle"></i></a>
                  <?php } ?>
                  <?php if((isset($profile_info) && isset($profile_info['st_driver']) && $profile_info['st_driver']=='N') && (isset($profile_info) && isset($profile_info['st_pilot']) && $profile_info['st_pilot']=='N')) { ?>
                  <a id="driverleginfo_icon" href="#driverleginfo" class="driverleginfo" data-toggle="modal" title="Info"><span class="other-dev">Drivers click here for info</span><span class="mob">For Drivers info</span> <i class="fa fa-hand-o-right"></i><i class="fa fa-info-circle"></i></a>
                  <?php } ?>
                  <?php } ?>
                  <div class="clearfix"></div>
                </div>
                <div class="clearfix"></div>
                <div class="tab-content">
                  <div id="tab_2_1" class="tab-pane info fade ">
                    <?PHP include APPPATH."views/includes/transport-info.php"; ?>
                  </div>
                  <div class="tab-pane fade map01 column2 active in" id="tab_2_2">
                    <?PHP
				 $display  	= '';
				 $div		= '';
				 $type 		= "false";
				 $atype  	= "false";
				 $legs 		= '';
				 $date_js  	= '';
				 //echo "===>".$single_join;
				 //echo $join."==".$ajoin;
				 //echo "<pre>";print_r($transport_details['st_from_street'].",".$transport_details['st_from_city'].",".$transport_details['st_from_state'].",".$transport_details['st_from_zip']); echo "</pre>";
				 if($transport_details['st_trans_type']=='P')
				 {
					 $display = "style=\"display:none;\"";
					 $type =  "false";
				 }
				 else
				 { 
				 	if(isset($single_join) && $single_join=="true"){   //For a aviation or driver route selection.
					//if(isset($join) || isset($ajoin)){  //For a aviation and one driver route selection.
							$type = isset($join)?$join:"false"; //For a aviation and one driver route selection.
							$atype = isset($ajoin)?$ajoin:"false";//For a aviation and one driver route selection.					
							$date_js = "yes";
							if(((isset($transport_type) && $transport_type=='1')) || $atype=='true' && $type=="false")
							{
								$div = '<div  class="fl" id="can-save1"><a rel="nofollow" href="'.base_url().'org-transportation-scheduled/'.$transport_details['in_transportation_id'].'/" data-method="post" class="button btn pink-btn">Save Legs <i class="fa fa-angle-right"></i></a></div>';
							}
							else
							{
								$div = '<div  class="fl" id="can-save"><a rel="nofollow" href="'.base_url().'org-transportation-scheduled/'.$transport_details['in_transportation_id'].'/" data-method="post" class="button btn pink-btn">Save Legs <i class="fa fa-angle-right"></i></a></div>';
							}
					}
					
					else
					{
						 $type =  "false";
						 $atype = "false";
						 $single_join = "false";
						 $display = "style=\"display:none;\"";
						
					}
					if($cover_dist>=100)
					{
						$type =  "false";
						$atype = "false";
						$single_join = "false";
						$display = "style=\"display:none;\"";
					}
				}
					
				//if(isset($user_profile['st_driver']) && $user_profile['st_driver']=='Y' && isset($user_profile['st_pilot']))
					if(((isset($transport_type) && $transport_type=='1')) || $atype=='true' && $type=="false")
					{
						//$type = $atype;
						#============== For aviation map=================#
						include APPPATH."views/includes/transport-routes_aviation.php";
					}
					else
					{
						 $type =  $type;
						#============== For route map=================#
						 include APPPATH."views/includes/transport-routes.php"; 
					}
				?>
				
				<div id="map-hide" class="gr-wrap col-lg-12 col-md-12 col-sm-12 view_map_tg">
				<div class="clearfix"></div>
				<div class="transport-legs-detail">
			    
				
				<form class="horizontal-form" role="form" id="legs_select" name="legs_select" enctype="multipart/form-data" action="" method="post">
				<?php 
				$count_driver = 0;
				if(isset($leg_details) && !empty($leg_details))
				{
				?>
					<ul>
					<?php 
					$i=1;
					$leave='n';
					$a = 1;
					$leave_mark = "";
					foreach($leg_details as $key=>$value)
					{
						$contct_legs=unserialize($value['st_contact']);
						//echo "<pre>-----";print_r($contct);die;
							if(empty($value['st_contact']))
							{
								$first_legs ='yes';
							}
							else
							{
								$first_legs ='no';
							}
						
						$class= $this->common_function->color_class[$a];
						if($a==8)
						{
							$a=1;
						}
						else
						{
							$a++;
						}
						if($value['user_id']==$this->session->userdata('userid'))
						{
							$leave='y';
						}
						
						$participants_user_ids = array();
						foreach($value['leg_participant_details'] as $user_key=>$participants)
						{
							$participants_user_ids[] =  $participants['in_user_id'];
						}
						
						$prev_leg_participants_user_ids = array();
						if (array_key_exists($key - 1, $leg_details)) {
							foreach($leg_details[$key - 1]['leg_participant_details'] as $user_key=>$participants)
							{
								$prev_leg_participants_user_ids[] =  $participants['in_user_id'];
							}
						}
						
						$next_leg_participants_user_ids = array();
						if (array_key_exists($key + 1, $leg_details)) {
							foreach($leg_details[$key + 1]['leg_participant_details'] as $user_key=>$participants)
							{
								$next_leg_participants_user_ids[] =  $participants['in_user_id'];
							}
						}
						
					?>
						<li>
							<h3><i class="fa fa-flag <?php  echo $class;?>"></i> Leg-<?php echo $i ;?> 
							<span><?php if($value['route_type_id'] == '0' && $value['in_multi_user'] == '1' && $value['in_user_num'] > 1 && ($value['participants_cnt'] == 0) && ($value['non_doobert_participants_cnt'] == 0)) { ?>
						(<?php echo $value['in_user_num']; ?> driver(s) needed)
						<?php } ?>
						<?php if($value['route_type_id'] == '0' && $value['in_multi_user'] == '1' && $value['in_user_num'] > 1 && ($value['participants_cnt'] != 0 || $value['non_doobert_participants_cnt'] != 0) && ($value['in_user_num'] - ($value['participants_cnt']+$value['non_doobert_participants_cnt'])) != 0) { ?>
						(<?php echo ($value['in_user_num'] - ($value['participants_cnt']+$value['non_doobert_participants_cnt'])); ?> driver(s) needed)
						<?php } ?>
						<?php if($value['route_type_id'] == '1' && $value['in_multi_user'] == '1' && $value['in_user_num'] > 1 && ($value['participants_cnt'] == 0) && ($value['non_doobert_participants_cnt'] == 0)) { ?>
						(<?php echo $value['in_user_num']; ?> pilot(s) needed)
						<?php }?>
						<?php if($value['route_type_id'] == '1' && $value['in_multi_user'] == '1' && $value['in_user_num'] > 1 && ($value['participants_cnt'] != 0 || $value['non_doobert_participants_cnt'] != 0) && ($value['in_user_num'] - ($value['participants_cnt']+$value['non_doobert_participants_cnt'])) != 0) { ?>
						(<?php echo ($value['in_user_num']-($value['participants_cnt']+$value['non_doobert_participants_cnt'])); ?> pilot(s) needed)
						<?php } ?></span>
						
							<?php //print_r($value['leg_participant_details']);
					
							foreach($value['leg_participant_details'] as $user_key=>$participants)
							{
							  if($participants['in_user_id']==$this->session->userdata('userid'))
							  {
								  if($value['mark_completed']=='1')
								  {
									if(!$leave_mark)  
										$leave_mark = "n";
								  }
							?>
                              <?php if($transport_details['in_status']=='1' && $value['mark_completed']!='1'){ ?>
                              <div class="leg-cancel-btn-wrap cancel_from_leg_popup">
                                <button style="margin-right:0px" aria-hidden="true" onClick="$('#action').val('cancel');$('#cancel_leg_id').val('<?php echo $value['leg_id'] ;?>');" legtype='cancel' data-val="loadimg_<?php echo $i;?>" name="cancel_leg_<?php echo $i;?>" id="cancel_leg_<?php echo $i;?>" class="cancel  cancel_leg" type="submit"  title="Exit From Leg"><i class="fa fa-share-square-o"></i> Exit From Leg</button>
								
								<img class="loder_cancel fr" id="loadimg_<?php echo $i;?>" style="display:none;" src="<?php echo base_url(); ?>assets/img/ajax-loading.gif" alt="loader" /> </div>
                              <!-- .CANCEL LEG MODAL POPUP-->
                              <div class="modal fade cancel_popup_width" id="cancel_popup_<?php echo $value['leg_id'] ;?>" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
                                <div class="modal-dialog">
                                  <div class="modal-content">
                                    <div class="modal-body">
                                      <button aria-hidden="true" data-dismiss="modal" class="close" type="button"  title="Close"></button>
                                      <div class="form-group">
                                        <div class="radio-list">
                                          <label class="radio-inline">
                                            <input type="radio" class="cancel_leg_radio" name="cancel_leg_radio_<?php echo $value['leg_id'] ;?>" id="cancel_leg_only_<?php echo $value['leg_id'] ;?>" value="only" checked>Would you like to cancel from leg? </label>
                                        </div>
                                      </div>
                                      <?php /*?><div class="form-group">
                                        <div class="radio-list">
                                          <label class="radio-inline">
                                            <input type="radio" name="cancel_leg_radio_<?php echo $value['leg_id'] ;?>" id="cancel_leg_all_<?php echo $value['leg_id'] ;?>" value="all">
                                            Would you like to cancel from leg and transport? </label>
                                        </div>
                                      </div><?php */?>
									  <div style="text-align:center;">
                                      <a class="btn pink" data-dismiss="modal" href="javascript:void(0);" onClick="cancel_leg_or_transport(<?php echo $value['leg_id'] ;?>);" title="Continue">Continue</a> 
									  <a class="btn pink" data-dismiss="modal" href="javascript:void(0);" title="Cancel">Cancel</a> 
									  </div>
									  </div>
									  
                                  </div>
                                  <!-- /.modal-content --> 
                                </div>
                                <!-- /.modal-dialog --> 
                              </div>
                              <?php } ?>
                              <?php } ?>
							  <?php } ?>
							  
							  <?php 
							  if($value['in_multi_user'] == 1 && $value['in_user_num'] > 1 && ($value['in_user_num'] - ($value['participants_cnt']+$value['non_doobert_participants_cnt'])) == 0)
							  { ?>
							  <span class="filled-text"><i class="fa fa-check blue"></i> Filled</span>
							  <?php } ?>
							  <?php 
							  if($value['in_multi_user'] == 0 && $value['in_user_num'] == 0 && ($value['participants_cnt']+$value['non_doobert_participants_cnt']) > 0)
							  { ?>
							  <span class="filled-text"><i class="fa fa-check blue"></i> Filled</span>
							  <?php } ?>
							</h3>
							<div class="leg-inner-cont">
							<?php if($value['route_type_id'] == '1' || $value['route_type_id'] == '0') { ?>
							<p><span>From:</span> <?php echo ((isset($value['pick_street']) && $value['pick_street'] != '') ?$value['pick_street'].", ":"").(isset($value['pick_city']) ?$value['pick_city'].", ":"").(isset($value['pick_state'])?$value['pick_state']:"").(isset($value['pick_zip'])?", ".$value['pick_zip']:""); ?> </p>
							<p><span>To:</span> <?php echo ((isset($value['drop_street']) && $value['drop_street'] != '') ?$value['drop_street'].", ":"").(isset($value['drop_city'])?$value['drop_city'].", ":"").(isset($value['drop_state'])?$value['drop_state']:"").(isset($value['drop_zip'])?", ".$value['drop_zip']:""); ?></p>
                            <!--<p><span>Distance:</span> <?php echo number_format($value['leg_distance'],"2",".","").' miles';?></span></p> -->
							<p><span>Distance:</span> <?php echo round($value['leg_distance']).' miles';?></span></p>
						   	<?php } ?>
							
							<?php if($value['route_type_id'] == '2') { ?>
							<p><strong>Overnight Leg: </strong></b><?php echo (isset($value['st_street']) && $value['st_street'] != '' ?$value['st_street'].", ":"").(isset($value['st_city']) ?$value['st_city'].", ":"").(isset($value['st_state'])?$value['st_state']:"").(isset($value['st_zip'])?", ".$value['st_zip']:""); ?></p>
							 <p class="inline"><strong>Comments: </strong><?php echo (isset($value['st_meeting_location']) && $value['st_meeting_location'] != '') ? stripslashes($value['st_meeting_location']) : '-'; ?></p>
							<?php } ?>
							<?php if(isset($value['pick_start_time']) || isset($value['pick_timezone'])) { ?>
							<p class="leg-start"><span>Start:</span> <?php echo date("M d - h:i A",strtotime($value['pick_start_time']))." - ".$value['pick_timezone'];?></p>
							 <?php } ?>
							 <?php if(isset($value['drop_start_time']) || isset($value['drop_timezone'])) { ?>
							<p><span>End:</span> <?php echo date("M d - h:i A",strtotime($value['drop_start_time']))." - ".$value['drop_timezone'];?></p>
							  <?php } ?>
							 <?php if($value['route_type_id'] == '1' || $value['route_type_id'] == '0') { ?> 
							 <?php $tc_permission = ''; 
							 if(isset($tc_user) && !empty($tc_user))
							 { 
								 if(array_key_exists('transport',$tc_user))
								 {
									 $tc_permission = 'Y';								 
								 }
							 }							
							 if(in_array($this->session->userdata('userid'),$participants_user_ids) || in_array($this->session->userdata('userid'),$next_leg_participants_user_ids) || in_array($this->session->userdata('userid'),$prev_leg_participants_user_ids) || ($transport_details['in_trans_coods_id'] == $this->session->userdata('userid')) || ($tc_permission == 'Y'))
							 { ?>
							<p><span>Meeting Location:</span> <?php echo (isset($value['st_meeting_location']) && $value['st_meeting_location'] != '') ?stripslashes($value['st_meeting_location']) : '-'; ?>
							<a href="javascript:void(0);" class="edit-meeting" onClick="$('#txt_edit_leg_id').val('<?php echo $value['leg_id']; ?>');$('#txt_edit_meeting_location').val('<?php echo addslashes($value['st_meeting_location']); ?>');$('#edit_meeting_location').modal('show');">Edit</a></p>
							<?php } ?>
							<?php } ?>
							
							</div>
							<div class="bottom-part">
							
								<div class="prenex slider-next nex-<?php echo $value['leg_id'];?>"></div>
								<div class="prenex slider-prev pre-<?php echo $value['leg_id'] ;?>"></div>
                                <div class="slider-div slider-<?php echo $value['leg_id'] ;?>">
                                   
                                  <div>
								  <div class="slide slider1" id="slider1_<?php echo $value['leg_id'] ;?>">
											
										<?php	
							 $user_part_ids = array();
							 $user_part_ids = $this->common_function->get_user_part_ids_by_leg_id($value['leg_id']);
							if((((isset($permission['transport']) && in_array('transport_ed',$permission['transport'])) || (isset($permission['transport']) && in_array('transport_cr',$permission['transport']))) || (isset($user_profile['st_driver']) && $user_profile['st_driver']=='Y')) && $transport_details['st_trans_type']=='P' && $value['route_type_id']=='0'){ //echo 'in if';
									?>
								<?php if($transport_details['in_status']=='1'){  ?>
								<?php if(isset($value['in_user_num']) && isset($value['participants_cnt']) && ($value['in_user_num'] > ($value['participants_cnt']+$value['non_doobert_participants_cnt']))){    ?>
								<div class="btns cancel assign-nonuser">
								  <?php if(!in_array($this->session->userdata('userid'),$user_part_ids)) { ?> 
								  <button legtype='join' aria-hidden="true" onClick="$('#action').val('join_leg');$('#cancel_leg_id').val('<?php echo $value['leg_id'] ;?>');" name="join_leg_<?php echo $i;?>" data-val="loadimg_<?php echo $i;?>" id="join_leg_<?php echo $i;?>" class="btn orange dobt-btn cancel fl cancel_leg" type="submit"  title="Select Leg">Select Leg</button> <?php } ?>
								 <img  class="loder_cancel fr" id="loadimg_<?php echo $i;?>" style="display:none;" src="<?php echo base_url(); ?>assets/img/ajax-loading.gif" alt="loader" /> 
								 
								 <?php 
								if((isset($permission['transport']) && in_array('transport_ed',$permission['transport'])) || (isset($permission['transport']) && in_array('transport_cr',$permission['transport']))){ ?>
								  <button name="assign" id='assign-non-doobert' href="javascript:void(0)" onClick="$('#non_doobert_user_transport_id').val('<?php echo $transport_details['in_transportation_id']; ?>');$('#non_doobert_user_transport_leg_id').val('<?php echo  $value['leg_id']; ?>');$('.non-doobert_leg_srno').html('Assign Leg-<?php echo $i; ?> to Non-Doobert User ');$('#assign-nondoobert-user').modal('show');"  data-toggle="modal" class="btn dark-blue cancel fl cancel_leg dobt-btn assign-user-btn" title="Assign to Non-Doobert User">Assign to Non-Doobert User</button>	
								  <?php } ?>
								 <div class="clearfix"></div>
								 </div>
								<?php } ?>
								<?php if(($value['in_multi_user'] == 0) && ($value['participants_cnt'] == 0) && ($value['non_doobert_participants_cnt'] == 0)){    ?>
								<div class="btns cancel assign-nonuser">
								    <?php if(isset($profile_info) && isset($profile_info['st_primary_phone']) && $profile_info['st_primary_phone']!='') { ?>
								  		<button legtype='join' aria-hidden="true" onClick="$('#action').val('join_leg');$('#cancel_leg_id').val('<?php echo $value['leg_id'] ;?>');" name="join_leg_<?php echo $i;?>" data-val="loadimg_<?php echo $i;?>" id="join_leg_<?php echo $i;?>" class="btn orange dobt-btn cancel fl cancel_leg" type="submit"  title="Select Leg">Select Leg</button>
								  <?php } else { ?>
										<button legtype='join' aria-hidden="true" onClick="set_phone_number('<?php echo $value['leg_id'] ;?>');  return false;" name="join_leg_<?php echo $i;?>" data-val="loadimg_<?php echo $i;?>" id="join_leg_<?php echo $i;?>" class="btn orange dobt-btn cancel fl cancel_leg" type="submit"  title="Select Leg">Select Leg</button>
								  <?php } ?>
								  <img  class="loder_cancel fr" id="loadimg_<?php echo $i;?>" style="display:none;" src="<?php echo base_url(); ?>assets/img/ajax-loading.gif" alt="loader" />
								  <?php 
								if((isset($permission['transport']) && in_array('transport_ed',$permission['transport'])) || (isset($permission['transport']) && in_array('transport_cr',$permission['transport']))){ ?>
								  <button name="assign" id='assign-non-doobert' href="javascript:void(0)" onClick="$('#non_doobert_user_transport_id').val('<?php echo $transport_details['in_transportation_id']; ?>');$('#non_doobert_user_transport_leg_id').val('<?php echo  $value['leg_id']; ?>');$('.non-doobert_leg_srno').html('Assign Leg-<?php echo $i; ?> to Non-Doobert User ');$('#assign-nondoobert-user').modal('show');"  data-toggle="modal" class="btn dark-blue cancel fl cancel_leg dobt-btn assign-user-btn" title="Assign to Non-Doobert User">Assign to Non-Doobert User</button>
								  <?php } ?>
								  <div class="clearfix"></div>
								   </div>
								<?php } ?>
								<?php } ?>
								<?php } 
								if((((isset($permission['transport']) && in_array('transport_ed',$permission['transport'])) || (isset($permission['transport']) && in_array('transport_cr',$permission['transport']))) || (isset($user_profile['st_pilot']) && $user_profile['st_pilot']=='Y')) && $transport_details['st_trans_type']=='P' && $value['route_type_id']=='1')
								{ 
								?>
                        <?php if($transport_details['in_status']=='1'){    ?>
						
                        <?php if(isset($value['in_user_num']) && isset($value['participants_cnt']) && ($value['in_user_num'] > ($value['participants_cnt']+$value['non_doobert_participants_cnt']))){    ?>
                        <div class="btns cancel assign-nonuser">
                        <?php if(!in_array($this->session->userdata('userid'),$user_part_ids)) { ?>
						<?php if(isset($profile_info) && isset($profile_info['st_primary_phone']) && $profile_info['st_primary_phone']!='') { ?> 
                        <button legtype='join' aria-hidden="true" onClick="$('#action').val('join_leg');$('#cancel_leg_id').val('<?php echo $value['leg_id'] ;?>');" name="join_leg_<?php echo $i;?>" data-val="loadimg_<?php echo $i;?>" id="join_leg_<?php echo $i;?>" class="btn orange dobt-btn cancel fl cancel_leg" type="submit"  title="Select Leg">Select Leg</button> 
							<?php } else { ?>
							<button legtype='join' aria-hidden="true" onClick="set_phone_number('<?php echo $value['leg_id'] ;?>'); return false;" name="join_leg_<?php echo $i;?>" data-val="loadimg_<?php echo $i;?>" id="join_leg_<?php echo $i;?>" class="btn orange dobt-btn cancel fl cancel_leg" type="submit"  title="Select Leg">Select Leg</button>
							<?php } ?>	
						<?php } ?>
                          <img  class="loder_cancel fr" id="loadimg_<?php echo $i;?>" style="display:none;" src="<?php echo base_url(); ?>assets/img/ajax-loading.gif" alt="loader" /> 
                         <?php 
						if((isset($permission['transport']) && in_array('transport_ed',$permission['transport'])) || (isset($permission['transport']) && in_array('transport_cr',$permission['transport']))){ ?>
                          <button name="assign" id='assign-non-doobert' href="javascript:void(0)" onClick="$('#non_doobert_user_transport_id').val('<?php echo $transport_details['in_transportation_id']; ?>');$('#non_doobert_user_transport_leg_id').val('<?php echo  $value['leg_id']; ?>');$('.non-doobert_leg_srno').html('Assign Leg-<?php echo $i; ?> to Non-Doobert User ');$('#assign-nondoobert-user').modal('show');"  data-toggle="modal" class="btn dark-blue cancel fl cancel_leg dobt-btn assign-user-btn" title="Assign to Non-Doobert User">Assign to Non-Doobert User</button>
                          <?php } ?>
                          
                          <div class="clearfix"></div>
                          </div>
                        <?php } ?>
                        <?php if(($value['in_multi_user'] == 0) && ($value['participants_cnt'] == 0) && ($value['non_doobert_participants_cnt'] == 0)){    ?>
                        <div class="btns cancel assign-nonuser">
						<?php if(isset($profile_info) && isset($profile_info['st_primary_phone']) && $profile_info['st_primary_phone']!='') { ?>
                          <button legtype='join' aria-hidden="true" onClick="$('#action').val('join_leg');$('#cancel_leg_id').val('<?php echo $value['leg_id'] ;?>');" name="join_leg_<?php echo $i;?>" data-val="loadimg_<?php echo $i;?>" id="join_leg_<?php echo $i;?>" class="btn orange dobt-btn cancel fl cancel_leg" type="submit"  title="Select Leg">Select Leg</button>
						  <?php } else { ?>
							<button legtype='join' aria-hidden="true" onClick="set_phone_number('<?php echo $value['leg_id'] ;?>'); return false;" name="join_leg_<?php echo $i;?>" data-val="loadimg_<?php echo $i;?>" id="join_leg_<?php echo $i;?>" class="btn orange dobt-btn cancel fl cancel_leg" type="submit"  title="Select Leg">Select Leg</button>
							<?php } ?>	
                          <img  class="loder_cancel fr" id="loadimg_<?php echo $i;?>" style="display:none;" src="<?php echo base_url(); ?>assets/img/ajax-loading.gif" alt="loader" />
						  <?php 
						if((isset($permission['transport']) && in_array('transport_ed',$permission['transport'])) || (isset($permission['transport']) && in_array('transport_cr',$permission['transport']))){ ?>
                         <button name="assign" id='assign-non-doobert' href="javascript:void(0)" onClick="$('#non_doobert_user_transport_id').val('<?php echo $transport_details['in_transportation_id']; ?>');$('#non_doobert_user_transport_leg_id').val('<?php echo  $value['leg_id']; ?>');$('.non-doobert_leg_srno').html('Assign Leg-<?php echo $i; ?> to Non-Doobert User ');$('#assign-nondoobert-user').modal('show');"  data-toggle="modal" class="btn dark-blue cancel fl cancel_leg dobt-btn assign-user-btn" title="Assign to Non-Doobert User">Assign to Non-Doobert User</button>
                         <?php } ?>
                          <div class="clearfix"></div>
                           </div>
                        <?php } ?>
                        <?php } ?>
                        <?php } if($transport_details['st_trans_type']=='P' && $value['route_type_id']=='2' && empty($value['user_id']) && ($value['non_doobert_participants_cnt'] == 0)) {  ?>
                        <?php if($transport_details['in_status']=='1'){    ?>
                        <div class="btns cancel assign-nonuser">
						<?php if(isset($profile_info) && isset($profile_info['st_primary_phone']) && $profile_info['st_primary_phone']!='') { ?>
                          <button legtype='join' aria-hidden="true" onClick="$('#action').val('join_leg');$('#cancel_leg_id').val('<?php echo $value['leg_id'] ;?>');" name="join_leg_<?php echo $i;?>" data-val="loadimg_<?php echo $i;?>" id="join_leg_<?php echo $i;?>" class="btn orange dobt-btn cancel fl cancel_leg" type="submit"  title="Select Leg">Select Leg</button>
							<?php } else { ?>
							<button legtype='join' aria-hidden="true" onClick="set_phone_number('<?php echo $value['leg_id'] ;?>'); return false;" name="join_leg_<?php echo $i;?>" data-val="loadimg_<?php echo $i;?>" id="join_leg_<?php echo $i;?>" class="btn orange dobt-btn cancel fl cancel_leg" type="submit"  title="Select Leg">Select Leg</button>
							<?php } ?>
                          <img  class="loder_cancel fr" id="loadimg_<?php echo $i;?>" style="display:none;" src="<?php echo base_url(); ?>assets/img/ajax-loading.gif" alt="loader" />
						   <?php 
						if((isset($permission['transport']) && in_array('transport_ed',$permission['transport'])) || (isset($permission['transport']) && in_array('transport_cr',$permission['transport']))){ ?>
                          <button name="assign" id='assign-non-doobert' href="javascript:void(0)" onClick="$('#non_doobert_user_transport_id').val('<?php echo $transport_details['in_transportation_id']; ?>');$('#non_doobert_user_transport_leg_id').val('<?php echo  $value['leg_id']; ?>');$('.non-doobert_leg_srno').html('Assign Leg-<?php echo $i; ?> to Non-Doobert User ');$('#assign-nondoobert-user').modal('show');"  data-toggle="modal" class="btn dark-blue cancel fl cancel_leg dobt-btn assign-user-btn" title="Assign to Non-Doobert User">Assign to Non-Doobert User</button>
                          <?php } ?>
                          <div class="clearfix"></div>
                           </div>
                        <?php } ?>
						<?php }	?>
						
							</div>
								  </div>
							<?php //print_r($value['leg_participant_details']);
                                foreach($value['leg_participant_details'] as $user_key=>$participants)
                                {
                                    //echo '<pre/>';print_r($participants);	
									if($participants['st_profile_image']!='' && file_exists($this->config->item('upload')."profile/63x63/".$participants['st_profile_image']))
									  {
										  $image_url  = $this->config->item('upload_url')."profile/63x63/".$participants['st_profile_image'];
									  }
									  else
									  {
										  $image_url  = $this->config->item('upload_url')."profile/63x63/no_photo_icon.png";
									  }
									  ?>
									<div>
									<div class="slide">
							<div class="logo"><img src="<?php echo $image_url; ?>" alt="<?php echo $participants['st_display_name']; ?>" title="<?php echo $participants['st_display_name']; ?>">
							
							
							
							</div>
							 <?php
							$link_name 	= $this->common_function->get_filtered_name($participants['st_display_name']);
							$url_link 	= base_url()."user-".$participants['in_user_id']."-".$link_name."/";
							
							$pr_add = '';
							if(isset($participants['pr_st_city']) && $participants['pr_st_city'] != ''){
							$pr_add .= $participants['pr_st_city'].", ";
							}
							if(isset($participants['pr_st_state']) && $participants['pr_st_state'] != ''){
							$pr_add .= $participants['pr_st_state'].", ";
							}
							if(isset($participants['pr_st_zip']) && $participants['pr_st_zip'] != ''){
							$pr_add .= $participants['pr_st_zip'];
							}
						?>
                              
							<div class="transport-driver-info"><span><a href="<?php echo $url_link;?>" target="_blank"><?php echo $participants['st_display_name']; ?></a>
							<?php $check_driver_verification = $this->common_model->get_user_verified($participants['in_user_id']); 
								  if(!empty($check_driver_verification)) {
									   $class = 'bg-green-logo'; 
									   $image_url = base_url().'assets/img/green_logo.jpg'; 
									   $title = date('F j, Y',strtotime($check_driver_verification['dt_doobert_verified']));

									  //$image_url = '<img src="'.base_url().'assets/img/gray_logo.png" />';
								  } else {
									   $image_url = base_url().'assets/img/gray_logo.png'; 
									   $class = 'bg-green-logo'; $title = '';
								  }	
								 $check_user_arpa = $this->common_model->check_arpa_certifcate_status($participants['in_user_id']);	
								 if(!empty($check_user_arpa) && $check_user_arpa['st_arpa_cert'] =='Y') {
									   //$class = 'bg-green-logo'; 
									   $arpa_title = date('F j, Y',strtotime($check_user_arpa['dt_arpa_cert']));
									   $image_cert_url = base_url().'assets/img/arpa-certified.png'; 
									   //$title = date('F j, Y',strtotime($check_driver_verification['dt_doobert_verified']));

									  //$image_url = '<img src="'.base_url().'assets/img/gray_logo.png" />';
								  } else {
									  $arpa_title = '';
									   $image_cert_url = base_url().'assets/img/arpa-certified-grey.png'; 
									   //$class = 'bg-green-logo'; $title = '';
								  }	
							?>
							  <img src='<?php echo $image_url; ?>' title='<?php echo $title; ?>' />
							  <img src='<?php echo $image_cert_url;  ?>'  title='<?php echo $arpa_title; ?>'   />	
                             <?php 
					  		if($transport_details['in_status']=='1' && $participants['in_user_id'] != $this->session->userdata('userid')){
								if((isset($permission['transport']) && in_array('transport_ed',$permission['transport'])) || (isset($permission['transport']) && in_array('transport_cr',$permission['transport']))){
						?>
                        <div class="leg-cancel-btn-wrap">
                          <button style="margin-left:0px" aria-hidden="true" onClick="$('#action').val('remove_from_leg');$('#cancel_leg_id').val('<?php echo $value['leg_id'] ;?>');$('#remove_user_id').val('<?php echo $participants['in_user_id'] ;?>');" legtype='remove' data-val="loadimg_<?php echo $i;?>" name="remove_leg_<?php echo $i;?>" id="remove_leg_<?php echo $i;?>" class="cancel  cancel_leg" type="submit"  title="Remove From Leg"><i class="fa fa-times"></i>Remove From Leg</button>
                          <img class="loder_cancel fr" id="loadimg_<?php echo $i;?>" style="display:none;" src="<?php echo base_url(); ?>assets/img/ajax-loading.gif" alt="loader" /> </div>
                        <?php } } ?>
                        
                        <div class="modal fade remove_popup cancel_popup_width" id="remove_popup_<?php echo $value['leg_id'] ;?>" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
                          <div class="modal-dialog" style="480px;">
                            <div class="modal-content">
                              <div class="modal-body">
                                <button aria-hidden="true" data-dismiss="modal" class="close" type="button"  title="Close"></button>
                                Are you sure you want to remove this volunteer from this transport?
                                <div class="clearfix"></div>
                                <br/>
                                <a class="btn pink" data-dismiss="modal" href="javascript:void(0);" onClick="remove_leg_and_transport(<?php echo $value['leg_id'] ;?>);" title="Remove">Remove</a> <a class="btn pink" data-dismiss="modal" href="javascript:void(0);" onClick="$('.remove_popup').hide();" title="Cancel">Cancel</a> </div>
                            </div>
                            <!-- /.modal-content --> 
                          </div>
                          <!-- /.modal-dialog --> 
                        </div>
                            </span> 
							<?php 
							$user_profile_setting_details = $this->common_model->get_user_profile_setting($participants['in_user_id']);
							if(empty($user_profile_setting_details) || (isset($user_profile_setting_details['in_public']) && $user_profile_setting_details['in_public'] == 0)) 						{
									$first ='yes';
							  } else {
									$first ='no';
							  }
							  
							  if(isset($user_profile_setting_details['st_contact']) && $user_profile_setting_details['st_contact']!='') { 			  
									$contact = unserialize($user_profile_setting_details['st_contact']); 
									$contact_array = (isset($contact) && !empty($contact)) ? $contact : '';
							  } else {
									$contact_array = '';
							  }
						   ?>
						   <?php if(($first=='no' && is_array($contact_array) && in_array('st_address1',$contact_array)) || ($transport_details['in_trans_coods_id'] == $this->session->userdata('userid')) || ($participants['in_user_id']==$this->session->userdata('userid')) || $get_legs_participants_user > 0){ ?>
						  <i class="fa fa-map-marker"></i> <?php echo (isset($pr_add) && $pr_add!= '') ? $pr_add :''; ?> <br>
						  <?php } ?>
							   
							 <?php 
						if($value['route_type_id'] == '0')
						{						 
						if($transport_details['in_status']=='1' && $value['mark_completed']!='1'){ ?><p class="change-vehi-wrap">Vehicle: <?php 
						 $vehicle_details = $this->common_function->get_vehicle_detail_by_id($participants['leg_vehicle_id']);
						 //print_r($vehicle_details);
						 $vehicle_name = $vehicle_details[0]['st_vehicle_type'];
						 /* if(isset($vehicle_details[0]['st_vehicle_license_plate']) && $vehicle_details[0]['st_vehicle_license_plate'] != '')
						 {
						 	 $vehicle_name = $vehicle_details[0]['st_vehicle_type'].' - '.$vehicle_details[0]['st_vehicle_license_plate'];
						 } */
						 echo $vehicle_name;
						 ?>  <?php if($participants['in_user_id']==$this->session->userdata('userid'))
						{ ?>
						 <a href="javascript:void(0);" onClick="$('#select_vehicle').val('<?php echo $vehicle_details[0]['in_vehicle_id']; ?>');$('#current_leg_id').val('<?php echo $value['leg_id']; ?>');$('#change_vehicle_div').modal('show');"  name="change_vehicle" class="change-vehicle" id="change_vehicle">Change Vehicle</a>
                              <?php } ?>
							  </p>
                            <?php } } ?>
							
							<?php 
							if($value['route_type_id'] == '1')
							{							 
							if($transport_details['in_status']=='1' && $value['mark_completed']!='1'){     ?>
								<p class="change-vehi-wrap">Plane:
								  <?php 
							 $plane_details = $this->common_function->get_plane_detail_by_id($participants['leg_plane_id']);
							 //print_r($vehicle_details);
							 $plane_name = $plane_details[0]['st_plane_type'];
							 /* if(isset($plane_details[0]['st_plane_number']) && $plane_details[0]['st_plane_number'] != '')
							 {
								 $plane_name = $plane_details[0]['st_plane_type'].' - '.$plane_details[0]['st_plane_number'];
							 } */
							 echo $plane_name;
							 ?>
								  <?php if($participants['in_user_id']==$this->session->userdata('userid'))
							{ ?>
								  <a href="javascript:void(0);" onClick="$('#select_plane').val('<?php echo $plane_details[0]['in_pilot_id']; ?>');$('#current_pilot_leg_id').val('<?php echo $value['leg_id']; ?>');$('#change_pilot_div').modal('show');"  name="change_vehicle" class="change-vehicle" id="change_vehicle">Change Plane</a>
								  <?php } ?>
								</p>
								<?php } } ?>
                                
                               
						 
						 </div>
						  </div>
									</div>
									<?php } ?>
									
									
									<?php //print_r($value['non_doobert_leg_participant_details']);
					
									foreach($value['non_doobert_leg_participant_details'] as $user_key=>$participants)
									{
									$image_url  = $this->config->item('upload_url')."profile/63x63/no_photo_icon.png";
									?>
									<div>
									<div class="slide">
									<div class="logo"><img src="<?php echo $image_url; ?>" alt="<?php echo $participants['st_name']; ?>" title="<?php echo $participants['st_name']; ?>">
									</div>
											<?php  
											$pr_add = '';
											if(isset($participants['st_city']) && $participants['st_city'] != ''){
											$pr_add .= $participants['st_city'].", ";
											}
											if(isset($participants['st_state_prefix']) && $participants['st_state_prefix'] != ''){
											$pr_add .= $participants['st_state_prefix'].", ";
											}
											if(isset($participants['st_zipcode']) && $participants['st_zipcode'] != ''){
											$pr_add .= $participants['st_zipcode'];
											}	
											?>
									    
                                        <div class="transport-driver-info">
                                        <span><?php echo $participants['st_name']; ?>
										<img src="<?php echo base_url().'assets/img/gray_logo.png'; ?>"  />
										<img src="<?php echo base_url().'assets/img/arpa-certified-grey.png'; ?>" />
                                        <?php 
										if($transport_details['in_status']=='1'){
											if((isset($permission['transport']) && in_array('transport_ed',$permission['transport'])) || (isset($permission['transport']) && in_array('transport_cr',$permission['transport']))){
									?>
									<div class="leg-cancel-btn-wrap">
									  <button style="margin-left:0px" aria-hidden="true" onClick="$('#non_doobert_id').val('<?php echo $participants['in_non_doobert_user_id'] ;?>');$('#remove_non_doobert_<?php echo $participants['in_non_doobert_user_id']; ?>').modal('show');return false;" class="remove_non_doobert_user" title="Remove From Leg"><i class="fa fa-times"></i>Remove From Leg</button>
									 </div>
									 
									<div class="modal fade remove_popup cancel_popup_width" id="remove_non_doobert_<?php echo $participants['in_non_doobert_user_id'] ;?>" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
									  <div class="modal-dialog" style="480px;">
										
										<div class="modal-content">
										
										  <div class="modal-body">
											<button aria-hidden="true" data-dismiss="modal" class="close" type="button"  title="Close"></button>
											Are you sure you want to remove this volunteer from this transport?
											<div class="clearfix"></div>
											<br/>
											
											<a class="btn pink" data-dismiss="modal" href="javascript:void(0);" onClick="$('#frm_del_non_doobert_user').submit();" title="Remove">Remove</a> <a class="btn pink" data-dismiss="modal" href="javascript:void(0);" title="Cancel">Cancel</a> </div>
										</div>
										 
										<!-- /.modal-content --> 
									  </div>
									  <!-- /.modal-dialog --> 
									</div>
									
									<?php } } ?>
                                        </span> <i class="fa fa-map-marker"></i> <?php echo $pr_add; ?><br>
                                        
										<?php 
										if($value['route_type_id'] == '0')
										{						 
										if($transport_details['in_status']=='1' && $value['mark_completed']!='1'){     ?>
										<p class="change-vehi-wrap">Vehicle:
										<?php 
										 $vehicle_name = $participants['st_vehicle_type'];
										 if(isset($participants['st_license_plate']) && $participants['st_license_plate'] != '')
										 {
											$vehicle_name = $participants['st_vehicle_type'].' - '.$participants['st_license_plate'];
										 }
										 echo $vehicle_name;
										 ?>
										</p>
										<?php } } ?>
										</div>
                                        
									</div>
                                    </div>
									<?php } ?>
								
						</div>
							
											
						</li>
						 <?php 
						$i++;
					}
					?>
					</ul>
					<?php
				} ?>
				</div>
				</div>
				<input  type="hidden" value="" name="action" id="action" />
                  <input  type="hidden" value="" name="cancel_leg_id" id="cancel_leg_id" />
                  <input  type="hidden" value="" name="remove_user_id" id="remove_user_id" />
                  <input  type="hidden" value="" name="remove_monitor_id" id="remove_monitor_id" />
                </form>
				
                    <?php /*?><script src="<?php echo base_url(); ?>assets/scripts/custom/infobox.js"></script>
				<script type="text/javascript">
                $.noConflict(); 
                </script><?php */?>
                  </div>
				 
				  
                  <div id="tab_2_3" class="tab-pane fade feedsbox">
                    <?PHP include APPPATH."views/includes/transport-feed.php"; ?>
                  </div>
                  <div id="tab_4_3" class="tab-pane fade feedsbox">
                    <?PHP include APPPATH."views/includes/transport-photos.php"; ?>
                  </div>
                </div>
              </div>
              <div class="clearfix"></div>
            </div>
          </div>
          <div id="change_vehicle_div" class="modal fade change-vehicle-div" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
            <form class="horizontal-form" role="form" id="frm_change_vehicle" name="frm_change_vehicle" enctype="multipart/form-data" action="" method="post" onSubmit="return update_vehicle_details();">
              <input type="hidden" name="current_leg_id" id="current_leg_id" value="">
              <input type="hidden" name="open_tab" id="open_tab" value="">
              <input type="hidden" name="update_vehicle_action" id="update_vehicle_action" value="update" />
              <div class="modal-dialog">
                <div class="modal-content">
                  <div class="modal-body">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true" title="Close"></button>
                    <div data-always-visible="1" data-rail-visible1="1">
                      <p>Please select the vehicle which you are going to use for this transportation.</p>
                      <div class="form-group"> <span class="change-vehicle-content">
                        <select id="select_vehicle" name="select_vehicle" class="form-control border-none">
                          <option value="">Select Vehicle</option>
                          <?php
										  	if(!empty($arrVehicle)){
                                            foreach($arrVehicle as $vehicle_data)
                                            {
                                            ?>
                          <option  value="<?php echo $vehicle_data['in_vehicle_id'];?>"><?php echo $vehicle_data['st_vehicle_type'].' - '.$vehicle_data['st_vehicle_license_plate']; ?></option>
                          <?php   
                                           }}
                                        ?>
                        </select>
                        </span> </div>
                      <button type="button" class="btn pink search-btn change_vehicle_btn" title="Continue" id="change_vehicle_btn" onClick="$('#frm_change_vehicle').submit();">Continue</button>
                      <div class="clearfix"></div>
                    </div>
                  </div>
                </div>
              </div>
            </form>
          </div>
          
          
          <div id="change_pilot_div" class="modal fade change-vehicle-div" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
            <form class="horizontal-form" role="form" id="frm_change_plane" name="frm_change_plane" enctype="multipart/form-data" action="" method="post" onSubmit="return update_plane_details();">
              <input type="hidden" name="current_pilot_leg_id" id="current_pilot_leg_id" value="">
              <input type="hidden" name="open_tab" id="open_tab" value="">
              <input type="hidden" name="update_plane_action" id="update_plane_action" value="update" />
              <div class="modal-dialog">
                <div class="modal-content">
                  <div class="modal-body">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true" title="Close"></button>
                    <div data-always-visible="1" data-rail-visible1="1">
                      <p>Please select the plane which you are going to use for this transportation.</p>
                      <div class="form-group"> <span class="change-vehicle-content">
                        <select id="select_plane" name="select_plane" class="form-control border-none">
                          <option value="">Select Plane</option>
                          <?php
										  	if(!empty($arrPlane)){
                                            foreach($arrPlane as $plane_data)
                                            {
                                            ?>
                          <option  value="<?php echo $plane_data['in_pilot_id'];?>"><?php echo $plane_data['st_plane_type'].' - '.$plane_data['st_plane_number']; ?></option>
                          <?php   
                                           }}
                                        ?>
                        </select>
                        </span> </div>
                      <button type="button" class="btn pink search-btn change_plane_btn" title="Continue" id="change_plane_btn" onClick="$('#frm_change_plane').submit();">Continue</button>
                      <div class="clearfix"></div>
                    </div>
                  </div>
                </div>
              </div>
            </form>
          </div>
          <!-- END PAGE CONTENT--> 
        </div>
      </div>
      <!-- END CONTENT --> 
    </div>
  </div>
  <!-- END CONTAINER --></div>

<!-- BEGIN Edit Transportation Date MODAL POPUP-->
<div class="modal fade" id="portlet-config" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" data-backdrop="static" data-keyboard="false">
  <div class="modal-dialog" id="edit-tranp-date">
    <form class="horizontal-form" role="form" id="edit_date" name="edit_date" enctype="multipart/form-data" action="" method="post">
      <div class="modal-content">
        <div class="modal-header">
          <button aria-hidden="true" data-dismiss="modal" class="close empty_dates" type="button" title="Close" onClick="resetdropdown();"></button>
          <h4 class="modal-title">Edit Transportation Date</h4>
        </div>
        <div class="modal-body">
		<div class="form-group">
						<label class="control-label col-md-12">Select New Transportation Date</label>
					<div class="col-md-12">
					<div class="form-group">
						<div class="input-group input-large date-picker input-daterange" data-date-format="dd-mm-yyyy" data-date-start-date="+0d" data-date-viewmode="years">
						<div class="frm-date">
							<input type="text" class="form-control from from_date w111" placeholder="Pick Up Date" value="<?php echo ($transport_details['dt_pickup_date'] && $transport_details['dt_pickup_date']!="")?date("m/d/Y",strtotime($transport_details['dt_pickup_date'])):"";?>" name="pickup_select" id="pickup_select" readonly>
							<span class="input-group-addon pull-left from from-date-sel" id="datepicker-icon">
                        <i class="material-icons from-date-icon">date_range</i>
                    </span>
							</div>
								<span class="input-group-addon date-to">TO</span>
								<div class="to-date">
								<input type="text" class="form-control to_date w111" placeholder="Drop Off Datet" value="<?php echo ($transport_details['dt_target'] && $transport_details['dt_target']!="")?date("m/d/Y",strtotime($transport_details['dt_target'])):"";?>"  name="dateselect" id="dateselect" readonly>
								<span class="input-group-addon pull-left to to-date-sel" id="datepicker-icon">
                        <i class="material-icons to-date-icon">date_range</i>
                    </span>
                    </div>
						</div>
						</div>
				  </div>
					<span id="date_error" style="display:none; color:#F00">Please select transportation date.</span> </div>
				<div class="clearfix"></div>
        </div>
        <div class="modal-footer no-margin">
          <?php /*?><a class="btn pink-btn" data-dismiss="modal" title="Confirm Date">Confirm Date</a><?php */?>
          <input type="hidden" name="edit_date_action" id="edit_date_action" value="update" />
          <?php /*?><button class="btn pink-btn" title="Confirm Date" type="submit" onClick="return(confirm('Please update legs as per new transportation date.')?true:false)"; name="c_date" id="c_date">Confirm Date</button><?php */?>
          <input type="hidden" name="transportation_status" id="transportation_status" value="<?php echo $transport_details['in_status']; ?>">
          <button class="btn pink-btn" title="Confirm Date" type="submit" onClick="return copy_transport_details($('#transportation_status').val(),$('#dateselect').val(),$('#pickup_select').val())" name="c_date" id="c_date">Confirm Date</button>
        </div>
      </div>
    </form>
    <!-- /.modal-content --> 	
  </div>
  <!-- /.modal-dialog --> 
</div>
<!-- END Edit Transportation Date MODAL POPUP-->

<!-- BEGIN Edit Meeting location MODAL POPUP-->
<div class="modal fade" id="edit_meeting_location" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
 <div class="modal-dialog">
    <form class="horizontal-form" role="form" id="frm_edit_meeting_location" name="frm_edit_meeting_location" enctype="multipart/form-data" action="" method="post">
      <div class="modal-content">
        <div class="modal-header">
          <button aria-hidden="true" data-dismiss="modal" class="close empty_dates" type="button" title="Close"></button>
          <h4 class="modal-title">Edit Meeting Location</h4>
        </div>
        <div class="modal-body">       
        <div class="form-group">
            <label class="control-label col-md-12">Meeting Location:</label>
            <div class="col-md-12">
                <input type="text" id="txt_edit_meeting_location" name="txt_edit_meeting_location" value="" class="form-control" placeholder="Enter your meeting location here..." maxlength="500">
                <input type="hidden" id="txt_edit_leg_id" name="txt_edit_leg_id" value="">   
                <input type="hidden" id="open_tab_info" name="open_tab_info" value="">             
            </div>
            
        </div>
<div class="clearfix"></div>
        </div>
        <div class="modal-footer no-margin">
          <input type="hidden" name="edit_meeting_location_action" id="edit_meeting_location_action" value="update" />
          <button class="btn pink-btn" title="Update" type="submit" name="update_metting_location" id="update_metting_location">Update</button>
        </div>
      </div>
    </form>
    <!-- /.modal-content --> 	
  </div>
  <!-- /.modal-dialog --> 
</div>


<!-- BEGIN Edit Meeting location MODAL POPUP-->
<div class="modal fade" id="edit_comments" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
 <div class="modal-dialog">
    <form class="horizontal-form" role="form" id="frm_edit_comments" name="frm_edit_comments" enctype="multipart/form-data" action="" method="post">
      <div class="modal-content">
        <div class="modal-header">
          <button aria-hidden="true" data-dismiss="modal" class="close empty_dates" type="button" title="Close"></button>
          <h4 class="modal-title">Edit Comments</h4>
        </div>
        <div class="modal-body">       
        <div class="form-group">
            <label class="control-label col-md-12">Comments:</label>
            <div class="col-md-12">
                <input type="text" id="txt_edit_comments" name="txt_edit_comments" value="" class="form-control" placeholder="Enter your comments here..." maxlength="500">
                <input type="hidden" id="txt_edit_comments_leg_id" name="txt_edit_comments_leg_id" value="">   
                <input type="hidden" id="open_tab_comments_info" name="open_tab_comments_info" value="">             
            </div>
            
        </div>
<div class="clearfix"></div>
        </div>
        <div class="modal-footer no-margin">
          <input type="hidden" name="edit_comments_action" id="edit_comments_action" value="update" />
          <button class="btn pink-btn" title="Update" type="submit" name="update_comments" id="update_comments">Update</button>
        </div>
      </div>
    </form>
    <!-- /.modal-content --> 	
  </div>
  <!-- /.modal-dialog --> 
</div>

<!-- BEGIN transport mark completed box MODAL POPUP-->
<div class="modal fade" id="transport_confirm_box" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <form class="horizontal-form" role="form" id="frm_transport_confirm_box" name="frm_transport_confirm_box" enctype="multipart/form-data" action="" method="post">
      <div class="modal-content">
        <div class="modal-header">
          <button aria-hidden="true" data-dismiss="modal" class="close empty_dates" type="button" title="Close"></button>
          <h4 class="modal-title">Alert!</h4>
        </div>
        <div class="modal-body">
          <div class="form-group">
            <label class="control-label col-md-12">We see this transport is in the past. Do you want to mark it completed or edit it to new dates?</label>
            <div class="col-md-12">
              <input type="hidden" id="transport_confirm_box_tid" name="transport_confirm_box_tid" value="<?php echo $transport_details['in_transportation_id']; ?>">
            </div>
          </div>
          <div class="clearfix"></div>
        </div>
        <div class="modal-footer no-margin">
          <input type="hidden" name="transport_confirm_action" id="transport_confirm_action" value="transport_confirm" />
          <a class="btn orange" title="Mark Completed" type="submit" name="update_transport_confirm_box" id="update_transport_confirm_box" onClick="$('#frm_transport_confirm_box').submit();">Mark Completed</a>
          <a class="btn orange" title="Edit Dates" type="submit" name="edit_transport_confirm_box" id="edit_transport_confirm_box" onClick="$('#transport_confirm_box').modal('hide');$('#portlet-config').modal('show');">Edit Dates</a>
          <a class="btn black" title="Cancel" type="submit" name="cancel_transport_confirm_box" id="cancel_transport_confirm_box" onClick="check_transport_type();">Cancel</a>
        </div>
      </div>
    </form>
    <!-- /.modal-content --> 
  </div>
  <!-- /.modal-dialog --> 
</div>


<?php if($this->session->flashdata('google_leg')): ?>
<!-- BEGIN Cancel Transport MODAL POPUP-->
<div class="modal fade" id="cancel-config" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button aria-hidden="true" data-dismiss="modal" class="close" type="button"  title="Close"></button>
        <h4 class="modal-title">THANK YOU</h4>
      </div>
      <div class="modal-body"><?php echo $this->session->flashdata('google_leg'); ?></div>
      <div class="modal-footer text-center no-margin"> <a class="btn blue" data-dismiss="modal" href="javascript:void(0);"  title="Close">Close</a> </div>
    </div>
    <!-- /.modal-content --> 
  </div>
  <!-- /.modal-dialog --> 
</div>
<?php endif; ?>

<?php if($this->session->flashdata('transport_monitor')): ?>
<!-- BEGIN Cancel Transport MODAL POPUP-->
<div class="modal fade" id="cancel-config" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button aria-hidden="true" data-dismiss="modal" class="close" type="button"  title="Close"></button>
        <h4 class="modal-title">THANK YOU</h4>
      </div>
      <div class="modal-body"><?php echo $this->session->flashdata('transport_monitor'); ?></div>
      <div class="modal-footer text-center no-margin"> <a class="btn blue" data-dismiss="modal" href="javascript:void(0);"  title="Close">Close</a> </div>
    </div>
    <!-- /.modal-content --> 
  </div>
  <!-- /.modal-dialog --> 
</div>
<?php endif; ?>

<?php if($this->session->flashdata('unconfirm_msg')): ?>
<!-- BEGIN Cancel Transport MODAL POPUP-->
<div class="modal fade" id="cancel-config" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button aria-hidden="true" data-dismiss="modal" class="close" type="button"  title="Close"></button>
        <h4 class="modal-title">THANK YOU</h4>
      </div>
      <div class="modal-body"><?php echo $this->session->flashdata('unconfirm_msg'); ?></div>
      <div class="modal-footer text-center no-margin"> <a class="btn blue" data-dismiss="modal" href="javascript:void(0);"  title="Close">Close</a> </div>
    </div>
    <!-- /.modal-content --> 
  </div>
  <!-- /.modal-dialog --> 
</div>
<?php endif; ?>

<?php if($this->session->flashdata('transport_monitor_info')): ?>
<!-- BEGIN Cancel Transport MODAL POPUP-->
<div class="modal fade" id="cancel-config" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button aria-hidden="true" data-dismiss="modal" class="close" type="button"  title="Close"></button>
        <h4 class="modal-title">Alert</h4>
      </div>
      <div class="modal-body"><?php echo $this->session->flashdata('transport_monitor_info'); ?></div>
      <div class="modal-footer text-center no-margin"> <a class="btn blue" data-dismiss="modal" href="javascript:void(0);"  title="Close">Close</a> </div>
    </div>
    <!-- /.modal-content --> 
  </div>
  <!-- /.modal-dialog --> 
</div>
<?php endif; ?>

<?php if($this->session->flashdata('change_vehicle_success')): ?>
<!-- BEGIN Cancel Transport MODAL POPUP-->
<div class="modal fade" id="cancel-config" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button aria-hidden="true" data-dismiss="modal" class="close" type="button"  title="Close"></button>
        <h4 class="modal-title">Information</h4>
      </div>
      <div class="modal-body"><?php echo $this->session->flashdata('change_vehicle_success'); ?></div>
      <div class="modal-footer text-center no-margin"> <a class="btn blue" data-dismiss="modal" href="javascript:void(0);"  title="Close">Close</a> </div>
    </div>
    <!-- /.modal-content --> 
  </div>
  <!-- /.modal-dialog --> 
</div>
<?php endif; ?>
<?php if($this->session->flashdata('change_plane_success')): ?>
<!-- BEGIN Cancel Transport MODAL POPUP-->
<div class="modal fade" id="cancel-config" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button aria-hidden="true" data-dismiss="modal" class="close" type="button"  title="Close"></button>
        <h4 class="modal-title">Information</h4>
      </div>
      <div class="modal-body"><?php echo $this->session->flashdata('change_plane_success'); ?></div>
      <div class="modal-footer text-center no-margin"> <a class="btn blue" data-dismiss="modal" href="javascript:void(0);"  title="Close">Close</a> </div>
    </div>
    <!-- /.modal-content --> 
  </div>
  <!-- /.modal-dialog --> 
</div>
<?php endif; ?>

<?php if($this->session->flashdata('change_meeting_location_success')): ?>
<!-- BEGIN Cancel Transport MODAL POPUP-->
<div class="modal fade" id="cancel-config" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button aria-hidden="true" data-dismiss="modal" class="close" type="button"  title="Close"></button>
        <h4 class="modal-title">Information</h4>
      </div>
      <div class="modal-body"><?php echo $this->session->flashdata('change_meeting_location_success'); ?></div>
      <div class="modal-footer text-center no-margin"> <a class="btn blue" data-dismiss="modal" href="javascript:void(0);"  title="Close">Close</a> </div>
    </div>
    <!-- /.modal-content --> 
  </div>
  <!-- /.modal-dialog --> 
</div>
<?php endif; ?>

<?php if($this->session->flashdata('leg_join_error')): ?>
<!-- BEGIN Cancel Transport MODAL POPUP-->
<div class="modal fade" id="cancel-config" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button aria-hidden="true" data-dismiss="modal" class="close" type="button" title="Close"></button>
        <h4 class="modal-title">Alert!</h4>
      </div>
      <div class="modal-body"><?php echo $this->session->flashdata('leg_join_error'); ?></div>
      <div class="modal-footer text-center no-margin"> <a class="btn blue" data-dismiss="modal" href="javascript:void(0);"  title="Close">Close</a> </div>
    </div>
    <!-- /.modal-content --> 
  </div>
  <!-- /.modal-dialog --> 
</div>
<?php endif; ?>

<?php if($this->session->flashdata('success_non_doobert')): ?>
<div class="modal fade" id="cancel-config" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button aria-hidden="true" data-dismiss="modal" class="close" type="button" title="Close"></button>
        <h4 class="modal-title">Information</h4>
      </div>
      <div class="modal-body"><?php echo $this->session->flashdata('success_non_doobert'); ?></div>
      <div class="modal-footer text-center no-margin"><a class="btn blue" data-dismiss="modal" title="Close">Close</a> </div>
    </div>
    <!-- /.modal-content --> 
  </div>
  <!-- /.modal-dialog --> 
</div>
<?php endif; ?>

<?php if($this->session->flashdata('success_doobert_user')): ?>
<!-- BEGIN Cancel Transport MODAL POPUP-->
<div class="modal fade" id="cancel-config" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button aria-hidden="true" data-dismiss="modal" class="close" type="button"  title="Close"></button>
        <h4 class="modal-title">Information</h4>
      </div>
      <div class="modal-body"><?php echo $this->session->flashdata('success_doobert_user'); ?></div>
      <div class="modal-footer text-center no-margin"> <a class="btn blue" data-dismiss="modal" href="javascript:void(0);"  title="Close">Close</a> </div>
    </div>
    <!-- /.modal-content --> 
  </div>
  <!-- /.modal-dialog --> 
</div>
<?php endif; ?>


<!-- BEGIN THANK YOU MODAL POPUP-->
<div class="modal fade" id="success_copy" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header"> 
        <button aria-hidden="true" data-dismiss="modal" class="close" type="button" title="Close"></button>
        <h4 class="modal-title">Information</h4>
      </div>
      <div class="modal-body"><?php echo $this->session->flashdata('success'); ?></div>
      <div class="modal-footer text-center no-margin"><a class="btn blue" data-dismiss="modal" title="Close">Close</a> </div>
    </div>
    <!-- /.modal-content --> 
  </div>
  <!-- /.modal-dialog --> 
</div>
<!-- END THANK YOU MODAL POPUP-->

<div id="responsive">
<div class="modal fade" id="driverleginfo" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button aria-hidden="true" data-dismiss="modal" class="close" type="button"  title="Close"></button>
      </div>
      <div class="modal-body">
      <div class="scroller scroller-info" data-always-visible="1" data-rail-visible1="1">
        <p>This transport is a type of transport request where YOU as a driver can draw the portion of the route that you’re able to drive. Click the VIEW MAP button to display the map, and then left click on your starting point on the map, and move your mouse towards your end point and click again. You will notice that the system color-codes the portion you drew so other drivers know what portion you can drive. Now simply enter the times in the fields above the map and SAVE your leg. A few additional tips:</p>
            <ul>
              <li>You can use the Google + / - to zoom in further to see your route and draw more accurately the portion you are able to cover.</li>
              <li>If you need to re-draw your leg because it is wrong or something changed, you need to first save the leg (enter the times above and SAVE) and then EXIT from the route. This will then allow you to re-draw it.</li>
              <li>If you have ANY problems, please contact us and we’re glad to assist you.</li>
            </ul>
      </div>
      </div>
      <div class="modal-footer text-center no-margin"><a class="btn blue" data-dismiss="modal" href="javascript:void(0);" title="Close">Close</a> </div>
    </div>
    <!-- /.modal-content --> 
  </div>
  <!-- /.modal-dialog --> 
</div>

<div class="modal fade" id="pilotleginfo" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button aria-hidden="true" data-dismiss="modal" class="close" type="button"  title="Close"></button>
      </div>
      <div class="modal-body">
      <div class="scroller scroller-info" data-always-visible="1" data-rail-visible1="1">
        <p>This transport is setup so that you can draw the portion of the route you are able to fly.   You can either zoom in on the map and click the starting airport, and then click the ending airport, or type the airport identifiers in the fields above. A few additional tips:</p>
        <ul>
          <li>You can use the Google + / - or your mouse to zoom in on the map to select the starting and ending airports depicting the distance you're able to fly.</li>
          <li>If you need to re-draw your leg because you selected the wrong airport, simply LEAVE the transport and re-JOIN it and you can re-draw your leg. </li>
          <li>If you have ANY problems please contact us via the Help/Feedback tab and we're glad to assist.</li>
        </ul>
      </div>
      </div>
      <div class="modal-footer text-center no-margin"><a class="btn blue" data-dismiss="modal" href="javascript:void(0);" title="Close">Close</a> </div>
    </div>
    <!-- /.modal-content --> 
  </div>
  <!-- /.modal-dialog --> 
</div>

<div id="responsive">
  <div class="modal fade" id="driverleginfo" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <button aria-hidden="true" data-dismiss="modal" class="close" type="button"  title="Close"></button>
        </div>
        <div class="modal-body">
          <div class="scroller scroller-info1" data-always-visible="1" data-rail-visible1="1">
            <p>This transport is a type of transport request where YOU as a driver can draw the portion of the route that you’re able to drive. Click the VIEW MAP button to display the map, and then left click on your starting point on the map, and move your mouse towards your end point and click again. You will notice that the system color-codes the portion you drew so other drivers know what portion you can drive. Now simply enter the times in the fields above the map and SAVE your leg. A few additional tips:</p>
            <ul>
              <li>You can use the Google + / - to zoom in further to see your route and draw more accurately the portion you are able to cover.</li>
              <li>If you need to re-draw your leg because it is wrong or something changed, you need to first save the leg (enter the times above and SAVE) and then EXIT from the route. This will then allow you to re-draw it.</li>
              <li>If you have ANY problems, please contact us and we’re glad to assist you.</li>
            </ul>
          </div>
        </div>
        <div class="modal-footer text-center no-margin"><a class="btn blue" data-dismiss="modal" href="javascript:void(0);" title="Close">Close</a> </div>
      </div>
      <!-- /.modal-content --> 
    </div>
    <!-- /.modal-dialog --> 
  </div>
  <div class="modal fade" id="pilotleginfo" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <button aria-hidden="true" data-dismiss="modal" class="close" type="button"  title="Close"></button>
        </div>
        <div class="modal-body">
          <div class="scroller scroller-info1" data-always-visible="1" data-rail-visible1="1">
            <p>This transport is setup so that you can draw the portion of the route you are able to fly.   You can either zoom in on the map and click the starting airport, and then click the ending airport, or type the airport identifiers in the fields above. A few additional tips:</p>
            <ul>
              <li>You can use the Google + / - or your mouse to zoom in on the map to select the starting and ending airports depicting the distance you're able to fly.</li>
              <li>If you need to re-draw your leg because you selected the wrong airport, simply LEAVE the transport and re-JOIN it and you can re-draw your leg. </li>
              <li>If you have ANY problems please contact us via the Help/Feedback tab and we're glad to assist.</li>
            </ul>
          </div>
        </div>
        <div class="modal-footer text-center no-margin"><a class="btn blue" data-dismiss="modal" href="javascript:void(0);" title="Close">Close</a> </div>
      </div>
      <!-- /.modal-content --> 
    </div>
    <!-- /.modal-dialog --> 
  </div>
</div>
<!-- END Cancel Transport MODAL POPUP-->


<!-- BEGIN THANK YOU MODAL POPUP-->
<div class="modal fade" id="aviation_popup" tabindex="-1" role="basic" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog"><!--org-search-lg-alert-->
    <div class="modal-content "><!--org-search-alert-->
      <div class="modal-header">
        <button aria-hidden="true" data-dismiss="modal" class="close" type="button"  title="Close"></button>
  		<h4 class="title">Add Leg for</h4>
      </div>
    <form class="horizontal-form" role="form" id="route_radio" name="route_radio" enctype="multipart/form-data" action="" method="post" >
          <div class="modal-body">
    
    
    <input type="hidden" value="submit" name="route_action" id="route_action"/>
          <div class="form-group">
                <div class="radio-list">    
                    <label class="radio-inline" for="road_transport">
                    <input type="radio" name="transport_type" id="road_transport" class="chk" value="0" checked> Road Transportation</label>
                    <label class="radio-inline" for="aviation_transport">
                    <input type="radio" name="transport_type" id="aviation_transport" class="chk" value="1"  > Aviation Transportation</label>
                </div>
                </div>
    
    </div>
          <div class="modal-footer no-border"> <button title="Continue" type="submit" class="btn orange dobt-btn" id="transport_submit" name="transport_submit" aria-hidden="true">Continue</button></div>
    </form>
    </div>
    <!-- /.modal-content --> 
  </div>
  <!-- /.modal-dialog --> 
</div>
<!-- END THANK YOU MODAL POPUP-->

<!-- BEGIN THANK YOU MODAL POPUP-->
<div class="modal fade" id="profile_popup" tabindex="-1" role="basic" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog"><!--org-search-lg-alert-->
    <div class="modal-content "><!--org-search-alert-->
      <div class="modal-header">
        <button aria-hidden="true" data-dismiss="modal" class="close" type="button"  title="Close"></button>
        <h4 class="title">View Legs As:</h4>
      </div>
      <form class="horizontal-form" role="form" id="profile_route_radio" name="profile_route_radio" enctype="multipart/form-data" action="" method="post" >
        <div class="modal-body">
          <input type="hidden" value="submit" name="profile_route_action" id="profile_route_action"/>
          <div class="form-group">
            <div class="radio-list">
              <label class="radio-inline" for="profile_type_d">
                <input type="radio" name="profile_type" id="profile_type_d" class="chk" value="0" checked>
                Driver</label>
              <label class="radio-inline" for="profile_type_p">
                <input type="radio" name="profile_type" id="profile_type_p" class="chk" value="1" >
                Pilot</label>
            </div>
          </div>
        </div>
        <div class="modal-footer no-border">
          <button title="Continue" type="submit" class="btn orange dobt-btn" id="profile_transport_submit" name="profile_transport_submit" aria-hidden="true">Continue</button>
        </div>
      </form>
    </div>
    <!-- /.modal-content --> 
  </div>
  <!-- /.modal-dialog --> 
</div>
<!-- END THANK YOU MODAL POPUP-->

 <form class="horizontal-form" role="form" id="mark_complete" name="mark_complete" enctype="multipart/form-data" action="" method="post" >
 <input type="hidden" value="submit" name="mark_leg_completed" id="mark_leg_completed"/>
 <input type="hidden" value="" name="leg_completed_id" id="leg_completed_id"/>
 </form>
 
<form id="frm_del_non_doobert_user" name="frm_del_non_doobert_user" action="<?php echo base_url(); ?>org_transportation/delete_non_doobert_user_leg" method="post"> 
 <input type="hidden" id="non_doobert_id" name="non_doobert_id" value=""> 
</form>

 
 <!-- Transport Created Successfully MODAL POPUP-->
<div class="modal fade transport-created" id="transport-created-successfully" tabindex="-1" role="basic" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" title="Close" aria-hidden="true"></button>
                <h4 class="modal-title">THANK YOU</h4>
            </div>
            <div class="modal-body">
            <p>Congratulations.  Your transport has been created and we're notifying the Drivers & Pilots along the route.</p>
            </div>
            <div class="modal-footer text-center no-margin"> 
          	<button class="btn blue" data-dismiss="modal" title="OK" type="button">OK</button>
          </div>
        </div>
        <!-- /.modal-content -->
    </div>
    <!-- /.modal-dialog -->
</div>
<!-- END Transport Created Successfully MODAL POPUP-->


<!-- Transport confirmation MODAL POPUP-->
<div class="modal fade transport-confirmation" id="transport-confirmation" tabindex="-1" role="basic" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" title="Close" aria-hidden="true"></button>
                <h4 class="modal-title">INFORMATION</h4>
            </div>
            <div class="modal-body">
            <p>When you confirm the transport you are locking in the legs and the system will automatically e-mail the volunteers that the transport is a go, and will unlock the run sheet so everyone in the transport can see the full run sheet.  Are you sure you want to confirm the transport?</p>
            </div>
            <div class="modal-footer text-center no-margin"> 
          	<button class="btn light-green" title="Confirm" type="button" id="modal_confirm_transport">Confirm</button>
            <button class="btn default" data-dismiss="modal" title="Cancel" type="button">Cancel</button>
          </div>
        </div>
        <!-- /.modal-content -->
    </div>
    <!-- /.modal-dialog -->
</div>
<!-- END Transport confirmation MODAL POPUP-->

<!-- Contact US Form -->
  <div class="modal fade" id="map-user-contact" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" data-backdrop="static" data-keyboard="false">
                    <div class="modal-dialog">
                        <form class="horizontal-form" role="form" id="send-request" name="send_request" action="" method="post">
                            <input type="hidden" id="contact_name" name="contact_name" value="">
                            <input type="hidden" id="contact_email" name="contact_email" value="">
							<input type="hidden" id="org_id" name="org_id" value="">
							<input id="user-name" name="user-name" type="hidden" value="<?php echo $this->session->userdata('user_name')." ".$this->session->userdata('last_name');  ?>" />
							<input id="user-email" name="user-email" type="hidden" value="<?php echo $this->session->userdata('email'); ?>" />
                            <div class="modal-content">
                                <div class="modal-header">
                                    <button aria-hidden="true" data-dismiss="modal" class="close empty_dates" type="button" title="Close"></button>
                                    <h4 class="modal-title">Contact Request</h4>
                                </div>							
                                <div class="modal-body">
                                  
                                    <div class="form-group col-md-12 padl0 padr0">
                                       <textarea id="contactmessage" name="contactmessage" rows="3" class="form-control" maxlenght="500" Placeholder="Enter Your Message" ></textarea>
                                    </div>
                                    <div class="form-group col-md-12 padl0 padr0 btm-button marb0">
                                            <a href="javascript:void(0);" class="btn orange fr" id="send_request_btn" title="Send">Send</a>
                                           <!-- <input type="submit" class="btn orange mart20 fr wht"  id="send_request_btn" value="Send">-->
                                    </div>
                                    <div class="clearfix"></div>
                                </div>
                            </div>
                        </form>
                        <!-- /.modal-content --> 
                        </div>
                    </div>

<!-- End Contact Us Form --> 

	<!-- Start Thank You Message -->
					 <div class="modal fade" id="thankyou-config" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header"> 
                            <button aria-hidden="true" data-dismiss="modal" class="close" type="button"></button>
                            <h4 class="modal-title">THANK YOU</h4>
                        </div>
                        <div class="modal-body"><h5>Your contact request was sent successfully.</h5></div>
                        <div class="modal-footer text-center no-margin"><a class="btn blue" data-dismiss="modal" title="Close">Close</a> </div>
                    </div>
                    <!-- /.modal-content --> 
                </div>
                <!-- /.modal-dialog --> 
            </div>
			<!-- End Thank you Message -->


<!-- Transport Created Successfully MODAL POPUP-->

<!--start leg_reorder Successfully MODAL POPUP-->
<div class="modal fade transport-created" id="leg_reorder_loader" tabindex="-1" role="basic" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <?php /*?><div class="modal-header no-border">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true"></button>
            </div><?php */?>
            <div class="modal-body">
            
            <img src="<?php echo base_url(); ?>assets/img/ajax-loading.gif" width="32" height="32" align="absmiddle" style="margin:0 auto">&nbsp;<span id="tran-loadertext">Please be patient while we re-order the legs. This could take up to 20 seconds...</span>
            </div>
        </div>
        <!-- /.modal-content -->
    </div>
    <!-- /.modal-dialog -->
</div>
<!-- END leg_reorder Successfully MODAL POPUP-->

<div class="modal fade" id="assign-nondoobert-user" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" data-backdrop="static" data-keyboard="false">
  <div class="modal-dialog">
    <form class="horizontal-form" role="form" id="non_doobert_user_frm" name="non_doobert_user_frm" enctype="multipart/form-data" action="<?php echo base_url() ?>org_transportation/non_doobert_transport_user" method="post">
      <div class="modal-content">
        <div class="modal-header">
          <button aria-hidden="true" id="close_non_doobert_user_form" data-dismiss="modal" class="close" type="button" title="Close"></button>
          <h4 class="modal-title non-doobert_leg_srno">Assign Leg-1 to Non-Doobert User <span class="req-field">(<span>*</span> required field)</span></h4>
        </div>
        <div class="modal-body">
             <div class="non-user-info">
             <div class="form-group col-md-4 padl0 user100p">
             <label for="non_doobert_user_name" class="control-label">Name: <span class="required-filed">*</span></label>
             <input type="text" id="non_doobert_user_name" name="non_doobert_user_name" class="form-control" maxlength="500"> 
             </div>
			  <div class="form-group col-md-4 user100p">
             <label for="non_doobert_user_email" class="control-label">E-Mail: <span class="required-filed">*</span></label>
             <input type="text" id="non_doobert_user_email" name="non_doobert_user_email" class="form-control"  maxlength="255"> 
             </div>
             <div class="form-group col-md-4 user100p">
             <label for="non_doobert_user_phone" class="control-label">Phone: <?php /*<span class="required-filed">*</span>*/ ?></label>
             <input type="text" id="non_doobert_user_phone" name="non_doobert_user_phone" class="form-control" maxlength="15"> 
             </div>
             <div class="form-group col-md-4 padl0 user100p">
             <label for="non_doobert_user_vehicle_zipcode" class="control-label">Zipcode: <?php /*<span class="required-filed">*</span>*/ ?></label>
             <input type="text" id="non_doobert_user_vehicle_zipcode" name="non_doobert_user_vehicle_zipcode" class="form-control" maxlength="10"> 
             </div>
             </div>
             <h3>Vehicle Info</h3>
             <div class="vehicle-info">
             <div class="form-group col-md-4 padl0 user100p">
             <label for="non_doobert_user_vehicle_type" class="control-label">Vehicle Type: <?php /*<span class="required-filed">*</span>*/ ?></label>
             <input type="text" id="non_doobert_user_vehicle_type" name="non_doobert_user_vehicle_type" class="form-control"  maxlength="500"> 
             </div>
             <div class="form-group col-md-4 user100p">
             <label for="non_doobert_user_vehicle_color" class="control-label">Color:</label>
             <input type="text" id="non_doobert_user_vehicle_color" name="non_doobert_user_vehicle_color" class="form-control" maxlength="50"> 
             </div>
             <div class="form-group col-md-4 user100p">
             <label for="non_doobert_user_vehicle_license_plate" class="control-label">License Plate:</label>
             <input type="text" id="non_doobert_user_vehicle_license_plate" name="non_doobert_user_vehicle_license_plate" class="form-control" maxlength="50"> 
             </div>
             <div class="form-group col-md-4 padl0 user100p">
             <label for="non_doobert_user_vehicle_license_state" class="control-label">License State:</label>
             <input type="text" id="non_doobert_user_vehicle_license_state" name="non_doobert_user_vehicle_license_state" class="form-control" maxlength="50"> 
             </div>
             <div class="col-md-8 user100p">             
             <input type="hidden" id="non_doobert_user_transport_id" name="non_doobert_user_transport_id" value=""> 
             <input type="hidden" id="non_doobert_user_transport_leg_id" name="non_doobert_user_transport_leg_id" value="">
             <input type="hidden" id="non_doobert_user_assign_and_invite" name="non_doobert_user_assign_and_invite" value="0"> 
             
             <button id="non_doobert_assign_leg" type="submit" title="Assign Leg" class="btn orange dobt-btn cancel fl cancel_leg mart29">Assign Leg</button>
             <button id="non_doobert_assign_leg_invite" type="submit" title="Assign Leg &amp; Invite User" class="btn pink-btn fl cancel_leg">Assign Leg &amp; Invite User</button>
             <button id="non_doobert_cancel" title="Cancel" class="btn gray-btn dobt-btn cancel fl cancel_leg mart29" data-dismiss="modal">Cancel</button>
             </div>
             </div>
          <div class="clearfix"></div>
        </div>        
      </div>
       <input type="hidden" name="frm_non_doobert_action" id="frm_non_doobert_action" value="submit" />
    </form>
    <!-- /.modal-content --> 
  </div>
  <!-- /.modal-dialog --> 
</div>
 
<div class="modal fade" id="match_doobert_user_popup" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" data-backdrop="static" data-keyboard="false">
  <div class="modal-dialog">
    <form class="horizontal-form" role="form" id="non_doobert_match_user_frm" name="non_doobert_match_user_frm" enctype="multipart/form-data" action="<?php echo base_url() ?>org_transportation/non_doobert_match_user" method="post">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" title="Close" aria-hidden="true"></button>
        <h4 class="modal-title">INFORMATION</h4>
      </div>
      <div class="modal-body">
        <p>The email address <span id="match_doobert_user_popup_email_add"></span> is associated with a registered user <span id="match_doobert_user_popup_email_name"></span>.  Would you still like to add them to this transport?</p>
      </div>
      <div class="modal-footer text-center no-margin">
        <button class="btn light-green" title="Confirm" type="button" id="modal_confirm_match_user">Confirm</button>
        <button class="btn default" data-dismiss="modal" title="Cancel" type="button">Cancel</button>
      </div>
    </div>
    <!-- /.modal-content --> 
       <input type="hidden" name="matched_doobert_user_id" id="matched_doobert_user_id" value="" />
       <input type="hidden" name="matched_doobert_user_email" id="matched_doobert_user_email" value="" />
       <input type="hidden" name="matched_doobert_user_name" id="matched_doobert_user_name" value="" />
       <input type="hidden" name="matched_doobert_transport_id" id="matched_doobert_transport_id" value="" />
       <input type="hidden" name="matched_doobert_leg_id" id="matched_doobert_leg_id" value="" />
       <input type="hidden" name="frm_non_doobert_match_user_action" id="frm_non_doobert_match_user_action" value="submit" />
    </form>
    <!-- /.modal-content --> 
  </div>
  <!-- /.modal-dialog --> 
</div>

<div class="modal fade" id="noneuser_match_doobert_user_popup" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" data-backdrop="static" data-keyboard="false">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" title="Close" aria-hidden="true"></button>
        <h4 class="modal-title">INFORMATION</h4>
      </div>
      <div class="modal-body">
		  <p>The email address <span id="match_doobert_user_popup_email_add"></span> is a registered doobert user and phone number has not been provided.Please contact user for updating phone number before participating in the transportation.</p>
      </div>
      <div class="modal-footer text-center no-margin">
        <!--<button class="btn light-green" title="Confirm" type="button" id="modal_confirm_match_user">Confirm</button>-->
        <button class="btn default" data-dismiss="modal" title="Close" type="button">Close</button>
      </div>
    </div>
    <!-- /.modal-content --> 
  </div>
  <!-- /.modal-dialog --> 
</div>

<a href="#" class="crunchify-top" id="crunchify-top" title="Top">↑Top</a>

<div id="responsive">
<div class="modal fade" id="driver-specify-legs" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" data-backdrop="static" data-keyboard="false">
  <div class="modal-dialog gallery">
    <?php $video_details = $this->common_function->get_demo_video_link_by_id('1'); 	?>
      <div class="modal-content">
        <div class="modal-header">
          <button aria-hidden="true" data-dismiss="modal" class="close empty_dates" type="button" title="Close"></button>
          <h4 class="modal-title"><?php echo $video_details['st_title']; ?></h4>
        </div>
        <div class="modal-body">
          <div class="form-group">
          <div class="col-md-12 ">
             <?php echo $video_details['st_description']; ?>
             </div>
             <div class="col-md-12 btm-button">             
             <a onClick="$('#driver-specify-legs').modal('hide');" href="<?php echo isset($video_details['st_url'])?$video_details['st_url']:''; ?>&rel=0&showinfo=0" rel="prettyPhoto" class="btn pink-dark mart20 marr5" title="View demo video">View demo video</a>
             <a href="javascript:void(0)" onClick="disable_demo_video_popup();" data-dismiss="modal" class="btn light-green mart20" title="Don't show this message again">Don't show this message again</a>
             </div>
            </div>
          <div class="clearfix"></div>
        </div>
        
      </div>
    <!-- /.modal-content --> 
  </div>
  <!-- /.modal-dialog --> 
</div>
</div>


<!-- BEGIN thanku-suggest-leg MODAL POPUP-->
<div class="modal fade" id="thanku-suggest-leg" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header"> 
        <button aria-hidden="true" data-dismiss="modal" class="close" type="button"></button>
        <h4 class="modal-title">Thank you for suggesting a leg!</h4>
      </div>
      <div class="modal-body">We've notified the transport coordinator and if they choose your suggestion they will modify the transport legs accordingly.</div>
      <div class="modal-footer text-center no-margin">
		<button class="btn blue" data-dismiss="modal" title="OK" type="button">OK</button> 
	  </div>
    </div>
    <!-- /.modal-content --> 
  </div>
  <!-- /.modal-dialog --> 
</div>
<!-- END thanku-suggest-legMODAL POPUP-->

<!--  Add cancelled reason  Form -->
  <div class="modal fade" id="cancel-transport-description" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" data-backdrop="static" data-keyboard="false">
                    <div class="modal-dialog">
                        <form class="horizontal-form" role="form" id="send-cancel-request" name="send-cancel-request" action="" method="post">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <button aria-hidden="true" data-dismiss="modal" id="close_cancel_desc"  class="close empty_dates" type="button" title="Close"></button>
                                    <h4 class="modal-title">Cancelled Transportation Description</h4>
                                </div>							
                                <div class="modal-body">
								 <label>Please explain to the volunteers why this transport was cancelled.  We will forward your message in the cancellation notice to them and direct them to you if they have questions: <span class="required-filed">*</span></label>
                                    <div class="form-group col-md-12 padl0 padr0">
                                       <textarea id="cancelmessage" name="cancelmessage" rows="3" class="form-control" maxlength="500" Placeholder="Enter Your Message" ></textarea>
                                    </div>
                                    <div class="form-group col-md-12 padl0 padr0 btm-button marb0">
                                            <a href="javascript:void(0);" class="btn orange fr" id="reason-cancel-transport" title="Send">Send</a>
                                           <!-- <input type="submit" class="btn orange mart20 fr wht"  id="send_request_btn" value="Send">-->
                                    </div>
                                    <div class="clearfix"></div>
                                </div>
                            </div>
                        </form>
                        <!-- /.modal-content --> 
                        </div>
                    </div>

<!-- End  Add cancelled reason  Form -->

<!--  Add Phone Number Form -->
<?php if($profile_info['st_primary_phone']=='' && $transport_details['st_trans_type']=='P' ) {  ?>
  <div class="modal fade" id="phone-number" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" data-backdrop="static" data-keyboard="false">
                    <div class="modal-dialog">
					<form class="horizontal-form" role="form" id="legs_select1" name="legs_select"  enctype="multipart/form-data" action="" method="post">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <button aria-hidden="true" data-dismiss="modal" id="close_cancel_phone"  class="close empty_dates" type="button" title="Close"></button>
                                    <h4 class="modal-title">Contact Detail</h4>
                                </div>							
                                <div class="modal-body">
									<input  type="hidden" value="" name="action" id="actions" />
									<input  type="hidden" value="" name="cancel_leg_id" id="cancel_leg_ids" />
								 <label>Please Enter Phone Number <span class="required-filed">*</span></label>
                                    <div class="form-group col-md-12 padl0 padr0">
                                       <input type='text' id="phone_number" name="phone_number"  class="form-control" maxlength="50" Placeholder="Enter Phone Number" />
                                    </div>
                                    <div class="form-group col-md-12 padl0 padr0 btm-button marb0">
                                            <a href="javascript:void(0);" class="btn orange fr" id="insert_phone_number" title="Submit">Submit</a>
                                           <!-- <input type="submit" class="btn orange mart20 fr wht"  id="send_request_btn" value="Send">-->
                                    </div>
                                    <div class="clearfix"></div>
                                </div>
                            </div>
                        </form>
                        <!-- /.modal-content --> 
                        </div>
                    </div>
					<?php } ?>
	
<?php if($profile_info['st_primary_phone']=='' && $transport_details['st_trans_type']=='D' ) {  ?>
  <div class="modal fade" id="phone-number-driver" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" data-backdrop="static" data-keyboard="false">
                    <div class="modal-dialog">
					<!--<form class="horizontal-form" role="form" id="legs_select1" name="legs_select" enctype="multipart/form-data" action="" method="post">-->
                            <div class="modal-content">
                                <div class="modal-header">
                                    <button aria-hidden="true" data-dismiss="modal" id="close_cancel_phone_driver"  class="close empty_dates" type="button" title="Close"></button>
                                    <h4 class="modal-title">Contact Detail</h4>
                                </div>							
                                <div class="modal-body">
									<input  type="hidden" value="" name="profile_type" id="profile_type" />
								 <label>Please Enter Phone Number <span class="required-filed">*</span></label>
                                    <div class="form-group col-md-12 padl0 padr0">
                                       <input type='text' id="phone_number_driver" name="phone_number_driver"  class="form-control" maxlength="50" Placeholder="Enter Phone Number" />
                                    </div>
                                    <div class="form-group col-md-12 padl0 padr0 btm-button marb0">
                                           <a href="javascript:void(0);" class="btn orange fr" id="insert_phone_number_driver" title="Submit">Submit</a>
										   <!--<div  class="fl" id="can-save"><a rel="nofollow" href="'.<?php //echo base_url(); ?>.'org-transportation-scheduled/'.<?php echo $transport_details['in_transportation_id'];?>.'/" data-method="post" class="button btn pink-btn" title="Send to TC">Send to TC <i class="fa fa-angle-right"></i></a></div>-->
                                           <!-- <input type="submit" class="btn orange mart20 fr wht"  id="send_request_btn" value="Send">-->
                                    </div>
                                    <div class="clearfix"></div>
                                </div>
                            </div>
                       <!-- </form>-->
                        <!-- /.modal-content --> 
                        </div>
                    </div>
					<?php } ?>	

<!-- End  Add Phone Number  Form -->
<div class="modal fade transport-created" id="transport_loader" tabindex="-1" role="basic" aria-hidden="true">
								<div class="modal-dialog">
									<div class="modal-content">
										<?php /*?><div class="modal-header no-border">
											<button type="button" class="close" data-dismiss="modal" aria-hidden="true"></button>
										</div><?php */?>
										<div class="modal-body">
                                        
										<img src="<?php echo base_url(); ?>assets/img/ajax-loading.gif" width="32" height="32" align="absmiddle" style="margin:0 auto; text-align: center;">&nbsp;<span id="tran-loadertext">Doobert is cancelling the transportation</span>
										</div>
									</div>
									<!-- /.modal-content -->
								</div>
								<!-- /.modal-dialog -->
							</div>



<!-- BEGIN success_transport_info_popup MODAL POPUP-->
<div class="modal fade" id="success_transport_info_popup" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header"> 
        <button aria-hidden="true" data-dismiss="modal" class="close" type="button"></button>
        <h4 class="modal-title">Information!</h4>
      </div>
      <div class="modal-body">Additional Information updated successfully.
	  </div>
	  <div class="modal-footer text-center no-margin"> <a class="btn blue" data-dismiss="modal" href="javascript:void(0);"  title="Close">Close</a> </div>
	 </div>
    </div>
    <!-- /.modal-content --> 
  </div>
  <!-- /.modal-dialog --> 
</div>
<!-- END success_transport_info_popup MODAL POPUP-->

<div class="modal fade bs-modal-lg in" id="email-config" tabindex="-1" role="basic" aria-labelledby="myModalLabel" aria-hidden="true">
                            <form class="horizontal-form" role="form" name="tell_a_friend" id="tell_a_friend" action="<?php echo base_url() ?>transportation/tell_a_friend" method="post">
                              <div class="modal-dialog">
                                <div class="modal-content">
                                	<input type="hidden" id="share_transport_id" name="share_transport_id" value="">
                                    
                                    <div class="modal-header">
                                        <button aria-hidden="true" data-dismiss="modal" class="close" type="button"></button>
                                        <h4 class="modal-title">Send Email</h4>
                                    </div>
                            
                                  <div class="modal-body">
                                   <p align="right"><span class="required-filed">*</span> required fields.</p>
                                   
                                    <div class="form-group "><label class="control-label" for="txttoname">To Name: <span class="required-filed">*</span></label><input type="text" class="form-control" id="txttoname" name="txttoname"></div>
                                    
                            <div class="form-group "><label class="control-label" for="txtemail">To Email: <span class="required-filed">*</span></label><input type="text" class="form-control" id="txtemail" name="txtemail"></div>
                            
                           <?php /*?> <div class="form-group "><label class="control-label" for="txtfrom">From <span class="required-filed">*</span></label><input type="text" class="form-control" id="txtfrom" name="txtfrom" value="<?php echo $this->session->userdata('user_name').' '.$this->session->userdata('last_name'); ?>"></div><?php */?>
                           <input type="hidden" class="form-control" id="txtfrom" name="txtfrom" value="<?php echo $this->session->userdata('user_name').' '.$this->session->userdata('last_name'); ?>">
                            
                            <?php /*?><div class="form-group ">
                            <label class="control-label" for="txtsubject">Subject <span class="required-filed">*</span></label>
                            <input type="text" class="form-control" id="txtsubject" name="txtsubject" value="">
                            </div><?php */?>
                            
                            <input type="hidden" class="form-control" id="txtsubject" name="txtsubject" value="">
                            
                            <div class="form-group no-margin"><label class="control-label " for="txtMessage">Message <span class="required-filed">*</span></label><textarea id="txtMessage" name="txtMessage" class="form-control" rows="10"></textarea></div>
                            <input type="hidden" name="frm_action" id="frm_action" value="submit" />
                                  </div>
                                  <div class="modal-footer no-margin no-border no-top-space"><button aria-hidden="true" name="send_mail" id="send_mail" class="btn green" type="submit" title="Send Email">Send Email</button>
                                  <span class="display_loader" style="display:none;"> <img id="loadimg_mail" src="<?php echo base_url(); ?>assets/img/ajax-loading.gif" alt="loader" /> </span>
                                  </div>
                                </div>
                                <!-- /.modal-content --> 
                              </div>
                              <!-- /.modal-dialog --> 
                              </form>
                            </div> 
 
<?PHP include APPPATH."views/includes/footer.php" ?>


<!--Being Page Lavel CSS-->
<link rel="stylesheet" href="<?php echo base_url(); ?>assets/css/prettyPhoto/prettyPhoto.css" type="text/css" media="screen" title="prettyPhoto main stylesheet" charset="utf-8" />
<!--End Page Lavel CSS-->

<script src="<?php echo base_url(); ?>assets/plugins/prettyPhoto/jquery.prettyPhoto.js?version=27112015" type="text/javascript" charset="utf-8"></script>

<script src="<?php echo base_url(); ?>assets/scripts/tipso.js" type="text/javascript" charset="utf-8"></script> 

<script type="text/javascript">
//Start media Gallery 
$(document).ready(function(){
	
jQuery('.title-tipso').tipso();

$("area[rel^='prettyPhoto']").prettyPhoto();
<?php
if(isset($gallery) && !empty($gallery))
{
	foreach($gallery as $key)
	{
	?>	
	$("#<?php echo $key;?>:first a[rel^='prettyPhoto']").prettyPhoto({animation_speed:'normal',theme:'light_square',slideshow:3000, autoplay_slideshow: false});
	$("#<?php echo $key;?>:gt(0) a[rel^='prettyPhoto']").prettyPhoto({animation_speed:'fast',slideshow:10000, hideflash: true});
	<?php	
	}										
}
?>			
});
//End media Gallery 
</script>

<script type="text/javascript">
$(document).ready(function(){

$('#send_request_btn').live('click',function(){
					var mess='';
					mess = $('#contactmessage').val(); 
					var username = $("#user-name").val();
					var useremail = $("#user-email").val();
					var org_id = $("#org_id").val();
					//var validatemail= 	validateEmail(useremail);
					//alert(validatemail);	
					//alert(mess);		
                    //if(mess == '' || name == '' || email == '')
					if(mess == '')
                    {
						alert('Please complete your information.');
						//alert('Please complete the form details.');
						//$.modal.close();
                        return false;
                    }else
                    {
					var name  = $('#contact_name').val();
                    var email = $('#contact_email').val();
					
						 $.ajax({
								type: "POST",
								url: '<?php echo base_url(); ?>rescue_map/map_send_mail',
								beforeSend: function(){
								$('#map-user-contact').modal('toggle');	
								//$.modal.close();
								//$('#user-contact').hide();
								//$.modal.close();
								$('#loader').show();
								},
								data: {contact_name:name , contact_email:email ,contactmessage:mess , username:username , useremail:useremail , org_id:org_id},
			 // data : { },
								dataType:'json',
			  					complete: function(){
								$('#loader').hide();
				    			},
								  success:function(data){
									if(data.success == 1)
										$('.modal-title').html('Thank You')	
										$('#contactmessage').val('');
										$('#contact_name').val('');	
										$('#contact_email').val('');
										//$("#user-name").val('');
										//$("#user-email").val('');
										$("#org_id").val('');
										$('#thankyou-config').modal('show');
								}, 
                        //return true;
						 });
                    }
		}); //send_request_btn2	

	
$('#select-action').val('0');
<?php
  if(isset($leg_details) && !empty($leg_details))
  {
	$i=1;	
	foreach($leg_details as $key=>$value)
	{
	?>
	if( !$.trim( $('#slider1_<?php echo $value['leg_id'] ;?>').html() ).length ) {
				$('#slider1_<?php echo $value['leg_id'] ;?>').parent('div').remove();
				}
	
	var divs<?php echo $value['leg_id'];?> = $('.slider-<?php echo $value['leg_id'];?> > div');
    var now = 0; // currently shown div
    //console.log(divs<?php echo $value['leg_id'];?>);
    divs<?php echo $value['leg_id'];?>.hide().first().show(); // hide all divs except first
    $(".nex-<?php echo $value['leg_id'];?>").live('click',function(){
		divs<?php echo $value['leg_id'];?>.eq(now).hide();		
        now = (now + 1 < divs<?php echo $value['leg_id'];?>.length) ? now + 1 : 0;
		divs<?php echo $value['leg_id'];?>.eq(now).show(); // show next
    });
    $(".pre-<?php echo $value['leg_id'] ;?>").live('click',function(){
		divs<?php echo $value['leg_id'];?>.eq(now).hide();
        now = (now > 0) ? now - 1 : divs<?php echo $value['leg_id'];?>.length - 1;
        divs<?php echo $value['leg_id'];?>.eq(now).show(); // show previous
    });
				
<?php } } ?>


$(".filled-text").parent().parent().addClass('filled-box');

});
</script>
<script>
function funPreview(){
  
$('.preview').popover({'trigger':'hover','html':true,'animation':false});

/*
$( ".info-icons a" ).hover(
  function() {
  $('.popover').addClass($(this).data("class"));
  //if( $('.popover .popover-content').is(':empty') ) {
//  $('.popover .popover-content').css('display','none');
//  }else{$('.popover .popover-content').css('display','block');} 
  });
  */
  $( ".info-icons a" ).live("hover",function(){
      $('.popover').addClass($(this).data("class"));
    
    });
}
funPreview();
</script> 
<script>
$( ".map" ).click(function() {
  $( ".view-map-cont" ).toggle();
  //alert($(".transport-view-map").html());
		if($(".transport-view-map").html() == '<i class="fa fa-eye"></i> View Map')
		{
			$(".transport-view-map").html('<i class="fa fa-eye-slash"></i> Hide Map'); 
			$(".view_map_tg").attr('id' , 'map-hide');  // Set id for each div 
			$(".transport-view-map").attr('title','Hide Map');
			initialize();			
			<?php 
			if($transport_details['st_trans_type']=='P' && isset($user_profile['st_driver']) && $user_profile['st_driver'] == 'Y' && isset($user_profile['st_pilot']) && $user_profile['st_pilot'] == 'Y') {
			if($profile_type!=1 && $profile_post!=1){
			 ?>
				$('#profile_popup').modal('show');
				return false;
			<?php } } ?> 
		}
		else if($(".transport-view-map").html() == '<i class="fa fa-eye-slash"></i> Hide Map')
		{
			//$("#main-transportation-route").height($("#leftheight").height());
			$(".transport-view-map").html('<i class="fa fa-eye"></i> View Map');
			$(".view_map_tg").attr('id' , 'grid-view');
			$(".transport-view-map").attr('title','View Map');
		}
});

function initialize() {
// create the map
	//alert('display map');
	 return Doobert.components.transportation_route.Base = flight.component(function () {
            return this.after("initialize", function () {
                var t = this;
                 return void 0 !== Doobert.components.Overlay && Doobert.components.Overlay.attachTo("#main-transportation-route"), 
				 this.trigger("map.initialize", {
                    routeMapSelector: "#route-map"
                })
            })
        }), Doobert.components.transportation_route.Base.attachTo("#main-transportation-route")
	}
	
function initialize_avia() {
// create the map
//alert('display map');
 		 return Doobert.components.transportation_avia.Base = flight.component(function () {
            return this.after("initialize", function () {
                return this.on("map.initializeAfter", function () {
                    return this.on("startendairports.initializeAfter", function () {
                        return this.trigger("legselector.initialize")
                    }), this.on("airports.initializeAfter", function () {
                        return this.trigger("startendairports.initialize")
                    }), this.trigger("zone.initialize"), this.trigger("airports.initialize")
                }), this.trigger("map.initialize", {
                    routeMapSelector: "#map"
                })
            })
        }), Doobert.components.transportation_avia.Base.attachTo("#avia-route")
}

$(document).ready(function () {
				//$('.view-map-cont').();
				<?php if($transport_details['st_trans_type']=='P') { ?>
					$("#main-transportation-route").attr("style", "position:relative; display: none;") 
					$(".view_map_tg").attr('id' , 'grid-view');  // Set id for each div 
				<?php } ?>
				
				<?php if((($profile_type==1 || $profile_type==0) && $profile_post==1) || ($this->session->userdata('recent_activity') && ($this->session->userdata('recent_activity') == "P" || $this->session->userdata('recent_activity') == "D"))) { ?>
					$("#main-transportation-route").attr("style", "position:relative; display: block;");
					$(".transport-view-map").html('<i class="fa fa-eye-slash"></i> Hide Map'); 
					$(".view_map_tg").attr('id' , 'map-hide');  // Set id for each div 
					initialize();					
				<?php } ?>
				
				/*if(page_id && page_id > 0)
				{
					$("#main-transportation-route").attr("style", "position:relative; display: block;");
					$(".transport-view-map").html('<i class="fa fa-eye-slash"></i> Hide Map'); 
					$(".view_map_tg").attr('id' , 'map-hide');  // Set id for each div 
					initialize();
				}*/
				
				 $('#legground').click(function () {
                    $('#aviation-leg').hide('fast');
                    $('#ground-leg').show('fast');
					//setTimeout(function(){ $(window).trigger('resize'); }, 200);
                });
                $('#legaviation').click(function () {
                    $('#ground-leg').hide('fast');
                    $('#aviation-leg').show('fast');
					//setTimeout(function(){ $(window).trigger('resize'); }, 200);
                 });
               });
			   
			   $(document).ready(function () {
                    $('#ground').click(function () {
                       $('#add-aviation').hide('fast');
                       $('#add-ground').show('fast');
                });
                $('#aviation').click(function () {
                      $('#add-ground').hide('fast');
                      $('#add-aviation').show('fast');
                 });
               });
			   
			   $(document).ready(function () {
					$('#recommend-legs').click(function () {
                       $('#recommend-legs').hide('fast');
					   $('.suggestion-text').hide('fast');
                       $('#recommend-own-box').show('fast');
					   $(".view_map_tg").attr('id' , 'grid-view');
						//setTimeout(function(){ $(window).trigger('resize'); }, 200);	
						//$("#route-map").css('height','1342');
						//initialize();
                });
				$('#cancel_recommend').click(function () {
					//$("#main-transportation-route").height($("#leftheight").height());
					   $('#recommend-legs').show('fast');
					   $('.suggestion-text').show('fast');
					   $('#recommend-own-box').hide('fast');
					   //$(".view_map_tg").attr('id' , 'map-hide');
					   //setTimeout(function(){ $(window).trigger('resize'); }, 200);
					    //$("#route-map").css('height','830');
						//initialize();
				});

				$('#cancel_recommend_avia').click(function () {
					//$("#main-transportation-route").height($("#leftheight").height());
					   $('#recommend-legs').show('fast');
					   $('.suggestion-text').show('fast');
					   $('#recommend-own-box').hide('fast');
					   //$(".view_map_tg").attr('id' , 'map-hide');
					   //setTimeout(function(){ $(window).trigger('resize'); }, 200);
					    //$("#route-map").css('height','830');
						//initialize();
				});
               });
			   
			   $(document).ready(function(){
				   $.uniform.update();
			   });

</script>

<?php /*?><link rel="stylesheet" type="text/css" href="http://tympanus.net/Development/AutomaticImageMontage/css/demo.css" />
<link rel="stylesheet" type="text/css" href="http://tympanus.net/Development/AutomaticImageMontage/css/style.css" />
<script type="text/javascript" src="http://tympanus.net/Development/AutomaticImageMontage/js/jquery.montage.min.js"></script>
<script type="text/javascript">
			$(function() {
				$('#showcode').toggle(
					function() {
						$(this).addClass('up').removeClass('down').next().slideDown();
					},
					function() {
						$(this).addClass('down').removeClass('up').next().slideUp();
					}
				);
				$('#panel').toggle(
					function() {
						$(this).addClass('show').removeClass('hide');
						$('#overlay').stop().animate( { left : - $('#overlay').width() + 20 + 'px' }, 300 );
					},
					function() {
						$(this).addClass('hide').removeClass('show');
						$('#overlay').stop().animate( { left : '0px' }, 300 );
					}
				);
				
				
				var $container 	= $('#am-container'),
					$imgs		= $container.find('img').hide(),
					totalImgs	= $imgs.length,
					cnt			= 0;
				
				$imgs.each(function(i) {
					var $img	= $(this);
					$('<img/>').load(function() {
						++cnt;
						if( cnt === totalImgs ) {
							$imgs.show();
							$container.montage({
								liquid 	: false,
								fixedHeight : 60
							});
							$('#overlay').fadeIn(500);
							var imgarr	= new Array();
							for( var i = 1; i <= 73; ++i ) {
								imgarr.push( i );
							}
							$('#loadmore').show().bind('click', function() {
								var len = imgarr.length;
								for( var i = 0, newimgs = ''; i < 15; ++i ) {
									var pos = Math.floor( Math.random() * len ),
										src	= imgarr[pos];
									newimgs	+= '<a href=""><img src="images/' + src + '.jpg"/></a>';
								}
								
								var $newimages = $( newimgs );
								$newimages.imagesLoaded( function(){
									$container.append( $newimages ).montage( 'add', $newimages );
								});
							});
						}
					}).attr('src',$img.attr('src'));
				});	
				
			});
		</script><?php */?>

<!-- BEGIN PAGE LEVEL PLUGINS --> 

<script type="text/javascript" src="<?php echo base_url(); ?>assets/plugins/bootstrap-datepicker/js/bootstrap-datepicker.js"></script> 
<script type="text/javascript" src="<?php echo base_url(); ?>assets/plugins/clockface/js/clockface.js"></script> 
<script type="text/javascript" src="<?php echo base_url(); ?>assets/plugins/bootstrap-datetimepicker/js/bootstrap-datetimepicker.min.js"></script> 
<script src="<?php echo base_url(); ?>assets/scripts/custom/components-pickers.js"></script> 
<script type="text/javascript" src="<?php echo base_url(); ?>assets/plugins/bootstrap-fileinput/bootstrap-fileinput.js"></script> 
<script type="text/javascript" src="<?php echo base_url(); ?>assets/plugins/gritter/js/jquery.gritter.js"></script> 
<script type="text/javascript" src="<?php echo base_url(); ?>assets/plugins/jquery.pulsate.min.js"></script> 
<script type="text/javascript" src="<?php echo base_url(); ?>assets/plugins/jquery-bootpag/jquery.bootpag.min.js"></script> 
<script type="text/javascript" src="<?php echo base_url(); ?>assets/plugins/holder.js"></script> 
<script src="<?php echo base_url(); ?>assets/plugins/jquery-validation/dist/jquery.validate.min.js" type="text/javascript"></script> 
<!-- END PAGE LEVEL PLUGINS --> 
<!-- BEGIN PAGE LEVEL SCRIPTS --> 

<script src="<?php echo base_url(); ?>assets/scripts/custom/ui-general.js"></script> 
<script src="<?php echo base_url(); ?>assets/scripts/custom/components-pickers.js"></script> 
<script>
function getCookie(cname) {
var name = cname + "=";
var ca = document.cookie.split(';');
for(var i=0; i<ca.length; i++) {
	var c = ca[i];
	while (c.charAt(0)==' ') c = c.substring(1);
	if (c.indexOf(name) == 0) return c.substring(name.length,c.length);
}
return "";
}	

function check_transport_type()
{
	$('#transport_confirm_box').modal('hide');
	<?php
	if($atype=='true' && $type=="true" && $transport_post=='0')
	{
	?>
	$('#aviation_popup').modal('show');
	<?php } elseif($transport_details['st_trans_type']	==	'D') { ?>
	var disable_demo_video = getCookie("disable_demo_video_popup");
    if (disable_demo_video != "1") 
	{
		$('#driver-specify-legs').modal('show');
	}
	<?php } ?>
}

$(window).load(function(){
<?php	if($transport_details['st_trans_type']	==	'P') { ?>
var trans_pickup_date = parseInt("<?php echo strtotime($transport_details['dt_pickup_date']);?>");
var trans_target_date = parseInt("<?php echo strtotime($transport_details['dt_target']);?>");
var current_date = parseInt("<?php echo strtotime(date("Y-m-d"));?>");
if((trans_pickup_date < current_date) && (trans_target_date < current_date))
{
	$('#transport_confirm_box').modal('show');
	return false;
}
<?php } ?>
});
	
<?php
if($atype=='true' && $type=="true" && $transport_post=='0')
{
?>
$(window).on('load', function () {
var trans_pickup_date = parseInt("<?php echo strtotime($transport_details['dt_pickup_date']);?>");
var trans_target_date = parseInt("<?php echo strtotime($transport_details['dt_target']);?>");
var current_date = parseInt("<?php echo strtotime(date("Y-m-d"));?>");

if((trans_pickup_date < current_date) && (trans_target_date < current_date))
{
	$('#transport_confirm_box').modal('show');
}
else{	
	$('#aviation_popup').modal('show');
}
$('#open_tab').val('');
$('#open_tab_info').val('');
$('#open_tab_comments_info').val('');
});

<?php }elseif($transport_details['st_trans_type']=='D'){
?>
$(window).on('load', function () {
 	var disable_demo_video = getCookie("disable_demo_video_popup");
 
	var trans_pickup_date = parseInt("<?php echo strtotime($transport_details['dt_pickup_date']);?>");
	var trans_target_date = parseInt("<?php echo strtotime($transport_details['dt_target']);?>");
	var current_date = parseInt("<?php echo strtotime(date("Y-m-d"));?>");
	
	if((trans_pickup_date < current_date) && (trans_target_date < current_date))
	{
		$('#transport_confirm_box').modal('show');
		return false;
	}

    else if (disable_demo_video != "1") 
	{
		$('#driver-specify-legs').modal('show');

	}
});
<?php } ?>

</script>
<!-- END PAGE LEVEL SCRIPTS --> 
<!-- END JAVASCRIPTS -->
<script>
function disable_demo_video_popup()
{
	//document.cookie="disable_demo_video_popup=1";
	setCookie('disable_demo_video_popup','1',90)
}

function setCookie(cname, cvalue, exdays) {
    var d = new Date();
    d.setTime(d.getTime() + (exdays*24*60*60*1000));
    var expires = "expires="+ d.toUTCString();
    document.cookie = cname + "=" + cvalue + ";" + expires + ";path=/";
}

function display_share_email_popup()
	{
		$('#email-config').modal('show');
		//val=document.getElementById('txtMessage').value;
		//val = val.replace(/<br\s*\/?>/mg,"\n");
		//alert(val);
		//$('#txtMessage').html(val);
		
	}
         jQuery(document).ready(function() {       
           // initiate layout and plugins
           UIGeneral.init();
           ComponentsPickers.init();
		   $('#assign-non-doobert').live('click',function() {	
		    $('#non_doobert_user_frm').validate({
					errorElement: 'span', //default input error message container
					errorClass: 'help-block', // default input error message class
					focusInvalid: true, // do not focus the last invalid input
					rules: {
						non_doobert_user_name: {
							required: true
						},
						/*non_doobert_user_phone: {
							required: true
						},*/
						non_doobert_user_email: {
							required: true,
							email:true
						},
						/*non_doobert_user_vehicle_zipcode: {
							required: true
						},
						non_doobert_user_vehicle_type: {
							required: true
						}*/												
					},
			
					messages: {
						non_doobert_user_name: {
							required: 'Please Enter Name.'
						},
						non_doobert_user_phone: {
							required: 'Please Enter Phone Number.'
						},
						non_doobert_user_email: {
							required: 'Please Enter Email.',
							email: 'Please Enter Valid Email.'
						},
						non_doobert_user_vehicle_type: {
							required: 'Please Enter Vehicle Type.'
						},
						non_doobert_user_vehicle_zipcode: {
							required: 'Please Enter Zipcode.'
						}
						
					},
			
					invalidHandler: function (event, validator) { //display error alert on form submit   
						$('#assign-nondoobert-user').show();
						
						var errors = validator.numberOfInvalids();
						if (errors) {
						  var message = errors == 1
							? 'You missed 1 field. It has been highlighted'
							: 'You missed ' + errors + ' fields. They have been highlighted';
						  alert(message);
						}
					},
			
					highlight: function (element) { // hightlight error inputs
						$(element)
							.closest('.form-group').addClass('has-error'); // set error class to the control group
					},
			
					success: function (label) { //alert(label);
						label.closest('.form-group').removeClass('has-error');
						label.remove();
					},
			
					errorPlacement: function (error, element) { 
						error.addClass('help-block').insertAfter(element.closest('.form-control'));
					}
			
				});
			});	
				
        $('#tell_a_friend').validate({
					errorElement: 'span', //default input error message container
					errorClass: 'help-block', // default input error message class
					focusInvalid: true, // do not focus the last invalid input
					rules: {
						txttoname: {
							required: true
						},
						txtemail: {
							required: true,
							email:true
						},
						txtMessage: {
							required: true
						}
					},
			
					messages: {
						txttoname: {
							required: 'Please enter receiver name.'
						},
						txtemail: {
							required: 'Please enter receiver email.',
							emauil: 'Please enter valid receiver email.'
						},
						txtMessage: {
							required: 'Please enter message.'
						}
						
					},
			
					invalidHandler: function (event, validator) { //display error alert on form submit   
						$('#tell_a_friend').show();
						
						var errors = validator.numberOfInvalids();
						if (errors) {
						  var message = errors == 1
							? 'You missed 1 field. It has been highlighted'
							: 'You missed ' + errors + ' fields. They have been highlighted';
						  alert(message);
						}
					},
			
					highlight: function (element) { // hightlight error inputs
						$(element)
							.closest('.form-group').addClass('has-error'); // set error class to the control group
					},
			
					success: function (label) { //alert(label);
						label.closest('.form-group').removeClass('has-error');
						label.remove();
					},
			
					errorPlacement: function (error, element) { 
						error.addClass('help-block').insertAfter(element.closest('.form-control'));
					}
			
				});
						
        }); 
		
		$('#send_mail').live('click',function(){
	if($('#tell_a_friend').valid() == false) {
		return false;
	} else {
		$('#send_mail').hide();
		
		if($.browser.msie) {
				$('.display_loader').html('<img id="loadimg" src="<?php echo base_url(); ?>assets/img/ajax-loading.gif" alt="loader" />');
			}
		$('.display_loader').show();
		
		$('#loadimg_mail').show();
		$('#email-config').modal('hide');
		
		if($.browser.msie) {
			$('.display_loader').html('<div id="loader" style="display: none;"><img src="<?php echo base_url(); ?>assets/img/ajax-modal-loading.gif" width="32" height="32" align="absmiddle">&nbsp;<span id="loadertext">Loading...</span></div>');
		}
		
		$('.display_loader').show();
		$('#loader').show();
	}
	});   
	
		$('#close_non_doobert_user_form,#non_doobert_cancel').live('click',function(){	
				$('.form-group').removeClass('has-error');
				$('.help-block').remove();
		});
	
		$('#non_doobert_assign_leg').live('click',function(){
			$('#non_doobert_user_assign_and_invite').val('0');
		if($('#non_doobert_user_frm').valid() == false) {
			return false;
		} else {
			
			var non_doobert_email_id = $('#non_doobert_user_email').val();
			
			//alert(non_doobert_email_id);
			$.ajax({
			type: "POST",
				  url: '<?php echo base_url(); ?>org_transportation/check_non_doobert_exists',
				  beforeSend: function() {
					$('#loader').show();
				  },
				  data: {
					  email_id : non_doobert_email_id
				  },
				  dataType:"json",
				  complete: function() {
					 $('#loader').hide();
				  },
				  success:function(data) {
					  //alert(data);
					  //alert(data.st_display_name);
					  //alert(data.st_last_name);
					  //alert(data.in_user_id);
					  if(data.in_user_id > 0)
					  {
						//alert('email id already exists'); 
						//$('#match_doobert_user_popup_email_add').html(non_doobert_email_id);
						//$('#match_doobert_user_popup_email_name').html(data.st_display_name+' '+data.st_last_name);
						
						//$('#matched_doobert_user_id').val(data.in_user_id);
						//$('#matched_doobert_user_email').val(data.st_email);
						//$('#matched_doobert_transport_id').val($('#non_doobert_user_transport_id').val());
						//$('#matched_doobert_leg_id').val($('#non_doobert_user_transport_leg_id').val());
						//$('#matched_doobert_user_name').val(data.st_display_name+' '+data.st_last_name);
						
						//$('#match_doobert_user_popup').modal('show');
						//return false;
						
						if(data.st_primary_phone!='')
						{	
							$('#match_doobert_user_popup_email_add').html(non_doobert_email_id);
							$('#match_doobert_user_popup_email_name').html(data.st_display_name+' '+data.st_last_name);
							$('#matched_doobert_user_id').val(data.in_user_id);
							$('#matched_doobert_user_email').val(data.st_email);
							$('#matched_doobert_transport_id').val($('#non_doobert_user_transport_id').val());
							$('#matched_doobert_leg_id').val($('#non_doobert_user_transport_leg_id').val());
							$('#matched_doobert_user_name').val(data.st_display_name+' '+data.st_last_name);
							$('#match_doobert_user_popup').modal('show');	
							return false;
						} else {
							//alert("this user cannot be selected");
							$('#noneuser_match_doobert_user_popup').modal('show');
							return false;
						}
						
					  }else{
						 if($.browser.msie) {
									$('.display_loader').html('<img id="loadimg" src="<?php echo base_url(); ?>assets/img/ajax-loading.gif" alt="loader" />');
								}
							$('.display_loader').show();
							
							$('#loadimg_mail').show();
							$('#assign-nondoobert-user').modal('hide');
							
							if($.browser.msie) {
								$('.display_loader').html('<div id="loader" style="display: none;"><img src="<?php echo base_url(); ?>assets/img/ajax-modal-loading.gif" width="32" height="32" align="absmiddle">&nbsp;<span id="loadertext">Loading...</span></div>');
							}
							
							$('.display_loader').show();
							$('#loader').show();
							$('#non_doobert_user_frm').submit();
							
						 }
					 
				  }
		});
		}
		}); 
		
		$('#non_doobert_assign_leg_invite').live('click',function(){			
			$('#non_doobert_user_assign_and_invite').val('1');
		if($('#non_doobert_user_frm').valid() == false) {
			return false;
		} else {
			
			var non_doobert_email_id = $('#non_doobert_user_email').val();
			
			//alert(non_doobert_email_id);
			$.ajax({
			type: "POST",
				  url: '<?php echo base_url(); ?>org_transportation/check_non_doobert_exists',
				  beforeSend: function() {
					$('#loader').show();
				  },
				  data: {
					  email_id : non_doobert_email_id
				  },
				  dataType:"json",
				  complete: function() {
					 $('#loader').hide();
				  },
				  success:function(data) {
					  //alert(data);
					  //alert(data.st_display_name);
					  //alert(data.st_last_name);
					  //alert(data.in_user_id);
					  if(data.in_user_id > 0)
					  {
						//alert('email id already exists'); 
						//$('#match_doobert_user_popup_email_add').html(non_doobert_email_id);
						//$('#match_doobert_user_popup_email_name').html(data.st_display_name+' '+data.st_last_name);
						
						//$('#matched_doobert_user_id').val(data.in_user_id);
						//$('#matched_doobert_user_email').val(data.st_email);
						//$('#matched_doobert_transport_id').val($('#non_doobert_user_transport_id').val());
						//$('#matched_doobert_leg_id').val($('#non_doobert_user_transport_leg_id').val());
						//$('#matched_doobert_user_name').val(data.st_display_name+' '+data.st_last_name);
						
						//$('#match_doobert_user_popup').modal('show');
						//return false;
						if(data.st_primary_phone!='')
						{	
							$('#match_doobert_user_popup_email_add').html(non_doobert_email_id);
							$('#match_doobert_user_popup_email_name').html(data.st_display_name+' '+data.st_last_name);
							$('#matched_doobert_user_id').val(data.in_user_id);
							$('#matched_doobert_user_email').val(data.st_email);
							$('#matched_doobert_transport_id').val($('#non_doobert_user_transport_id').val());
							$('#matched_doobert_leg_id').val($('#non_doobert_user_transport_leg_id').val());
							$('#matched_doobert_user_name').val(data.st_display_name+' '+data.st_last_name);
							$('#match_doobert_user_popup').modal('show');	
							return false;
						} else {
							//alert("this user cannot be selected");
							$('#noneuser_match_doobert_user_popup').modal('show');
							return false;
						}
					  }else{
						 if($.browser.msie) {
									$('.display_loader').html('<img id="loadimg" src="<?php echo base_url(); ?>assets/img/ajax-loading.gif" alt="loader" />');
								}
							$('.display_loader').show();
							
							$('#loadimg_mail').show();
							$('#assign-nondoobert-user').modal('hide');
							
							if($.browser.msie) {
								$('.display_loader').html('<div id="loader" style="display: none;"><img src="<?php echo base_url(); ?>assets/img/ajax-modal-loading.gif" width="32" height="32" align="absmiddle">&nbsp;<span id="loadertext">Loading...</span></div>');
							}
							
							$('.display_loader').show();
							$('#loader').show();
							$('#non_doobert_user_frm').submit();
							return false;
						 }
					 
				  }
		});
		}
		
		}); 
		
		
		
		$('#modal_confirm_match_user').live('click',function(){
			$('#non_doobert_match_user_frm').submit();
			}); 
	   
</script> 
<!-- END PAGE LEVEL SCRIPTS --> 
<!--Date Picker--> 
<script>
jQuery(document).ready(function() { 
	$('#loadimg').hide();      
   // initiate layout and plugins
   ComponentsPickers.init();
   <?php if($this->session->flashdata('success')): ?>
$('#success_copy').modal('show');
<?php endif; ?>
}); 
	
jQuery(document).ready(function() {
	
	$('#c_date').live('click',function(){
		if($('#dateselect').val() == '' || $('#pickup_select').val() == '') {
			$('#date_error').show();
			return false;
		}
	});
	
	$('#dateselect, #pickup_select').live('blur',function(){
		if($('#dateselect').val() == '' && $('#pickup_select').val() == '') {
			$('#date_error').hide();
			return true;
		}
	});
	
	$('.empty_dates').live('click',function(){
		$('#dateselect').val('<?php echo (isset($transport_details['dt_target']))?date("m/d/Y",strtotime($transport_details['dt_target'])):'';?>');
		$('#pickup_select').val('<?php echo (isset($transport_details['dt_pickup_date']))?date("m/d/Y",strtotime($transport_details['dt_pickup_date'])):'';?>');
		$('#date_error').hide();
	});
//		
//var startDate = new Date('01/01/2012');
//var FromEndDate = new Date();
//var ToEndDate = new Date();
//ToEndDate.setDate(ToEndDate.getDate()+365);
//
//$('.from_date').datetimepicker({ 
//   /* weekStart: 1,
//    startDate: '01/01/2012',
//    endDate: FromEndDate, */   
//	format: "dd MM yyyy - HH:ii P",
//	showMeridian: true,
//	autoclose: true,
//	//todayBtn: true,
//	pickerPosition: "bottom-left"
//})
//    .on('changeDate', function(selected){
//        startDate = new Date(selected.date.valueOf());
//        startDate.setDate(startDate.getDate(new Date(selected.date.valueOf())));
//        $('.to_date').datetimepicker('setStartDate', startDate);
//    }); 
//$('.to_date')
//    .datetimepicker({
//        
//       /* weekStart: 1,
//        startDate: startDate,
//        endDate: ToEndDate,*/
//		format: "dd MM yyyy - HH:ii P",
//		showMeridian: true,
//		autoclose: true,
//		todayBtn: false,
//		pickerPosition: "bottom-left"
//    })
//    .on('changeDate', function(selected){
//        FromEndDate = new Date(selected.date.valueOf());
//        FromEndDate.setDate(FromEndDate.getDate(new Date(selected.date.valueOf())));
//        $('.from_date').datetimepicker('setEndDate', FromEndDate);
//    });
//


	
});	

function copy_transport_details(transport_status,target_date,pickup_date)
{
 
 //alert('transport_status'+transport_status);
 if(transport_status == 4)
 {
 	 var error_confirm = "";
	 var today = new Date();
	 today.setHours(0,0,0,0);
	 //alert(today);
	
	 //alert(target_date);
	 var arrDate = target_date.split("/");
	
	//alert(arrDate[0]);
	//alert(arrDate[1]);
	//alert(arrDate[2]);
	var year = arrDate[2];
	var day = arrDate[1];
	var month = arrDate[0];
	
	//alert(year+month+day);
	
	var useDate = new Date(year, month-1, day);
	
	//alert(useDate);
	
	var arrPickUpDate = pickup_date.split("/");
	
	//alert(arrDate[0]);
	//alert(arrDate[1]);
	//alert(arrDate[2]);
	var pyear = arrPickUpDate[2];
	var pday = arrPickUpDate[1];
	var pmonth = arrPickUpDate[0];
	
	var pickDate = new Date(pyear, pmonth-1, pday);
	
	//alert(pickDate);
	
	if ((today <= useDate) && (today <= pickDate)) {
	//return true;
	//return(confirm('Please update legs as per new transportation date.')?true:false);
	return(confirm('Please verify the dates of the legs.')?true:false);
	} else {
	//alert('Current date must be less than or equal to Target date1 .');
	error_confirm +="Transportation target date and pick up date must be greater than or equal to the current date.";
	}	
	//alert(error_confirm);		
	if(error_confirm!='')
	{
		alert(error_confirm);
		return false;
	}

 }
 
  else if(transport_status == 1)
 {
 	 var error_confirm = "";
	 var today = new Date();
	 today.setHours(0,0,0,0);
	 //alert(today);
	
	 //alert(target_date);
	 var arrDate = target_date.split("/");
	
	//alert(arrDate[0]);
	//alert(arrDate[1]);
	//alert(arrDate[2]);
	var year = arrDate[2];
	var day = arrDate[1];
	var month = arrDate[0];
	
	//alert(year+month+day);
	
	var useDate = new Date(year, month-1, day);
	
	//alert(useDate);
	
	/*var arrPickUpDate = pickup_date.split("/");
	
	//alert(arrDate[0]);
	//alert(arrDate[1]);
	//alert(arrDate[2]);
	var pyear = arrPickUpDate[2];
	var pday = arrPickUpDate[1];
	var pmonth = arrPickUpDate[0];
	
	var pickDate = new Date(pyear, pmonth-1, pday);
	
	alert(pickDate);*/
	
	if ((today <= useDate)) {
	//return true;
	return(confirm('Please verify the dates of the legs.')?true:false);
	} else {
	//alert('Current date must be less than or equal to Target date1 .');
	error_confirm +="Transportation target date must be greater than or equal to the current date.";
	}	
	//alert(error_confirm);		
	if(error_confirm!='')
	{
		alert(error_confirm);
		return false;
	}

 }
 else{
 //return(confirm('Please update legs as per new transportation date.')?true:false);
 return(confirm('Please verify the dates of the legs.')?true:false);
 }
} 
 
heightFix ();			 
function heightFix (){
	var leftcol = $('#leftcolumn').height();
	var mapheight = leftcol;
  var minheightstyles = {'min-height':875};
	$('#tab_2_2, #tab_2_1, #tab_2_3,#route-map,#map').height(mapheight);
  $('#tab_2_2, #tab_2_1, #tab_2_3,#route-map,#map').css(minheightstyles)  
} 

(function($,sr){
  var debounce = function (func, threshold, execAsap) {
      var timeout;

      return function debounced () {
          var obj = this, args = arguments;
          function delayed () {
              if (!execAsap)
                  func.apply(obj, args);
              timeout = null;
          };

          if (timeout)
              clearTimeout(timeout);
          else if (execAsap)
              func.apply(obj, args);

          timeout = setTimeout(delayed, threshold || 100);
      };
  }
  // smartresize 
  jQuery.fn[sr] = function(fn){  return fn ? this.bind('resize', debounce(fn)) : this.trigger(sr); };

})(jQuery,'smartresize');



// usage:
$(window).smartresize(function(){
  heightFix ();
});

$('#select_leg').live('click',function(){
		//alert($('#action').val());
		$('#buttons3').hide();
		$(".cancel_leg").hide();
		$(".loder_cancel").hide();
		$("#select_leg").hide();
		$('#loadimg').show();
		$('#legs_select').submit();
		return true;
});

$('#transport_monitor').live('click',function(){
		//alert($('#action').val());
		$('#buttons3').hide();
		$(".cancel_leg").hide();
		$(".loder_cancel").hide();
		$("#transport_monitor").hide();
		$('#loadimg_trans_monitor').show();
		$('#legs_select').submit();
		return true;
});

$("#leave_transport").live("click",function(){
	if(confirm('Are you sure, you want to leave the transportation?'))
	{	
		//alert($('#action').val());
		$('#buttons3').hide();
		$(".cancel_leg").hide();
		$(".loder_cancel").hide();
		$("#select_leg").hide();
		$('#leave_transport').show();
		$('#legs_select').submit();
		return true;
	}
	else{
		return false;
	}
});
<?php if($transport_details['st_trans_type']=='D'){ ?>	
$('#info_ul').live('click',function(){
	if(jQuery("#r_map").attr("class")=='active' || jQuery(".icon_class").attr("class")=='active')
	{
		jQuery( "#driverleginfo_icon" ).show();
		jQuery( "#pilotleginfo_icon" ).show();
	}
	else
	{
		jQuery( "#driverleginfo_icon" ).hide();
		jQuery( "#pilotleginfo_icon" ).hide();
	}
});	
<?php } ?>


$(window).on('load', function () {
	 //$('#route_tab').tab('#tab_2_2');
	 jQuery('#cancel-config').modal('show');
	 
});	


$(document).ready(function(){
	//alert('show recommend popup');
	<?php  if($this->session->flashdata('success_recommend')): ?>
		$('#thanku-suggest-leg').modal('show');
		
	<?php endif; ?>
	
	// $('#tab_2_2').tab('show');
	 //$('#tab_2_2 a[href="#tab_2_2"]').tab('show');
	 //alert('<php echo $this->session->userdata('transportation_successfully_created');?>');
	  <?php 
			if($this->session->userdata('transportation_successfully_created') && $this->session->userdata('transportation_successfully_created') == 'transportation_successfully_created') {
			
		?>
		<?php $this->session->unset_userdata('transportation_successfully_created'); ?>
			$('#transport-created-successfully').modal('show');
			
		<?php } ?>
			
$('#loadimg_feed').hide();
$('#message_frm').validate({
		errorElement: 'span', //default input error message container
		errorClass: 'help-block', // default input error message class
		focusInvalid: true, // do not focus the last invalid input
		rules: {
			message: {
				required: true
			}
		},

		messages: {
			message: {
				required: 'Please enter message.'
			}
		},

		invalidHandler: function (event, validator) { //display error alert on form submit   
			$('#message_frm').show();
		},

		highlight: function (element) { // hightlight error inputs
			$(element)
				.closest('.form-group').addClass('has-error'); // set error class to the control group
		},

		success: function (label) { //alert(label);
			label.closest('.form-group').removeClass('has-error');
			label.remove();
		},

		errorPlacement: function (error, element) { 
			//error.addClass('help-small no-left-padding').insertAfter(element.closest('.form-group'));
			error.addClass('help-block').insertAfter(element.closest('.form-control'));
			/*if (element.attr("name") == "pickup_select")
			{
				error.addClass('help-block').insertAfter(element.closest('.form-control'));
			}
			else
			{
				error.addClass('help-block').insertAfter(element.closest('.form-control'));
			}*/
		}

	});
	
$('#post_message').live('click',function(){
	if($('#message_frm').valid() == false) {
		return false;
	} else {
		$('#post_message').hide();
		$('#loadimg_feed').show();
		return true;
	}});

$('.remove_monitors').live('click',function(){
	if($(this).attr("legtype")=='remove_as_monitor')
	{
		$('#remove_monitor_popup_'+$('#remove_monitor_id').val()).modal('show');
		return false;

	}
	});


$(".cancel_leg").live("click",function(){


	if($(this).attr("legtype")=='join')
	{
		$(".loder_cancel,#select_leg,#leave_transport").hide();
		$('#'+$(this).attr("data-val")).show();
		$('.cancel_leg').hide();
		return true;
	}
	else if($(this).attr("legtype")=='remove')
	{
		$('#remove_popup_'+$('#cancel_leg_id').val()).modal('show');
		return false;
	}
	else
	{
		//alert($('#cancel_leg_id').val());
		$('#cancel_popup_'+$('#cancel_leg_id').val()).modal('show');
		return false;
		/*if(confirm('Are you sure, you want to cancel your leg?'))
		{
			$(".loder_cancel,#select_leg,#leave_transport").hide();
			$('#'+$(this).attr("data-val")).show();
			$('.cancel_leg').hide();
			return true;
		}
		else
		{
			return false;
		}*/
		
	}
	//return false; 
	});

var height_scroll =  $('.multi-legs ul').height();
var height_scroll2 = 0;
/*for(var m=1;m<start_li;m++)
{	
	console.log($('.multi-legs ul li').height()+parseFloat($('.multi-legs ul li').css('marginBottom').replace(/[^-\d\.]/g, '')));
	height_scroll2 = height_scroll2 + $('.multi-legs ul li').height()+parseFloat($('.multi-legs ul li').css('marginBottom').replace(/[^-\d\.]/g, ''));
}*/
if(start_li!='' && start_li>0)
{
var height_scroll2=0;
$(".multi-legs ul li:lt("+(start_li-1)+")").each(function() {
   height_scroll2 += $(this).outerHeight(true); // to include margins
});
//console.log(height_scroll);
//console.log(height_scroll2);
//$('.multi-legs').animate({scrollTop: height_scroll2}, 'slow');
$( ".multi-legs" ).scrollTop( height_scroll2);
}
});		


		
</script> 
<script type="text/javascript">
$(document).ready(function(e) {
	
	$('.view_more').live('click',function(){
		var count_notification = $('.timeline-red').length;
		 count_notification = parseInt(count_notification)+parseInt($('.timeline-yellow').length);
		 count_notification = parseInt(count_notification)+parseInt($('.timeline-green').length);
		 //console.log('count_notification'+count_notification);
		$.ajax({
			type: "POST",
				  url: '<?php echo base_url(); ?>org_transportation/view_more_tr_notification',
				  beforeSend: function() {
					$('#loader').show();
				  },
				  data: {
					  start : count_notification,
					  end : 15
				  },
				  dataType:"html",
				  complete: function() {
					 $('#loader').hide();
				  },
				  success:function(data) {
				  	//console.log(data);
					  if(data != '') {
						var window_height = $(window).height();
    					var document_height = $(document).height();
					  	$('.timeline').append(data);
						/*$('html,body').animate({ 
								scrollTop: window_height + document_height 
						}, 'slow', function (){ });*/
						
						$('html,body').animate({ 
								scrollTop: window_height + document_height 
						},2500);
						
					  } else {
						  $('.not_found').show();
						  $('.view_more').hide();
					  }
					  
					 var current_notification = $('.timeline-red').length;
		 				current_notification = parseInt(current_notification)+parseInt($('.timeline-yellow').length);
		 				current_notification = parseInt(current_notification)+parseInt($('.timeline-green').length);
					 var total_rows = '<?php echo $totalrecord; ?>';
					  //console.log(total_rows+"_"+current_notification);
					 if(current_notification == total_rows) {
						$('.view_more').hide();
					 } else {
						$('.view_more').show();
					 }
				  }
		});
	});
/*	$(".click_f").click(function(){
		//console.log(this);
		alert("sd");	
	});*/
	
	$('#modal_confirm_transport').live('click',function(){
		//alert('modal_confirm_transport clicked');
		var pickup_date = parseInt("<?php echo strtotime($transport_details['dt_pickup_date']);?>");
		var target_date = parseInt("<?php echo strtotime($transport_details['dt_target']);?>");
		
			<?php
			if(isset($leg_details) && !empty($leg_details))
			{
				foreach($leg_details as $key=>$value)
				{ 
				 if(isset($value['pick_start_time']) && isset($value['drop_start_time'])){
				?>
				
				//var leg_start_date = parseInt("<php echo strtotime($value['pick_start_time']);?>");
				//var leg_end_date = parseInt("<php echo strtotime($value['drop_start_time']);?>");
				
				var leg_start_date = parseInt("<?php echo strtotime(date("Y-m-d",strtotime($value['pick_start_time'])));?>");
				var leg_end_date = parseInt("<?php echo strtotime(date("Y-m-d",strtotime($value['drop_start_time'])));?>");
				
				
				if(((leg_start_date < pickup_date) || (leg_start_date > target_date)) || ((leg_end_date < pickup_date) || (leg_end_date > target_date)) )
				{ 
					if(confirm("Legs date should match with transport date. Please update the legs date before confirming."))
					{
						window.location.replace("<?php echo base_url(); ?>transport-create-legs/");						
					}else{
						return false;
					}
					return false;
				}
				
			<?php }	}
			}
			?>
			$('#transport-confirmation').modal('hide');
			document.confirm_transport.submit();		
	});	
	
});

function mark_as_completed(leg_id)
{
	var checked = $("#completed_"+leg_id).is(':checked');
		if(checked) {
			//$("#completed_"+leg_id).attr("checked", "checked");
			if(confirm('Are you sure, Do you want to mark this leg completed?')){         
				$("#leg_completed_id").val(leg_id);
				document.mark_complete.submit();
			}
			else{
				$("#completed_"+leg_id).removeAttr('checked');
			}
		} 
}
</script> 
<script type="text/javascript">
$(window).on('load', function () {
	var current_notification = $('.timeline-red').length;
		 current_notification = parseInt(current_notification)+parseInt($('.timeline-yellow').length);
		 current_notification = parseInt(current_notification)+parseInt($('.timeline-green').length);
	var total_rows = '<?php echo $totalrecord; ?>';
	//alert(total_rows);
	if(current_notification == total_rows) {
		$('.view_more').hide();
	} else {
		$('.view_more').show();
	}
	
});
var driver = parseInt('<?php echo $count_driver;?>'); 		
var legs = parseInt('<?php echo count($leg_details);?>');
var animal = parseInt('<?php echo count($transport_animals);?>');

/*if(driver==legs  && animal!=0)
{*/
	//$('#c_trans').show();
/*}*/
function confirm_transportation()
{
	var error_confirm = "";
	//$transport_details['cover_dis_per']>=90 &&  strtotime($transport_details['dt_target'])>=strtotime(date("Y-m-d"))
	
	var distance 	= parseFloat("<?php echo $transport_details['cover_dis_per'];?>");
	var target_date = parseInt("<?php echo strtotime($transport_details['dt_target']);?>");
	var currentdate = parseInt("<?php echo strtotime(date("Y-m-d"));?>");
	var animal 		= parseInt('<?php echo count($transport_animals);?>');
	
	var pickup_date = parseInt("<?php echo strtotime($transport_details['dt_pickup_date']);?>");
	
	/*if(distance<90)
	{
		error_confirm +="Distance is not coverd 90%.\n";
	}*/
	if(animal<=0)
	{
		error_confirm +="The animal is not available in transportation.\n";
	}
	if(target_date<currentdate)
	{
		error_confirm +="Current date must be less than or equal to Target date.\n";
	}
	if(error_confirm!='')
	{
		alert(error_confirm);
		return false;
	}
	else
	{
		$('#transport-confirmation').modal('show');
		
		return false;	
		
	}
}



function update_vehicle_details()
{	
	var selected_vehicle = $('#select_vehicle').val();
	//alert(selected_vehicle);
	
	if(selected_vehicle != "")
	{
		/*$(".loder_cancel,#select_leg,#leave_transport").hide();
		$('#'+$(this).attr("data-val")).show();
		$('.cancel_leg').hide();
		return true;*/
		
		//alert(selected_vehicle);
		$('#change_vehicle_btn').hide();
		//$('#action').val('change_vehicle');
		//$('#legs_select').submit();
		document.frm_change_vehicle.submit();
		return true;
	}
	else
	{
		alert('Please select vehicle.');
		return false;
	}
	
}

function update_plane_details()
{	
	var selected_plane = $('#select_plane').val();
	//alert(selected_vehicle);
	
	if(selected_plane != "")
	{
		/*$(".loder_cancel,#select_leg,#leave_transport").hide();
		$('#'+$(this).attr("data-val")).show();
		$('.cancel_leg').hide();
		return true;*/
		
		//alert(selected_vehicle);
		$('#change_plane_btn').hide();
		//$('#action').val('change_vehicle');
		//$('#legs_select').submit();
		document.frm_change_plane.submit();
		return true;
	}
	else
	{
		alert('Please select plane.');
		return false;
	}
	
}

function cancel_leg_or_transport(leg_id)
{
//alert('cancel leg');
var cancel_val = $('input[name=cancel_leg_radio]:checked').val();
//alert(cancel_val);
if(cancel_val == 'all')
{
$(".loder_cancel,#select_leg,#leave_transport").hide();
$('#'+$(this).attr("data-val")).show();
$('.cancel_leg').hide();
$('#action').val('leave');
$('#legs_select').submit();
return true;
}
if(cancel_val == 'only')
{
$(".loder_cancel,#select_leg,#leave_transport").hide();
$('#'+$(this).attr("data-val")).show();
$('.cancel_leg').hide();
$('#action').val('cancel');
$('#legs_select').submit();
return true;
}
}

function remove_leg_and_transport(leg_id)
{
//alert('remove leg');
$(".loder_cancel,#select_leg,#leave_transport").hide();
$('#'+$(this).attr("data-val")).show();
$('.cancel_leg').hide();
$('#action').val('remove_vol');
$('#legs_select').submit();

return true;

}

function remove_transport_monitor()
{

$('#action').val('remove_transport_monitor');
$('#legs_select').submit();
return true;

}

</script> 
<script>
$(document).ready(function(){
var user_vehicle_count = $('#user_vehicle_count').val();
//alert(user_vehicle_count);
if(user_vehicle_count == 0){
$("#change_vehicle_info,#change_vehicle").hide();
}
});
</script>
<!-- END JAVASCRIPTS --> 
<?php /*?><script type="text/javascript">
var w=0;
jQuery("#route_tab").click(function(){
if(w<1)
{	
	jQuery.getScript("<?php echo base_url(); ?>map/application.js");
	$.noConflict();
}
w++;
}); 
</script><?php */?>

<?php /*?><script src="<?php echo base_url(); ?>assets/scripts/custom/infobox.js"></script>
<script type="text/javascript">
jQuery.noConflict(); 
</script><?php */?>
<?php 
//if($this->session->userdata('userid')==$transport_details['in_trans_coods_id']){ 
?>
<!-- Multiple file upload start --> 
<script type="text/javascript">
var upload_link= '<?php echo base_url(); ?>org_transportation/add_images';
var file_divid = 'transport_locations';
var file_divid_update = 'transport_update_info';
</script> 
<!-- The jQuery UI widget factory, can be omitted if jQuery UI is already included --> 
<script src="<?php echo base_url(); ?>assets/plugins/jquery-file-upload/js/vendor/jquery.ui.widget.js"></script> 
<!-- The Templates plugin is included to render the upload/download listings --> 
<script src="<?php echo base_url(); ?>assets/plugins/multi-files-upload/tmpl.min.js"></script> 
<!-- The Load Image plugin is included for the preview images and image resizing functionality --> 
<script src="<?php echo base_url(); ?>assets/plugins/multi-files-upload/load-image.min.js"></script> 
<!-- The Canvas to Blob plugin is included for image resizing functionality --> 
<script src="<?php echo base_url(); ?>assets/plugins/multi-files-upload/canvas-to-blob.min.js"></script> 
<!-- Bootstrap JS is not required, but included for the responsive demo navigation --> 
<?php /*?><script src="//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script> <?php */?>
<!-- blueimp Gallery script --> 
<script src="<?php echo base_url(); ?>assets/plugins/multi-files-upload/jquery.blueimp-gallery.min.js"></script> 
<!-- The Iframe Transport is required for browsers without support for XHR file uploads --> 
<script src="<?php echo base_url(); ?>assets/plugins/jquery-file-upload/js/jquery.iframe-transport.js"></script> 
<!-- The basic File Upload plugin --> 
<script src="<?php echo base_url(); ?>assets/plugins/jquery-file-upload/js/jquery.fileupload.js"></script> 
<!-- The File Upload processing plugin --> 
<script src="<?php echo base_url(); ?>assets/plugins/jquery-file-upload/js/jquery.fileupload-process.js"></script> 
<!-- The File Upload image preview & resize plugin --> 
<script src="<?php echo base_url(); ?>assets/plugins/jquery-file-upload/js/jquery.fileupload-image.js"></script> 
<?php /*?><!-- The File Upload audio preview plugin --> 
<script src="<?php echo base_url(); ?>assets/plugins/jquery-file-upload/js/jquery.fileupload-audio.js"></script> 
<!-- The File Upload video preview plugin --> 
<script src="<?php echo base_url(); ?>assets/plugins/jquery-file-upload/js/jquery.fileupload-video.js"></script> <?php */?>
<!-- The File Upload validation plugin --> 
<script src="<?php echo base_url(); ?>assets/plugins/jquery-file-upload/js/jquery.fileupload-validate.js"></script> 
<!-- The File Upload user interface plugin --> 
<script src="<?php echo base_url(); ?>assets/plugins/jquery-file-upload/js/jquery.fileupload-ui.js"></script> 
<!-- The main application script --> 
<script src="<?php echo base_url(); ?>assets/plugins/jquery-file-upload/js/file_upload_main.js"></script> 
<script>
$(document).ready(function(){
	$('#'+file_divid).fileupload({
		  url: upload_link,
		  maxNumberOfFiles: 5,
		  maxFileSize : 5242880,
		  acceptFileTypes :/(\.|\/)(jpe?g|doc|docx|xls|xlsx|pdf)$/i,
		  sequentialUploads: true,
		  autoUpload :true
		});

		$('#'+file_divid_update).fileupload({
		  url: upload_link,
		  maxNumberOfFiles: 5,
		  maxFileSize : 5242880,
		  acceptFileTypes :/(\.|\/)(jpe?g|doc|docx|xls|xlsx|pdf)$/i,
		  sequentialUploads: true,
		  autoUpload :true
		});	
		
});

$('#submit_upload').live('click',function(){
	var file_name = '';
	$('#image_file').val('');
	$('.table-striped tr').each(function() {
    var image_files = $(this).find('td p a').text(); 
	if(image_files!='')
	{  
		if (file_name == '') {
				file_name += image_files;
		}else{
				file_name += ',' + image_files; 
		}
	}
	});
	$('#image_file').val(file_name);
	if(file_name == "") {
		alert("Please upload files.")
		return false;
	} else {
		$('#submit_upload').hide();
		document.transport_locations.submit();
		$('#loadimg_upload').show();
		return true;
	}
});	
    </script>    
    
<!-- Multiple file upload end --> 
<?php //} ?>
<script type="text/javascript" src="<?php echo $base_url;?>assets/ckeditor/ckeditor.js"></script>
<script>
  CKEDITOR.replace( 'rescue_story' );
</script>
<script type="text/javascript">
var photo_upload_link = '<?php echo base_url(); ?>org_transportation/add_photos';
var photo_divid = 'transport_photos';
var rescue_divid = 'rescue_transport_story_frm';

</script> 
<script>
$(document).ready(function(){
	$("area[rel^='prettyPhoto']").prettyPhoto();
	$(".gallery:first a[rel^='prettyPhoto']").prettyPhoto({animation_speed:'normal',theme:'light_square',slideshow:3000, autoplay_slideshow: false});
	$(".gallery:gt(0) a[rel^='prettyPhoto']").prettyPhoto({animation_speed:'fast',slideshow:10000, hideflash: true});
	
	$('#'+photo_divid).fileupload({
		  url: photo_upload_link,
		  //maxNumberOfFiles: 5,
		  maxFileSize : 5242880,
		  acceptFileTypes :/(\.|\/)(jpe|jpg|jpeg|png|gif)$/i,
		  sequentialUploads: true,
		  autoUpload :true
		});
		
		
		$('#'+rescue_divid).fileupload({
		  url: photo_upload_link,
		  //maxNumberOfFiles: 5,
		  maxFileSize : 5242880,
		  acceptFileTypes :/(\.|\/)(jpe|jpg|jpeg|png|gif)$/i,
		  sequentialUploads: true,
		  autoUpload :true
		});
		
		
		$('#download_all').click(function (event) {
			event.preventDefault();
			$('.document').multiDownload();
		});
		
});


$('#cancel_rescue_story').live('click',function(){
	$('#tab-photos-box').show();
	$('#transport-story').hide();
});

$('#cancel_transport_photo').live('click',function(){
	$('#tab-photos-box').show();
	$('#transport-story').hide();
	$('#photos-videos-box').hide();
});

$('#submit_photos').live('click',function(event){
	event.preventDefault();
	var file_name = '';
	$('#transport_photo').val('');
	var transport_video_link = $('#transport_video_link').val();
	
	$('.table-striped tr').each(function() {
    var transport_photos = $(this).find('td p a').text(); 
	if(transport_photos!='')
	{  
		if (file_name == '') {
				file_name += transport_photos;
		}else{
				file_name += ',' + transport_photos; 
		}
	}
	});
	$('#transport_photo').val(file_name);
	
	if(file_name == "" && transport_video_link == "") {
		alert("Please attach photo(s)/video link.")
		return false;
	} else {
		var video_check = true;
		if(transport_video_link != "")
		{
			video_check = parseTransportVideoURL(transport_video_link);
		}
		if(video_check)
		{
			$('#submit_photos').hide();
			$('#cancel_transport_photo').hide();
			//document.transport_photos.submit();
			$('#loadimg_upload').show();
			$('#loadimgphoto').show();
			$("#transport_photos").submit();
			return true;
		}
	}
});

function parseTransportVideoURL(url) {

    function getParm(url, base) {
            var re = new RegExp("(\\?|&)" + base + "\\=([^&]*)(&|$)");
            var matches = url.match(re);
            if (matches) {
                return(matches[2]);
            } else {
                return("");
            }
        }

        var retVal = {};
        var matches;
        var success = false;

        if ( url.match('http(s)?://(www.)?youtube|youtu\.be') ) {
          if (url.match('embed')) { retVal.id = url.split(/embed\//)[1].split('"')[0]; }
            else { retVal.id = url.split(/v\/|v=|youtu\.be\//)[1].split(/[?&]/)[0]; }
            retVal.provider = "youtube";
            var videoUrl = 'https://www.youtube.com/embed/'+ retVal.id + '?rel=0';
            $('#transport_video_img_link').val(videoUrl);
			$('#transport_video_provider').val(retVal.provider);
			$('#transport_video_id').val(retVal.id); 
			success = true;
        } else if (matches = url.match(/vimeo.com\/(\d+)/)) {
            retVal.provider = "vimeo";
            retVal.id = matches[1];
            var videoUrl = 'http://player.vimeo.com/video/' + retVal.id;
			$('#transport_video_img_link').val(videoUrl); 
			$('#transport_video_provider').val(retVal.provider);
			$('#transport_video_id').val(retVal.id); 
			success = true;
        }

      if (success) {
        //alert(retVal.id);
		//var img_url = $.trim("http://i.ytimg.com/vi/"+$.trim(retVal.id)+"/1.jpg");
		//$('#story_video_link').val(img_url);
		//return retVal;
		return true;		
      }
      else { 
	  alert("Please enter valid video link."); 
	  $('#transport_video_link').val(''); 
	  return false; 
	  }
}	
	
</script> 
<!-- END PAGE LEVEL SCRIPTS --> 
<script type="text/javascript">

var decodeEntities = (function () {
        //create a new html document (doesn't execute script tags in child elements)
        var doc = document.implementation.createHTMLDocument("");
        var element = doc.createElement('div');

        function getText(str) {
            element.innerHTML = str;
            str = element.textContent;
            element.textContent = '';
            return str;
        }

        function decodeHTMLEntities(str) {
            if (str && typeof str === 'string') {
                var x = getText(str);
                while (str !== x) {
                    str = x;
                    x = getText(x);
                }
                return x;
            }
        }
        return decodeHTMLEntities;
    })();
	
$(document).ready(function(){
	
	$('#message').autocomplete ({
		source:"<?php echo base_url(); ?>org_transportation/get_transport_feed_users/", 
		minLength:2,
		//autoFocus:true,
		focus: function( event, ui ) {
			var name = decodeEntities(ui.item.label);
			var usertext ='';
			 usertext = decodeEntities(ui.item.usertext);
			//console.log(name);
			//var name = ui.item.value;
			//$( "#message" ).val(name);
			var strremove;
			if(usertext){
			$("#message" ).val(usertext+'@'+name+' ');
			strremove = '@'+name+' ';
			}else {
			$("#message" ).val('@'+name+': ');
			strremove = '@'+name+': ';
			}
			$("#user_string").val(strremove);
			$("#user_name_hidden").val(name);
			$('#auto_user_email').val(ui.item.email);
			$('#user_id').val(ui.item.user_id);
			return false;
		},     
		select: function( event, ui ) {
			var name = decodeEntities(ui.item.label);
			var usertext ='';
			usertext = decodeEntities(ui.item.usertext);
			var strremove;
			if(usertext){
			//var name = ui.item.value;
			$("#message" ).val(usertext+'@'+name+' ');
			strremove = '@'+name+' ';
			}else {
			$("#message" ).val('@'+name+': ');	
			strremove = '@'+name+': ';	
			}
			$("#user_name_hidden").val(name);
			$('#auto_user_email').val(ui.item.email);
			$('#user_id').val(ui.item.user_id);
			return false;
		}
	}).data( "ui-autocomplete" )._renderItem = function( ul, item ) {
        var inner_html = '<a><div class="list_item_container"><span class="image"><img src="<?php echo base_url(); ?>upload/profile/29x29/' + item.image + '"></span><span class="feed-name">' + item.label + '</span></div></a>';
        return $( "<li></li>" )
            .data( "item.autocomplete", item )
            .append(inner_html)
            .appendTo( ul );
    };
	
	/*
	$(window).resize(function() {
		$('.ui-autocomplete').hide();
	});*/
});
</script>

<script>            
	jQuery(document).ready(function() {
		var offset = 220;
		var duration = 500;
		jQuery(window).scroll(function() {
			if (jQuery(this).scrollTop() > offset) {
				jQuery('.crunchify-top').fadeIn(duration);
			} else {
				jQuery('.crunchify-top').fadeOut(duration);
			}
		});
 
		jQuery('.crunchify-top').click(function(event) {
			event.preventDefault();
			jQuery('html, body').animate({scrollTop: 0}, duration);
			return false;
		})
		
			var isMobile = {
			Android: function() {
				return navigator.userAgent.match(/Android/i);
			},
			BlackBerry: function() {
				return navigator.userAgent.match(/BlackBerry/i);
			},
			iOS: function() {
				return navigator.userAgent.match(/iPhone|iPad|iPod/i);
			},
			Opera: function() {
				return navigator.userAgent.match(/Opera Mini/i);
			},
			Windows: function() {
				return navigator.userAgent.match(/IEMobile/i);
			},
			any: function() {
				return (isMobile.Android() || isMobile.BlackBerry() || isMobile.iOS() || isMobile.Opera() || isMobile.Windows());
			}
		};
		
		if(isMobile.any()) {
			//alert('this is mobile');
			$('#crunchify-top').addClass('crunchify-top-display-important');	
			$('#crunchify-top').removeClass('crunchify-top-hide-important');	
				
		}else{
			//alert('this is not mobile');
			$('#crunchify-top').removeClass('crunchify-top-display-important');
			$('#crunchify-top').addClass('crunchify-top-hide-important');			
			} 
	});
		$('#select-action').on('change', function() {
		  var value = $(this).val();
		  //alert(value);
		  if(value == 0)
		  {
			return false;
		  }
		  else if(value == 1)
		  {
			//alert('add animal');
			window.location = '<?php echo base_url(); ?>add-animal-transport/<?php echo $this->session->userdata('transport_id'); ?>';
		  }
		  else if(value == 2)
		  {
			//alert('edit date');
			$('#portlet-config').modal('show');
		  }
		  else if(value == 3)
		  {
			//alert('edit transport');
			window.location = '<?php echo base_url(); ?>org-edit-transport';
		  }
		  else if(value == 4)
		  {
			//alert('cancel transport');
			if(confirm('Are you sure you want to cancel transportation?'))
			{
				$('#cancel-transport-description').modal('show');
				//$('#cancel_transport').submit();
			}else{ 
			    $('#select-action').val('0');
				return false; 
			}
		  }
		  else if(value == 5)
		  {
			//alert('edit legs');
			window.location = '<?php echo base_url(); ?>transport-create-legs/';
		  }
		});
</script>
<script>
$('#close_cancel_desc').live('click',function(e){
	$('#cancel-transport-description').modal('hide');
	 $('#select-action').val('0');
}); 
$('#reason-cancel-transport').live('click',function(e){
var cancel_msg = $('#cancelmessage').val();	
var error_msg=0;
if(cancel_msg=='')
{
	error_msg =1;
	alert('Please enter the message');
}
if(error_msg == 0)
{	
	$('#cancel-transport-description').modal('hide');
	$('#transport_loader').modal('show');
	$('#cancel_trans_text').val(cancel_msg);	
	$('#cancel_transport').submit();
}
});
</script>

<?php /*?><script src="<?php echo base_url(); ?>assets/plugins/bootstrap-hover-dropdown/bootstrap-hover-dropdown.min.js" type="text/javascript"></script> 
<!-- END CORE PLUGINS --> 
<!-- BEGIN PAGE LEVEL PLUGINS --> 
<script type="text/javascript" src="<?php echo base_url(); ?>assets/plugins/bootstrap-select/bootstrap-select.min.js"></script> 
<script type="text/javascript" src="<?php echo base_url(); ?>assets/plugins/select2/select2.min.js"></script> 
<script type="text/javascript" src="<?php echo base_url(); ?>assets/plugins/jquery-multi-select/js/jquery.multi-select.js"></script> 
<!-- END PAGE LEVEL PLUGINS --> 
<!-- BEGIN PAGE LEVEL SCRIPTS --> 

<script src="<?php echo base_url(); ?>assets/scripts/custom/components-dropdowns.js"></script> 
<!-- END PAGE LEVEL SCRIPTS --> 
<script>
        jQuery(document).ready(function() {       
           // initiate layout and plugins
           //App.init();
           ComponentsDropdowns.init();
        });   
</script><?php */?>

<script>
$(window).on('load', function () {
	//$("#main-transportation-route").height($("#leftheight").height());
	$("#transport-legs-detail").height($("#leg-inner-cont").height());
})
$( window ).resize(function() {
  //$("#main-transportation-route").height($("#leftheight").height());
  $("#transport-legs-detail").height($("#leg-inner-cont").height());
})
</script>


<script>
equalheight = function(container){

var currentTallest = 0,
     currentRowStart = 0,
     rowDivs = new Array(),
     $el,
     topPosition = 0;
 $(container).each(function() {

   $el = $(this);
   $($el).height('auto')
   topPostion = $el.position().top;

   if (currentRowStart != topPostion) {
     for (currentDiv = 0 ; currentDiv < rowDivs.length ; currentDiv++) {
       rowDivs[currentDiv].height(currentTallest);
     }
     rowDivs.length = 0; // empty the array
     currentRowStart = topPostion;
     currentTallest = $el.height();
     rowDivs.push($el);
   } else {
     rowDivs.push($el);
     currentTallest = (currentTallest < $el.height()) ? ($el.height()) : (currentTallest);
  }
   for (currentDiv = 0 ; currentDiv < rowDivs.length ; currentDiv++) {
     rowDivs[currentDiv].height(currentTallest);
   }
 });
}

$(window).on('load', function () {
  equalheight('.transport-legs-detail h3');
});

$(window).resize(function(){
  equalheight('.transport-legs-detail h3');
});
</script>

<script>
$(document).ready(function () {
	
  function FirstSlider(){
    var divs = $('.div1>div');
    var now = 0; // currently shown div
    console.log(divs);
    divs.hide().first().show(); // hide all divs except first
    $(".nex1").click(function () {
        divs.eq(now).hide();
		now = (now > 0) ? now - 1 : divs.length - 1;
        //now = (now + 1 < divs.length) ? now + 1 : 0;
        divs.eq(now).show(); // show previous
    });
    $(".pre1").click(function () {
        divs.eq(now).hide();
		now = (now + 1 < divs.length) ? now + 1 : 0;
        //now = (now > 0) ? now - 1 : divs.length - 1;
        divs.eq(now).show(); // show next
    });
  }

  
    FirstSlider();
});
</script>
<script>

jQuery(document).ready(function() {
var numVolunteers = $('.volunteered-box-info').length;
//alert('numVolunteers'+numVolunteers);
$("#volunteer_counts").html('('+numVolunteers+')');
});

jQuery(document).ready(function() { 

	<?php  if($this->session->flashdata('success_transport_info')): ?>
		$('#success_transport_info_popup').modal('show');		
	<?php endif; ?>
  
   $("#pick_up_location,#pick_street,#drop_off_location,#drop_street,#contact_name,#contact_email,#note-comments,#pickup_airport,#dropoff_airport,#contact_name_avia,#contact_email_avia,#note_comments_avia").val("");
   
		$('#recommend_leg').validate({
					errorElement: 'span', //default input error message container
					errorClass: 'help-block', // default input error message class
					focusInvalid: true, // do not focus the last invalid input
					rules: {
						pick_up_location: {
							required: true
						},
						drop_off_location: {
							required: true
						},
						contact_name: {
							required: {
								depends: function(){
										if($('#recommend_user_id').val() == ''){ 
											return true;
										} else {
											return false;
										}
									}
								}
						},
						contact_email: {
							required: {
								depends: function(){
										if($('#recommend_user_id').val() == ''){ 
											return true;
										} else {
											return false;
										}
									}
								}
						}
					},
			
					messages: {
						pick_up_location: {
							required: 'Please Enter Pick Up Location.'
						},
						drop_off_location: {
							required: 'Please Enter Drop Off Location.'
						},
						contact_name: {
							required: 'Please Enter Your Name.'
						},
						contact_email: {
							required: 'Please Enter Your Email.'
						}
					},
			
					invalidHandler: function (event, validator) { //display error alert on form submit   
						$('#suggest_leg').show();
						
						var errors = validator.numberOfInvalids();
						if (errors) {
						  var message = errors == 1
							? 'You missed 1 field. It has been highlighted'
							: 'You missed ' + errors + ' fields. They have been highlighted';
						  alert(message);
						}
					},
			
					highlight: function (element) { // hightlight error inputs
						$(element)
							.closest('.form-group').addClass('has-error'); // set error class to the control group
					},
			
					success: function (label) { //alert(label);
						label.closest('.form-group').removeClass('has-error');
						label.remove();
					},
			
					errorPlacement: function (error, element) { 
						error.addClass('help-block').insertAfter(element.closest('.form-control'));
					}
			
				});
        
		

		$('#suggest_leg').live('click',function(){
			//alert('validate suggest leg');
	if($('#recommend_leg').valid() == false) {
		return false;
	} else {
		$('#suggest_leg').hide();
		
		if($.browser.msie) {
				$('.display_loader').html('<img id="loadimg" src="<?php echo base_url(); ?>assets/img/ajax-loading.gif" alt="loader" />');
			}
		$('.display_loader').show();
		
		$('#loadimg_mail').show();
		$('#email-config').modal('hide');
		
		if($.browser.msie) {
			$('.display_loader').html('<div id="loader" style="display: none;"><img src="<?php echo base_url(); ?>assets/img/ajax-modal-loading.gif" width="32" height="32" align="absmiddle">&nbsp;<span id="loadertext">Loading...</span></div>');
		}
		
		$('.display_loader').show();
		$('#loader').show();
	}
	});   
	
	
	$('#recommend_leg_avia').validate({
					errorElement: 'span', //default input error message container
					errorClass: 'help-block', // default input error message class
					focusInvalid: true, // do not focus the last invalid input
					rules: {
						pickup_airport: {
							required: true
						},
						dropoff_airport: {
							required: true
						},
						contact_name_avia: {
							required: {
								depends: function(){
										if($('#recommend_user_id_avia').val() == ''){ 
											return true;
										} else {
											return false;
										}
									}
								}
						},
						contact_email_avia: {
							required: {
								depends: function(){
										if($('#recommend_user_id_avia').val() == ''){ 
											return true;
										} else {
											return false;
										}
									}
								}
						}
					},
			
					messages: {
						pickup_airport: {
							required: 'Please Enter From Location.'
						},
						dropoff_airport: {
							required: 'Please Enter To Location.'
						},
						contact_name_avia: {
							required: 'Please Enter Your Name.'
						},
						contact_email_avia: {
							required: 'Please Enter Your Email.'
						}
					},
			
					invalidHandler: function (event, validator) { //display error alert on form submit   
						$('#suggest_leg').show();
						
						var errors = validator.numberOfInvalids();
						if (errors) {
						  var message = errors == 1
							? 'You missed 1 field. It has been highlighted'
							: 'You missed ' + errors + ' fields. They have been highlighted';
						  alert(message);
						}
					},
			
					highlight: function (element) { // hightlight error inputs
						$(element)
							.closest('.form-group').addClass('has-error'); // set error class to the control group
					},
			
					success: function (label) { //alert(label);
						label.closest('.form-group').removeClass('has-error');
						label.remove();
					},
			
					errorPlacement: function (error, element) { 
						error.addClass('help-block').insertAfter(element.closest('.form-control'));
					}
			
				});
        
		

		$('#suggest_leg_aviation').live('click',function(){
			//alert('validate suggest leg aviation');
	if($('#recommend_leg_avia').valid() == false) {
		return false;
	} else {
		$('#suggest_leg').hide();
		
		if($.browser.msie) {
				$('.display_loader').html('<img id="loadimg" src="<?php echo base_url(); ?>assets/img/ajax-loading.gif" alt="loader" />');
			}
		$('.display_loader').show();
		
		$('#loadimg_mail').show();
		$('#email-config').modal('hide');
		
		if($.browser.msie) {
			$('.display_loader').html('<div id="loader" style="display: none;"><img src="<?php echo base_url(); ?>assets/img/ajax-modal-loading.gif" width="32" height="32" align="absmiddle">&nbsp;<span id="loadertext">Loading...</span></div>');
		}
		
		$('.display_loader').show();
		$('#loader').show();
	}
	});   
	
	
	$('#pick_up_location').autocomplete ({
	source: function (request, response)
    {
		request.term = $.trim(request.term);
		var str	= request.term;
		var letters = /^[a-zA-Z ]+$/;	
		if(str.match(letters))
		{
			request.term = str; 
		} else {
			str = str.toUpperCase();
			request.term = str.replace(/\s/g, ''); 
		}
        $.ajax(
        {
            url: "<?php echo base_url(); ?>org_transportation/get_zip_code2/" ,
            dataType: "json",
			//async:false,
            data:
            {
                term: request.term,
				city: $("#pick_city" ).val(),
				state: $("#pickup_state" ).val()
            },
            success: function (data)
            {
				if(data=="1")
				{
					window.location.href="<?php echo base_url() ?>";
				}
				else
				{
                	response(data);
				}
            }
        });
    },
	minLength:1,
	open: function() { $('.ui-menu').width($("#pick_up_location" ).width()) },
	focus: function( event, ui ) {
			var id = ui.item.label;
			var name = ui.item.value;
			$("#pick_up_location" ).val(name);
			$("#pick_zip" ).val(name);
			$("#pick_country" ).val(ui.item.st_country);
			country_state(ui.item.st_country,"pick");
			$("#pick_city").val(ui.item.city);
			$("#pickup_state").val(ui.item.state_prefix);	
			return false;			
	},     
	select: function( event, ui ) {
		var id = ui.item.label;
		var name = ui.item.value;
		$("#pick_zip" ).val(name);
		$("#pick_up_location" ).val(id);
		$("#pick_country" ).val(ui.item.st_country);
		country_state(ui.item.st_country,"pick");
		$("#pick_city" ).val(ui.item.city);
		$("#pickup_state" ).val(ui.item.state_prefix);
		return false;
	}
	});

	$('#pick_up_location').live('change',function(){
	//var selected_zipcode = $(this).val();
	var selected_zipcode = $.trim($(this).val());
	var str	= selected_zipcode; 
	//selected_zipcode = str.replace(/\s/g, '');
	var letters = /^[a-zA-Z ]+$/;	
	if(str.match(letters))
	{
			 selected_zipcode = str; 
	} else {
			 str = str.toUpperCase();  	
			 selected_zipcode = str.replace(/\s/g, ''); 
	}	
	//alert(selected_zipcode);
	//alert($("#pick_city" ).val());
	var select_pickup_city = $("#pick_city" ).val();
	//alert(select_pickup_city);
	var select_pickup_state = $("#pickup_state" ).val();
	//alert(select_pickup_state);
	var select_pickup_country = $("#pick_country" ).val();
	//alert(select_pickup_country);
	//alert($("#pick_zip").val());
	//alert($("#pick_zip").val().indexOf(','));

	if ($("#pick_up_location").val().indexOf(',') != -1 && $("#pick_up_location").val().indexOf('USA') != -1 && $("#pick_up_location").val().indexOf('Canada') != -1) {
		if(selected_zipcode != '' && select_pickup_city != '' && select_pickup_state != '' && select_pickup_country != '')
		{
			$("#pick_up_location").val(selected_zipcode+', '+select_pickup_city+', '+select_pickup_state+', '+select_pickup_country);
		}
	}
	else
	{
			if(selected_zipcode!=''){
		$.ajax({
				url: "<?php echo base_url(); ?>org_transportation/get_zip_code2/" ,
				dataType: "json",
				async:false,
				data:
				{
					term: selected_zipcode,
					city: $("#pick_city" ).val(),
					state: $("#pickup_state" ).val()
				},
				success: function (data)
				{
					//alert(data);
					//alert(data.length);
					//console.log(data);
					//console.log(data[0].label);
					if(data)
					{
					$("#pick_up_location").val(data[0].label);
					$("#pick_zip").val(data[0].value);
					$("#pick_country").val(data[0].st_country);
					country_state(data[0].st_country,"pick");
					$("#pick_city").val(data[0].city);
					$("#pickup_state").val(data[0].state_prefix);
					}
					else
					{
						if($("#pick_up_location").val().indexOf(',') == -1)
						{
							alert('Please enter valid from location');	
							$("#pick_up_location").val("");
						}
					}
				}
			});		
		}//!=''
	}
	});
	
	
	
	$('#drop_off_location').autocomplete ({
	source: function (request, response)
    {
		request.term = $.trim(request.term);
		var str	= request.term;
		var letters = /^[a-zA-Z ]+$/;	
		if(str.match(letters))
		{
			request.term = str; 
		} else {
			str = str.toUpperCase();
			request.term = str.replace(/\s/g, ''); 
		}
        $.ajax(
        {
            url: "<?php echo base_url(); ?>org_transportation/get_zip_code2/" ,
            dataType: "json",
            data:
            {
                term: request.term,
				city: $("#drop_city" ).val(),
				state: $("#drop_state" ).val()
            },
            success: function (data)
            {
				if(data=="1")
				{
					window.location.href="<?php echo base_url() ?>";
				}
				else
				{
                	response(data);
				}
            }
        });
    },
	minLength:1,
	open: function() { $('.ui-menu').width($("#drop_off_location" ).width()) },
	focus: function( event, ui ) {
			var id = ui.item.label;
			var name = ui.item.value;
			$("#drop_off_location" ).val(name);
			$("#drop_zip" ).val(name);
			$("#drop_country" ).val(ui.item.st_country);
			country_state(ui.item.st_country,"pick");
			$("#drop_city" ).val(ui.item.city);
			$("#drop_state" ).val(ui.item.state_prefix);
			
			return false;
	},     
	select: function( event, ui ) {
		var id = ui.item.label;
		var name = ui.item.value;
		//$("#pick_zip" ).val(name);
		$("#drop_off_location" ).val(id);
		$("#drop_zip" ).val(name);
		$("#drop_country" ).val(ui.item.st_country);
		country_state(ui.item.st_country,"pick");
		$("#drop_city" ).val(ui.item.city);
		$("#drop_state" ).val(ui.item.state_prefix);
		
		return false;
	}
	});
	
	
	$('#drop_off_location').live('change',function(){
	//var selected_zipcode = $(this).val();
	var selected_zipcode = $.trim($(this).val());
	var str	= selected_zipcode; 
	//selected_zipcode = str.replace(/\s/g, ''); 
	var letters = /^[a-zA-Z ]+$/;	
	if(str.match(letters))
	{
			 selected_zipcode = str; 
	} else {
			 str = str.toUpperCase();  	
			 selected_zipcode = str.replace(/\s/g, ''); 
	}
//alert(selected_zipcode);
//alert($("#drop_city" ).val());
var select_dropoff_city = $("#drop_city" ).val();
//alert(select_dropoff_city);
var select_dropoff_state = $("#drop_state" ).val();
//alert(select_dropoff_state);
var select_dropoff_country = $("#drop_country" ).val();
//alert(select_dropoff_country);

//alert($("#drop_zip").val().indexOf(','));
if ($("#drop_off_location").val().indexOf(',') != -1 && $("#drop_off_location").val().indexOf('USA') != -1 && $("#drop_off_location").val().indexOf('Canada') != -1) {
	if(selected_zipcode != '' && select_dropoff_city != '' && select_dropoff_state != '' && select_dropoff_country != '')
	{
		$("#drop_off_location").val(selected_zipcode+', '+select_dropoff_city+', '+select_dropoff_state+', '+select_dropoff_country);
	}
}
else
{
	if(selected_zipcode!=''){
	$.ajax({
            url: "<?php echo base_url(); ?>org_transportation/get_zip_code2/" ,
            dataType: "json",
            data:
            {
                term: selected_zipcode,
				city: $("#drop_city" ).val(),
				state: $("#drop_state" ).val()
            },
            success: function (data)
            {
				//alert(data);
				//alert(data.length);
				//console.log(data);
				//console.log(data[0].label);
				if(data)
				{
				$("#drop_off_location" ).val(data[0].label);
				$("#drop_zip" ).val(data[0].value);
				$("#drop_country").val(data[0].st_country);
				country_state(data[0].st_country,"drop");
				$("#drop_city" ).val(data[0].city);
				$("#drop_state" ).val(data[0].state_prefix);
				}
				else
				{
					if($("#drop_off_location").val().indexOf(',') == -1)
					{
						alert('Please enter valid to location');
						$("#drop_off_location").val("");
					}
				}
            }
        });		
	}//!=''	
}
});


$('#pickup_airport').autocomplete ({
		source: function (request, response)
   		 {
			request.term = $.trim(request.term);
			var str	= request.term;
			var letters = /^[a-zA-Z ]+$/;	
			if(str.match(letters))
			{
				request.term = str; 
			} else {
				str = str.toUpperCase();
				request.term = str.replace(/\s/g, ''); 
			} 
			$.ajax(
			{
				//url: "<?php echo base_url(); ?>org_transportation/get_airports_by_zipcode/" ,
				url: "<?php echo base_url(); ?>org_transportation/get_airports_by_zipcode_or_airport_id/" ,
				dataType: "json",
				data:
				{
					term: request.term
				},
				success: function (data)
				{
					//alert(data);
					//return false;
					//response(data);
					if(data=="1")
					{
						window.location.href="<?php echo base_url() ?>";
					}
					/*if(data == null || data === '')
					{
						alert('Please enter valid from Zipcode/Airport ID');
						$("#pickup_airport").val('');
					}*/
					//else
					if(1)
					{
						response(data);
					}
					
				}
			});
  	  	},
		minLength:1,
		open: function() { $('.ui-menu').width($("#pickup_airport" ).width()) },
		focus: function( event, ui ) {
				var id = ui.item.label;
				//alert(id);
				var name = ui.item.value;
				$( "#pickup_airport" ).val(name);
				$( "#pickup_airport_state" ).val(ui.item.st_state);
				$( "#pickup_airport_city" ).val(ui.item.st_city);
				return false;
		},     
		select: function( event, ui ) {
			var id = ui.item.label;
			var name = ui.item.value;
			$("#pickup_airport" ).val(name);
			$("#pickup_airport_state" ).val(ui.item.st_state);
			$("#pickup_airport_city" ).val(ui.item.st_city);
			return false;
		}
	});	
	
$('#pickup_airport').live('change',function(){
//var selected_zipcode = $(this).val();
var selected_zipcode = $.trim($(this).val());
var str	= selected_zipcode; 
//selected_zipcode = str.replace(/\s/g, ''); 
var letters = /^[a-zA-Z ]+$/;	
if(str.match(letters))
{
			 selected_zipcode = str; 
} else {
			 str = str.toUpperCase();  	
			 selected_zipcode = str.replace(/\s/g, ''); 
}
//alert($("#pick_city" ).val());
var select_pickup_city = $("#pickup_airport_city" ).val();
//alert(select_pickup_city);
var select_pickup_state = $("#pickup_airport_state" ).val();
//alert(select_pickup_state);
//var select_pickup_country = $("#pickup_country" ).val();
//alert(select_pickup_country);
//alert($("#pick_zip").val());
//alert($("#pick_zip").val().indexOf(','));

if ($("#pickup_airport").val().indexOf(',') != -1 && $("#pickup_airport").val().indexOf('USA') != -1 && $("#pickup_airport").val().indexOf('Canada') != -1) {
	if(selected_zipcode != '' && select_pickup_city != '' && select_pickup_state != '' && select_pickup_country != '')
	{
		//$("#pickup_location").val(selected_zipcode+', '+select_pickup_city+', '+select_pickup_state+', '+select_pickup_country);
	}
}
else
{
	if(selected_zipcode!=''){
	  $.ajax({
            url: "<?php echo base_url(); ?>org_transportation/get_airports_by_zipcode_or_airport_id/" ,
            dataType: "json",
            data:
            {
                term: selected_zipcode,
				city: $("#pickup_airport_city" ).val(),
				state: $("#pickup_airport_state" ).val()
            },
            success: function (data)
            {
				//alert(data);
				//alert(data.length);
				//console.log(data);
				//console.log(data[0].label);
				if(data)
				{
				var name = data[0].label;
				//alert(name);
				$( "#pickup_airport" ).val(data[0].label);
				$( "#pickup_airport_state" ).val(data[0].st_state);
				$( "#pickup_airport_city" ).val(data[0].st_city);
				}
				else
				{
					if(data == null || data === '')
					{
						alert('Please enter valid from location');
						$("#pickup_airport").val('');
					}
				}
				
            }
        });	
	}//!='' 		
}
});
	
	$('#dropoff_airport').autocomplete ({
		source: function (request, response)
   		 {
			request.term = $.trim(request.term);
			var str	= request.term;
			var letters = /^[a-zA-Z ]+$/;	
			if(str.match(letters))
			{
				request.term = str; 
			} else {
				str = str.toUpperCase();
				request.term = str.replace(/\s/g, ''); 
			} 
			$.ajax(
			{
				url: "<?php echo base_url(); ?>org_transportation/get_airports_by_zipcode_or_airport_id/" ,
				dataType: "json",
				data:
				{
					term: request.term
				},
				success: function (data)
				{
					if(data=="1")
					{
						window.location.href="<?php echo base_url() ?>";
					}
					/*if(data == null || data === '')
					{
						alert('Please enter valid to Zipcode/Airport ID');
						$("#dropoff_airport").val('');
					}*/
					//else
					if(1)
					{
						response(data);
					}
				}
			});
  	  	}, 
		minLength:1,
		open: function() { $('.ui-menu').width($("#dropoff_airport" ).width()) },
		focus: function( event, ui ) {
				var id = ui.item.label;
				var name = ui.item.value;
				$("#dropoff_airport" ).val(name);
				$("#dropoff_airport_state" ).val(ui.item.st_state);
				$("#dropoff_airport_city" ).val(ui.item.st_city);
				return false;
		},     
		select: function( event, ui ) {
			var id = ui.item.label;
			var name = ui.item.value;
			$("#dropoff_airport" ).val(name);
			$("#dropoff_airport_state" ).val(ui.item.st_state);
			$("#dropoff_airport_city" ).val(ui.item.st_city);
			return false;
		}
	});	
	
$('#dropoff_airport').live('change',function(){
//var selected_zipcode = $(this).val();
var selected_zipcode = $.trim($(this).val());
var str	= selected_zipcode; 
//selected_zipcode = str.replace(/\s/g, ''); 
var letters = /^[a-zA-Z ]+$/;	
if(str.match(letters))
{
			 selected_zipcode = str; 
} else {
			 str = str.toUpperCase();  	
			 selected_zipcode = str.replace(/\s/g, ''); 
}

//alert($("#pick_city" ).val());
var select_pickup_city = $("#dropoff_airport_city" ).val();
//alert(select_pickup_city);
var select_pickup_state = $("#dropoff_airport_state" ).val();
//alert(select_pickup_state);
//var select_pickup_country = $("#pickup_country" ).val();
//alert(select_pickup_country);
//alert($("#pick_zip").val());
//alert($("#pick_zip").val().indexOf(','));

if ($("#dropoff_airport").val().indexOf(',') != -1 && $("#dropoff_airport").val().indexOf('USA') != -1 && $("#dropoff_airport").val().indexOf('Canada') != -1) {
	if(selected_zipcode != '' && select_pickup_city != '' && select_pickup_state != '' && select_pickup_country != '')
	{
		//$("#pickup_location").val(selected_zipcode+', '+select_pickup_city+', '+select_pickup_state+', '+select_pickup_country);
	}
}
else
{
	if(selected_zipcode!=''){
	  $.ajax({
            url: "<?php echo base_url(); ?>org_transportation/get_airports_by_zipcode_or_airport_id/" ,
            dataType: "json",
            data:
            {
                term: selected_zipcode,
				city: $("#dropoff_airport_city" ).val(),
				state: $("#dropoff_airport_state" ).val()
            },
            success: function (data)
            {
				//alert(data);
				//alert(data.length);
				//console.log(data);
				//console.log(data[0].label);
				if(data)
				{
				var name = data[0].label;
				//alert(name);
				$( "#dropoff_airport" ).val(data[0].label);
				$( "#dropoff_airport_state" ).val(data[0].st_state);
				$( "#dropoff_airport_city" ).val(data[0].st_city);
				}
				else
				{
					if(data == null || data === '')
					{
						alert('Please enter valid to location');
						$("#dropoff_airport").val('');
					}
				}
				
            }
        });	
	}// !=''		
}
});

	
	$('#update_transport_info').live('click',function(){
	
	var file_name = '';
	$('#image_file_update').val('');
	$('.table-striped tr').each(function() {
	var image_files = $(this).find('td p a').text(); 
	if(image_files!='')
	{  
		if (file_name == '') {
				file_name += image_files;
		}else{
				file_name += ',' + image_files; 
		}
	}
	});
	$('#image_file_update').val(file_name);
	
	if($('#modified_by').val() == '0' && $('#additional-comments-update').val() == ""  && $('#image_file_update').val() == "" && $('#transport_info_files_cnt').val() == 0) {
		alert("Please enter comments/upload files.");
		return false;
	} else {
		$('#update_transport_info').hide();
		
		if($.browser.msie) {
				$('.display_loader').html('<img id="loadimg" src="<?php echo base_url(); ?>assets/img/ajax-loading.gif" alt="loader" />');
			}
		$('.display_loader').show();
		
		$('#loadimg_mail').show();
		$('#edit-additional-info').modal('hide');
		
		if($.browser.msie) {
			$('.display_loader').html('<div id="loader" style="display: none;"><img src="<?php echo base_url(); ?>assets/img/ajax-modal-loading.gif" width="32" height="32" align="absmiddle">&nbsp;<span id="loadertext">Loading...</span></div>');
		}
		
		$('.display_loader').show();
		$('#loader').show();		
		$('#transport_update_info').submit();
	}
	});   
	
	}); 
	
	
	function change_origin_details()
{
	if($("#pick_city").val() == '')
	{
		alert('Please enter city name.');
		return false;
	}
	if($("#pickup_state").val() == '')
	{
		alert('Please select state name.');
		return false;
	}
	if($("#popup_zipcode").val() == '')
	{
		alert('Origin zip code is required.');
		return false;
	}	
	//alert($('#pick_country').val());
	//$('#pick_zip').val($('#popup_zipcode').val()+", "+$('#pick_city').val()+", "+$('#pick_state').val()+", "+$('#pick_country').val());
	//$('#pick_zip').val($('#zipcode_list').val()+", "+$('#pick_city').val()+", "+$('#pick_state').val()+", "+$('#pick_country').val());	
	//$('#pick_up_location').val($('#zipcode_list').val()+", "+$('#pick_city').val()+", "+$('#pickup_state').val()+", "+$('#pick_country').val());
	$('#pick_up_location').val($('#zipcode_list').val()+", "+$('#pick_city').val()+", "+$('#pickup_state').val());	
	$('#zip-search').modal('hide');
	//$('#pick_city').val('');
	//$('#pick_state').val('');
	//$('#pick_country').val('');
	$('#popup_zipcode').val('');
	$('#popup_zip_div').show();
	var str_zipcode1 = '<input type="text" readonly="" name="popup_zipcode" id="popup_zipcode" class="form-control display-zipcode" placeholder="Zip code will appear here">';
	$('#popup_zip_div').html(str_zipcode1);	
	
}


function change_destination_details()
{   
	if($("#drop_city").val() == '')
	{
		alert('Please enter city name.');
		return false;
	}
	if($("#drop_state").val() == '')
	{
		alert('Please select state name.');
		return false;
	}
	if($("#popup_zipcode_drop").val() == '')
	{
		alert('Destination zip code is required.');
		return false;
	}
	//$('#drop_zip').val($('#popup_zipcode').val()+", "+$('#pick_city').val()+", "+$('#pick_state').val()+", "+$('#pick_country').val());
	//$('#drop_off_location').val($('#zipcode_list').val()+", "+$('#drop_city').val()+", "+$('#drop_state').val()+", "+$('#drop_country').val());
	$('#drop_off_location').val($('#zipcode_list').val()+", "+$('#drop_city').val()+", "+$('#drop_state').val());
	$('#drop-zip-search').modal('hide');
	//$('#pick_city').val('');
	//$('#pick_state').val('');
	//$('#pick_country').val('');
	$('#popup_zipcode_drop').val('');
	$('#popup_zip_div').show();
	var str_zipcode1 = '<input type="text" readonly="" name="popup_zipcode_drop" id="popup_zipcode_drop" class="form-control display-zipcode" placeholder="Zip code will appear here">';
	$('#popup_zip_div_drop').html(str_zipcode1);	
	
}


function country_state(country_name,state_id)
{
			//var country_name = $(this).val();
			//var state_id = $(this).attr('data-address');
			var state_list = '';
			if(country_name == 'USA') {
					state_list += '<option value="">Select</option>';
					state_list += '<?php foreach($this->common_function->state_list as $key=>$val) { ?>';
					state_list += ' <option value="<?php echo $key; ?>"><?php echo $val;  ?></option>';
					state_list += '<?php } ?>';
				
			} else {
					state_list += '<option value="">Select</option>';
					state_list += '<?php foreach($this->common_function->canadian_state_list as $key=>$val) { ?>';
					state_list += ' <option value="<?php echo $key; ?>"><?php echo $val;  ?></option>';
					state_list += '<?php } ?>';
					
			}
			$('#'+state_id+'_state').html(state_list);
}

function get_zipcode(city,state,zip,country)
{
	//alert($("#"+city).val());
	//alert($("#"+state).val());
	
	if($("#"+city).val() == '')
	{
		alert('Please enter city name.');
		return false;
	}
	if($("#"+state).val() == '')
	{
		alert('Please select state name.');
		return false;
	}
	if($("#"+state).val()!='' && $("#"+city).val()!='')
	{
		
		$.ajax({
			  type: "POST",
			  url: '<?php echo base_url(); ?>org_transportation/get_zip_code_data/',
			  beforeSend: function(){
				 $('#loader').show();
			  },
			  data: {
				  state:$("#"+state).val(),
				  city:$("#"+city).val(),
				  action:"zip"
			  },
			  dataType:"json",
			  
			  complete: function(){
				$('#loader').hide();
			  },
			  success:function(data){
				  //alert(data.zipcodes);
					var arr_zipcodes = data.zipcodes;												
					//alert(arr_zipcodes.length);
					//return false;
					var str_zipcode = '';
					
					if(arr_zipcodes.length > 0) {
					str_zipcode += "<select name='zipcode_list' id='zipcode_list' class='form-control' style='width:100%;'>";	
						$.each( arr_zipcodes, function( key, value ) {	
							
							str_zipcode += "<option";
							str_zipcode += " value = "+value.zip_code+">";
							str_zipcode += value.zip_code;
							str_zipcode += "</option>";	
						});
						str_zipcode += "</select>";	
						//alert(str_zipcode);
						$('#popup_zip_div').html(str_zipcode);					
					} else {
						alert('Zip code not found for provided city/state.');
				return false;
					}
			  }	
		   });
	 	
	}
}


function get_zipcode_drop(city,state,zip,country)
{  
	//alert($("#"+city).val());
	//alert($("#"+state).val());
	if($("#"+city).val() == '')
	{
		alert('Please enter city name.');
		return false;
	}
	if($("#"+state).val() == '')
	{
		alert('Please select state name.');
		return false;
	}
	if($("#"+state).val()!='' && $("#"+city).val()!='')
	{
		
		$.ajax({
			  type: "POST",
			  url: '<?php echo base_url(); ?>org_transportation/get_zip_code_data/',
			  beforeSend: function(){
				 $('#loader').show();
			  },
			  data: {
				  state:$("#"+state).val(),
				  city:$("#"+city).val(),
				  action:"zip"
			  },
			  dataType:"json",
			  
			  complete: function(){
				$('#loader').hide();
			  },
			  success:function(data){
				  //alert(data.zipcodes);
					var arr_zipcodes = data.zipcodes;												
					//alert(arr_zipcodes.length);
					//return false;
					var str_zipcode = '';
					
					if(arr_zipcodes.length > 0) {
					str_zipcode += "<select name='zipcode_list' id='zipcode_list' class='form-control' style='width:40%;'>";	
						$.each( arr_zipcodes, function( key, value ) {	
							
							str_zipcode += "<option";
							str_zipcode += " value = "+value.zip_code+">";
							str_zipcode += value.zip_code;
							str_zipcode += "</option>";	
						});
						str_zipcode += "</select>";	
						//alert(str_zipcode);
						$('#popup_zip_div_drop').html(str_zipcode);					
					} else {
						alert('Zip code not found for provided city/state.');
				return false;
					}
			  }	
		   });	 	
	}
}
</script> 
<!--<script type="text/javascript">
function equalHeight(group) {
    tallest = 0;
    group.each(function() {
        thisHeight = $(this).height();
        if(thisHeight > tallest) {
            tallest = thisHeight;
        }
    });
    group.height(tallest);
}
 
$(document).ready(function(){
    equalHeight($(".leg-inner-cont"));
	//equalHeight($(".volunteer-middle-slider-part"));
});
</script>-->
<script>
$(window).smartresize(function() {
		jQuery(".gr-wrap .volunteered-box-info .top-part").height('auto');
	    jQuery(".gr-wrap .volunteered-box-info .volunteer-middle-slider-part").height('auto');
		jQuery(".gr-wrap .volunteered-box-info .bottom-part").height('auto');
      
        function equalHeight(group) {
            tallest = 0;
            group.each(function() {
                thisHeight = jQuery(this).height();
                if (thisHeight > tallest) {
                    tallest = thisHeight;
                }
            });
            group.height(tallest);
        }
		equalHeight(jQuery(".gr-wrap .volunteered-box-info .top-part"));
		equalHeight(jQuery(".gr-wrap .volunteered-box-info .volunteer-middle-slider-part"));
		equalHeight(jQuery(".gr-wrap .volunteered-box-info .bottom-part"));
    });
</script>
<script>
equalheight = function(container){

var currentTallest = 0,
     currentRowStart = 0,
     rowDivs = new Array(),
     $el,
     topPosition = 0;
 $(container).each(function() {

   $el = $(this);
   $($el).height('auto')
   topPostion = $el.position().top;

   if (currentRowStart != topPostion) {
     for (currentDiv = 0 ; currentDiv < rowDivs.length ; currentDiv++) {
       rowDivs[currentDiv].height(currentTallest);
     }
     rowDivs.length = 0; // empty the array
     currentRowStart = topPostion;
     currentTallest = $el.height();
     rowDivs.push($el);
   } else {
     rowDivs.push($el);
     currentTallest = (currentTallest < $el.height()) ? ($el.height()) : (currentTallest);
  }
   for (currentDiv = 0 ; currentDiv < rowDivs.length ; currentDiv++) {
     rowDivs[currentDiv].height(currentTallest);
   }
 });
}

$(window).on('load', function () {
  equalheight('#non_doobert_user_frm .form-group');
  setTimeout(function(){ $(window).trigger('resize'); }, 200);
});


$(window).resize(function(){
  equalheight('#non_doobert_user_frm .form-group');
  setTimeout(function(){ $(window).trigger('resize'); }, 200);
});
</script>
<script>
function resetdropdown()
{
$('#select-action').val('0');
}

$(document).ready(function(){

$('#submit_story').live('click',function(event) {
	event.preventDefault();
	if($('#rescue_transport_story_frm').valid() == false) {
		return false;
	} else {
		//alert('submit form true');
		var video_url = $('#story_video_link').val();
		var video_check = true;
		if(video_url != "")
		{
			video_check  = parseVideoURL(video_url);
			//return false;		
		}
		if(video_check)
		{
			var file_name = '';
			$('#rescue_transport_photo').val('');
			$('.table-striped tr').each(function() {
			var rescue_transport_photos = $(this).find('td p a').text(); 
			if(rescue_transport_photos!='')
			{  
				if (file_name == '') {
						file_name += rescue_transport_photos;
				}else{
						file_name += ',' + rescue_transport_photos; 
				}
			}
			});
			$('#rescue_transport_photo').val(file_name);
			$('#submit_story').hide();
			$('#cancel_rescue_story').hide();
			$('#loadimg').show();
			$('#rescue_transport_story_frm').submit();
			return true;
		}
	}
});

	
function parseVideoURL(url) {

    function getParm(url, base) {
            var re = new RegExp("(\\?|&)" + base + "\\=([^&]*)(&|$)");
            var matches = url.match(re);
            if (matches) {
                return(matches[2]);
            } else {
                return("");
            }
        }

        var retVal = {};
        var matches;
        var success = false;

        if ( url.match('http(s)?://(www.)?youtube|youtu\.be') ) {
          if (url.match('embed')) { retVal.id = url.split(/embed\//)[1].split('"')[0]; }
            else { retVal.id = url.split(/v\/|v=|youtu\.be\//)[1].split(/[?&]/)[0]; }
            retVal.provider = "youtube";
            var videoUrl = 'https://www.youtube.com/embed/' + retVal.id + '?rel=0';
            $('#story_video_img_link').val(videoUrl);
			$('#story_video_provider').val(retVal.provider);
			$('#story_video_id').val(retVal.id); 
			success = true;
        } else if (matches = url.match(/vimeo.com\/(\d+)/)) {
            retVal.provider = "vimeo";
            retVal.id = matches[1];
            var videoUrl = 'http://player.vimeo.com/video/' + retVal.id;
			$('#story_video_img_link').val(videoUrl); 
			$('#story_video_provider').val(retVal.provider);
			$('#story_video_id').val(retVal.id); 
			success = true;
        }

      if (success) {
        //alert(retVal.id);
		//var img_url = $.trim("http://i.ytimg.com/vi/"+$.trim(retVal.id)+"/1.jpg");
		//$('#story_video_link').val(img_url);
		//return retVal;
		return true;		
      }
      else { 
	  alert("Please enter valid video link."); 
	  $('#story_video_link').val(''); 
	  return false; 
	  }
}	
	
$('#rescue_transport_story_frm').validate({
		errorElement: 'label', //default input error message container
		errorClass: 'help-inline', // default input error message class
		focusInvalid: true, // do not focus the last invalid input
		ignore: [],
		rules: {
					story_title:{
						required:true
					},
					rescue_story:{
						required:true
					},
					rescue_story:{
                         required: function() 
                        {
                         CKEDITOR.instances.rescue_story.updateElement();
                        }                        
                    }
				},
		messages: {
			story_title: {
				required: 'Please enter title.'
			},
			rescue_story:{
				required: 'Please enter story.'
			}
		},
		

		invalidHandler: function (event, validator) { //display error alert on form submit   
			$('#rescue_transport_story_frm').show();
			
			var errors = validator.numberOfInvalids();
			if (errors) {
			  var message = errors == 1
				? 'You missed 1 field. It has been highlighted'
				: 'You missed ' + errors + ' fields. They have been highlighted';
			  alert(message);
			}
		},

		highlight: function (element) { // hightlight error inputs
			$(element)
				.closest('.form-group').addClass('has-error'); // set error class to the control group
		},
		//onClose: function() {$(this).valid();},
		success: function (label) { 
			label.closest('.form-group').removeClass('has-error');
			label.closest('.help-block').removeClass('has-error');
			label.remove();		
			
		},errorPlacement: function (error, element) {
			error.addClass('help-block').insertAfter(element.closest('.form-control'));//For Other Normal Fileds
			error.addClass('help-inline').insertAfter(element.closest('.input-group'));//For HTTP Filed
			
			if(element.attr("id") == "rescue_story") {
				error.insertAfter('#cke_rescue_story');
			}
			
		}
	});
	
});

</script>
<script>
function set_phone_number(legid)
{
	
	$('#actions').val('join_leg');
	$('#cancel_leg_ids').val(legid);
	$('#phone-number').modal('show');
	
}
$('#insert_phone_number').live('click',function(e){
var cancel_msg = $('#phone_number').val();	
var error_msg=0;
if(cancel_msg=='')
{
	error_msg =1;
	alert('Please Enter Phone Number');
}
if(error_msg == 0)
{	
	/*$('#cancel-transport-description').modal('hide');
	$('#transport_loader').modal('show');
	$('#cancel_trans_text').val(cancel_msg);*/	
	$('#legs_select1').submit();
}
});
</script>

<script>
$(document).ready(function(){
jQuery('#insert_phone_number_driver').live('click',function(e){
var cancel_msg = $('#phone_number_driver').val();	
var error_msg=0;
if(cancel_msg=='')
{
	error_msg =1;
	alert('Please Enter Phone Number');
}
if(error_msg == 0)
{	
	$('#telephone_no').val(cancel_msg);
	$('#phone-number-driver').modal('hide');
	if($('#profile_type').val()=='P')
	{	
		$("#can-save1 a").attr("href",'<?php echo base_url()."org-transportation-scheduled/".$transport_details['in_transportation_id'];?>' );
		$("#can-save1 a").trigger( "click" );
	} else {
		$("#can-save a").attr("href",'<?php echo base_url()."org-transportation-scheduled/".$transport_details['in_transportation_id'];?>' );
		$("#can-save a").trigger( "click" );
	}	
}
});
});
</script>

<script>
$('#close_cancel_phone').live('click',function()
{
$('.fl').show();
$('.loder_cancel').hide();
});
</script>

</body>
<!-- END BODY -->
</html>