if($(".orglist").length == 0)
{
	$(".orgadd").hide();
}

$(document).ready(function() { 
if($( window ).width() <= 1069) //767
{
	$('.large-only').html(" ");
} else {
	$('.small-only').html(" ");
}

$('#contact_phone_no').inputmask("(999) 999-9999");
$('#receiving_contact_phone_no').inputmask("(999) 999-9999");
var cnt_without_notify = '0';
var clicked_btn = '';
});

jQuery(document).ready(function() {       
   $("[href='"+"#transbasic"+"'] .material-icons").html('remove_circle_outline');
   
   ComponentsPickers.init();
  
  $('.open-timepicker1').click(function(event){
		event.preventDefault();
		$('#timepicker1').click();
	});  
	
	 $('.open-timepicker2').click(function(event){
		event.preventDefault();
		$('#timepicker2').click();
	});  
	
	$('.numbersOnly').keyup(function () { 
		this.value = this.value.replace(/[^0-9\.]/g,'');
	});

});   

$('#pick_zip,#drop_zip,#trans_unique_name,#st_sendOrg,#st_sendStreet, #st_receiveOrg,#st_receiveStreet,#qtyxs, #qtys,#qtym, #qtyl,#qtyxl').blur(function()
{
	if($(this).val().trim() !='')
	{
		autosave();
	}
	else
	{
		return false;
	}
});

function autosave(){
	var org_participate 	  = new Array();
	var private_notify_type	  = '';
	var transport_type_notify = '0';
	var manage_vehicle 		  = '';
	var pick_zip             = $('#pick_zip').val();
	var drop_zip             = $('#drop_zip').val();
	var pickupselect         = $('#pickupselect').val();
	var dateselect           = $('#dateselect').val();
	var trans_unique_name    = $('#trans_unique_name').val();
	
	var qtyxs             	 = $('#qtyxs').val();
	var qtyxs_cst_public  	 = $('#qtyxs_cst_public').val();
	var qtyxs_cst_private 	 = $('#qtyxs_cst_private').val();

	var qtys              	 = $('#qtys').val();
	var qtys_cst_public   	 = $('#qtys_cst_public').val();
	var qtys_cst_private  	 = $('#qtys_cst_private').val();

	var qtym              	 = $('#qtym').val();
	var qtym_cst_public   	 = $('#qtym_cst_public').val();
	var qtym_cst_private  	 = $('#qtym_cst_private').val();

	var qtyl              	 = $('#qtyl').val();
	var qtyl_cst_public   	 = $('#qtyl_cst_public').val();
	var qtyl_cst_private 	 = $('#qtyl_cst_private').val();

	var qtyxl 			  	 = $('#qtyxl').val();
	var qtyxl_cst_public  	 = $('#qtyxl_cst_public').val();
	var qtyxl_cst_private 	 = $('#qtyxl_cst_private').val();	
	var st_sendOrg 			 = $("#st_sendOrg").val();
	var st_sendStreet		 = $("#st_sendStreet").val();
	var st_receiveOrg 		 = $("#st_receiveOrg").val();
	var st_receiveStreet 	 = $("#st_receiveStreet").val();	
	
		
	if($('#allow_pics').prop('checked'))
	{
		var allow_pics = '1';
	} else {
		var allow_pics = '0';
	}
	
	if($('#multiple').prop('checked'))
	{
		var in_multiple_route = '1';
	} else {
		var in_multiple_route = '0';
	}
	
	if($('#public_reservation').prop('checked'))
	{
		var in_public_reservation = '1';
		var approval = '1';
	} else {
		var in_public_reservation = '0';
		var approval = '0';
	}
	


	
	if($("[name='transport_type_notify']:checked").val()=='1')
	{
		transport_type_notify = '1';
		if($('#approvedpartners').is(':checked'))
		{
			private_notify_type = 'partners';
		}

		if($('#approvedcoalitions').is(':checked'))
		{
			private_notify_type = 'coalitions';
		}
		
	}
	
	if($("#predefined_vehicle").is(':checked'))
	{
		if(($('#manage_vehicle').val()!='' || $('#manage_vehicle').val()!='0' || $('#manage_vehicle').val()!='Select'))
		{
			manage_vehicle = $('#manage_vehicle').val();
		}		
	}

	if(cnt_org_particpate>0 && $('#in_org_invite').is(':checked'))
	{
		for(var i=0;i<cnt_org_particpate; i++)
		{
			var cnt = parseInt(i)+parseInt(1); 
			var invitation_id = $('#participate_in_id_'+cnt).val();
			var invitation_type = $('#invitation_type_'+cnt).val();
			var part_organization_id = $('#participate_org_id_'+cnt).val();
			var participate_id = $('#participate_in_id_'+cnt).attr('id');
			org_participate.push({'invitation_id':invitation_id,'invitation_type':invitation_type,'part_organization_id':part_organization_id,'participate_id':participate_id});
		}		
	}
	
	var myData={"pick_zip":pick_zip,"drop_zip":drop_zip,"pickupselect":pickupselect,"approval":approval,
				"dateselect":dateselect,"allow_pics":allow_pics,"trans_unique_name":trans_unique_name,
				"qtyxs":qtyxs,"qtyxs_cst_public":qtyxs_cst_public,"qtyxs_cst_private":qtyxs_cst_private,
				"qtys":qtys,"qtys_cst_public":qtys_cst_public,"qtys_cst_private":qtys_cst_private,
				"qtym":qtym,"qtym_cst_public":qtym_cst_public,"qtym_cst_private":qtym_cst_private,
				"qtyl":qtyl,"qtyl_cst_public":qtyl_cst_public,"qtyl_cst_private":qtyl_cst_private,
				"qtyxl":qtyxl,"qtyxl_cst_public":qtyxl_cst_public,"qtyxl_cst_private":qtyxl_cst_private,
				"org_participate":org_participate,"transport_type_notify":transport_type_notify,
				"private_notify_type":private_notify_type,"manage_vehicle":manage_vehicle,"org_id":organization_id,"st_sendOrg":st_sendOrg, 
				"st_sendStreet":st_sendStreet,"st_receiveOrg":st_receiveOrg,"st_receiveStreet":st_receiveStreet,
				"in_public_reservation":in_public_reservation,"in_multiple_route":in_multiple_route,
			   };
		
	$.ajax({	
			type: "POST",
			url: base_url+'org_transportation/add_route_transport',
			data: myData, 						
			dataType:"html",
			success:function(data) 
			{
				
				var data = JSON.parse(data);
				if(data.org_participate_id.length >0)
				{
					$.each(data.org_participate_id, function( key, value ) {
						
						if(value.id!='' && value.val!='')
						{
							$('#'+value.id).val(value.val);
						}		
						
					});
				}
				$('#transportation_id').val(data.transport_id);
			}
	});
			
		
}  
	$('.numbersOnly').keyup(function () { 
				this.value = this.value.replace(/[^0-9\.]/g,'');
			});
	

var legs_file = '';
$(document).ready(function(){
$('#drop_zip').autocomplete ({
	//source:"<?php echo base_url(); ?>org_transportation/get_zip_code/",
    source: function (request, response)
    {
		request.term = $.trim(request.term);
		var str	= request.term;
		var letters = /^[a-zA-Z ]+$/;	
		if(str.match(letters))
		{
			request.term = str; 
		} else {
			str = str.toUpperCase();
			request.term = str.replace(/\s/g, ''); 
		}	
		
        $.ajax(
        {
            url: base_url+"org_transportation/get_zip_code2/" ,
            dataType: "json",
            data:
            {
                term: request.term,
				city: $("#drop_city" ).val(),
				state: $("#drop_state" ).val()
            },
            success: function (data)
            {
				if(data=="1")
				{
					window.location.href=base_url;
				}
				else
				{
                	response(data);
				}
            }
        });
    },
	minLength:1,
	open: function() { $('.ui-menu').width($("#drop_zip" ).width()) },
	focus: function( event, ui ) {
			var id = ui.item.label;
			var name = ui.item.value;
			$("#drop_zip" ).val(name);
			$("#drop_country" ).val(ui.item.st_country);
			//country_state(ui.item.st_country,"drop");
			$("#drop_city" ).val(ui.item.city);
			$("#drop_state" ).val(ui.item.state_prefix);
			return false;
	},     
	select: function( event, ui ) {
		var id = ui.item.label;
		var name = ui.item.value;
		//$("#drop_zip" ).val(name);
		$("#drop_zip" ).val(id);
		$("#drop_country" ).val(ui.item.st_country);
		//country_state(ui.item.st_country,"drop");
		$("#drop_city" ).val(ui.item.city);
		$("#drop_state" ).val(ui.item.state_prefix);
		return false;
		}
	});


$('#pick_zip').autocomplete ({
	//source:"<?php echo base_url(); ?>org_transportation/get_zip_code/", 
	source: function (request, response)
    {
		request.term = $.trim(request.term);
		var str	= request.term;
		var letters = /^[a-zA-Z ]+$/;	
		if(str.match(letters))
		{
			request.term = str; 
			//alert("True");
			
		} else {
			//alert("False");
			str = str.toUpperCase();
			request.term = str.replace(/\s/g, ''); 
			
		}	
		// 
        $.ajax(
        {
            url: base_url+"org_transportation/get_zip_code2/",
			//url: "<?php echo base_url(); ?>trip/get_zip_code2/",
            dataType: "json",
            data:
            {
                term: request.term,
				city: $("#pick_city" ).val(),
				state: $("#pick_state" ).val()
            },
            success: function (data)
            {
				if(data=="1")
				{
					window.location.href=base_url;
				}
				else
				{
                	response(data);
				}
            }
        });
    },
	minLength:1,
	open: function() { $('.ui-menu').width($("#pick_zip" ).width()) },
	focus: function( event, ui ) {
			var id = ui.item.label;
			var name = ui.item.value;
			$("#pick_zip" ).val(name);
			$("#pick_country" ).val(ui.item.st_country);
			//country_state(ui.item.st_country,"pick");
			$("#pick_city" ).val(ui.item.city);
			$("#pick_state" ).val(ui.item.state_prefix);
			
			return false;
	},     
	select: function( event, ui ) {
		var id = ui.item.label;
		var name = ui.item.value;
		//$("#pick_zip" ).val(name);
		$("#pick_zip" ).val(id);
		$("#pick_country" ).val(ui.item.st_country);
		//country_state(ui.item.st_country,"pick");
		$("#pick_city" ).val(ui.item.city);
		$("#pick_state" ).val(ui.item.state_prefix);
		
		return false;
	}
	});

$(document).ready(function(){
	
	    $.validator.addMethod('integer', function(value, element, param) {
            return (value >= 0);
        }, 'Please enter valid Quantity value for Reservation !');
	
		$.validator.addMethod("quantity", function (value, element) {
			//console.log($(element).attr('id'));
			if($(element).attr('id')=='qtyxs')
			{
				var crate_type= 'XS';
			}
			if($(element).attr('id')=='qtys')
			{
				var crate_type= 'S';
			}
			if($(element).attr('id')=='qtym')
			{
				var crate_type= 'M';
			}
			if($(element).attr('id')=='qtyl')
			{
				var crate_type= 'L';
			}
			if($(element).attr('id')=='qtyxl')
			{
				var crate_type= 'XL';
			}
			var total_quantity = value;
			var transportdata_id = transport_id;	
			var filepath = base_url+"org_transportation/verify_total_quantity";
			var result=0;
			$.ajax({
				  type: "POST",
				  url: filepath,
				  data: {
				  total_quantity:total_quantity,
				  crate_type:crate_type,
				  transportdata_id:transportdata_id
				  },
				  async:false,
				  success:function(response){
					  if(response==1)
					  {	  
						result = response;
					  }	
				  }	
			});
			return result;
		},'Qty must be greater then already reserved QTY.');

	
	$('#transport_locations').validate({
		ignore: [],
		//excluded: [':disabled',':not(:visible)'],
		errorElement: 'span', //default input error message container
		errorClass: 'help-block', // default input error message class
		focusInvalid: true, // do not focus the last invalid input
		rules: {
			pick_street: {
				//required: true
			},
			pick_city: {
				//required: true
			},
			pick_state: {
				//required: true
			},
			pick_zip: {
				required: true
			},
			drop_street: {
				//required: true
			},
			drop_city: {
				//required: true
			},
			drop_state: {
				//required: true
			},
			drop_zip: {
				required: true
			},
			dateselect: {
				required: true
			},
			pickupselect: {
				required: true
			},
			qtyxs: {
				//required: true,
				integer:true,
				/*quantity:{
					depends:function(){
						if($('#qtyxs').val()>'0' && transport_id!='')
						{
							return true;
						} else {
							return false;
						}	
					}
				}*/
			},
			qtys: {
				//required: true,
				integer:true,
				/*quantity:{
					depends:function(){
						if($('#qtys').val()>'0' && transport_id!='')
						{
							return true;
						} else {
							return false;
						}	
					}
				}*/
			},
			qtym: {
				//required: true,
				integer:true,
				/*quantity:{
					depends:function(){
						if($('#qtym').val()>'0' && transport_id!='')
						{
							return true;
						} else {
							return false;
						}	
					}
				}*/
			},
			qtyl: {
				//required: true,
				integer:true,
				/*quantity:{
					depends:function(){
						if($('#qtyl').val()>'0' && transport_id!='')
						{
							return true;
						} else {
							return false;
						}	
					}
				}*/
			},
			qtyxl: {
				//required: true,
				integer:true,
				/*quantity:{
					depends:function(){
						if($('#qtyxl').val()>'0' && transport_id!='')
						{
							return true;
						} else {
							return false;
						}	
					}
				}*/
			},
			leg_upload:{
				//extension: "xls|xlsx|csv",
				//filesize: 1048576	
			},
			st_sendOrg:{
				required:
				{
					depends: function(){
						var from = jQuery("#st_sendOrg").val();
				        var to = jQuery("#st_receiveOrg").val();
				        if(from != '' && to != ''){
				            if(from == to){
				            	jQuery("#st_sendOrg").val('');
				            	alert("Sending and receiving party organization name shold be different.");
							}
						}else{
							return true;
						}
					}
				},
			},
			st_sendStreet:{
				required: true
			},
			st_receiveOrg:{
				required: 
				{
					depends: function(){
						var from = jQuery("#st_sendOrg").val();
				        var to = jQuery("#st_receiveOrg").val();
				        if(from != '' && to != ''){
				            if(from == to){	
				            	jQuery("#st_receiveOrg").val('');				            	
				            	alert("Sending and receiving party organization name shold be different.");
							}
						}else{
							return true;
						}
					}
				},	
			},
			st_receiveStreet: {
				required: true
			},
		},

		messages: {
			/*pick_street: {
				required: 'Please enter pick up street.'
			},
			pick_city: {
				required: 'Please enter pick up city.'
			},
			pick_state: {
				required: 'Please enter pick up state.'
			},*/
			pick_zip: {
				required: 'Please enter origin location.'
			},
			drop_street: {
				required: 'Please enter drop off street.'
			},
			drop_city: {
				required: 'Please enter drop off city.'
			},
			drop_state: {
				required: 'Please enter drop off state.'
			},
			drop_zip: {
				required: 'Please enter destination location.'
			},
			dateselect: {
				required: 'Please select drop off date.'
			},
			pickupselect: {
				required: 'Please select pick up date.' 
			},
			/*qtyxs:{
				required: 'Please specify available spaces for reservation.' 
			},
			qtys:{
				required: 'Please specify available spaces for reservation.' 
			},
			qtym:{
				required: 'Please specify available spaces for reservation.' 
			},
			qtyl:{
				required: 'Please specify available spaces for reservation.' 
			},
			qtyxl:{
				required: 'Please specify available spaces for reservation.' 
			},*/			
			st_sendOrg:{
				required: 'Please enter sending organization name.'
			},
			sendStreet:{
				required: 'Please enter sending street name.'
			},
			st_receiveOrg:{
				required: 'Please enter receiving organization name.'
			},
			receiveStreet: {
				required: 'Please enter receiving street name.'
			},
		},

		invalidHandler: function (event, validator) { //display error alert on form submit   
			$('#transport_locations').show();
			
			var errors = validator.numberOfInvalids();
			if (errors) {
			  var message = errors == 1
				? 'You missed 1 field. It has been highlighted'
				: 'You missed ' + errors + ' fields. They have been highlighted';
			  alert(message);
			}
		},

		highlight: function (element) { // hightlight error inputs
			$(element)
				.closest('.form-group').addClass('has-error'); // set error class to the control group
		},

		success: function (label) { //alert(label);
		
			//label.closest('.form-group').removeClass('has-error');
			var class_name = label[0].className;
			if(class_name.indexOf("display-error-block")!='-1')
			{
				label.prev('.form-group').removeClass('has-error');	
			} else {
				label.closest('.form-group').removeClass('has-error');	
			}
			label.remove();
			
		},

		errorPlacement: function (error, element) { 
			//error.addClass('help-small no-left-padding').insertAfter(element.closest('.form-group'));
			//console.log();
			//console.log(error);
				
			if (element.attr("name") == "pickupselect")
			{
				error.addClass('help-block').insertAfter('#from_date_picker');
				//error.addClass('help-block').insertAfter(element.closest('.from_date'));
			}
			else if(element.attr("name") == "dateselect")
			{
				error.addClass('help-block').insertAfter('#to_date_picker');
				//error.addClass('help-block').insertAfter(element.closest('.from_date'));
			}
			else if (element.attr("name") == "leg_upload")
			{
				error.addClass('help-block').insertAfter(element.closest('.fileinput'));
				//error.addClass('help-block').insertAfter(element.closest('.from_date'));
			} else if (element.attr("type") == "radio"){
            	 // error.insertBefore(element.closest('.form-control').find('.gendererror'));
				 //error.insertBefore('.gendererror');
				 //error.insertAfter(element);
				 error.insertAfter(element.parent().find('#error-message-for-gender-'+element.data('id')).selector);
				 error.insertAfter(element.parent().find('#error-message-for-gender-'+element.data('id')));
			} else if(element.attr("name") == "qtyxs" || element.attr("name") == "qtys" || element.attr("name") == "qtym"
					   || element.attr("name") == "qtyl" || element.attr("name") == "qtyxl"
					 )
			{
				error.addClass('display-error-block').insertAfter(element.closest('.form-group'));
				//error.addClass('help-block').insertAfter(element.closest('.from_date'));
			}
			else
			{
				error.addClass('help-block').insertAfter(element.closest('.form-control'));
				error.addClass('help-inline').insertAfter(element.closest('.input-group'))
			}
		}

	});
	
		
	
$.validator.addMethod('filesize', function(value, element, param) {
    // param = size (en bytes) 
    // element = element to validate (<input>)
    // value = value of the element (file name)
    return this.optional(element) || (element.files[0].size <= param) 
}, $.validator.format("Maximum allowed 1MB file."));
// Older "accept" file extension method. Old docs: http://docs.jquery.com/Plugins/Validation/Methods/accept
$.validator.addMethod("extension", function(value, element, param) {
	param = typeof param === "string" ? param.replace(/,/g, "|") : "png|jpe?g|gif";
	return this.optional(element) || value.match(new RegExp(".(" + param + ")$", "i"));
}, $.validator.format("Please select valid file."));
	//console.log();
});
$(document).on('change','#pick_zip',function(){
//var selected_zipcode = $(this).val();
var selected_zipcode = $.trim($(this).val());
var str	= selected_zipcode; 
//selected_zipcode = str.replace(/\s/g, '');  

var letters = /^[a-zA-Z ]+$/;	
if(str.match(letters))
{
			 selected_zipcode = str; 
} else {
	var  comma_string = /,/;
	if(str.match(comma_string))
	{	
		var str2 = str.split(',');
        selected_zipcode = str2[0];		
	} else {
		 str = str.toUpperCase();  	
		 selected_zipcode = str.replace(/\s/g, ''); 
	}		 
}	

//alert(selected_zipcode);
//alert($("#pick_city" ).val());
var select_pickup_city = $("#pick_city" ).val();
//alert(select_pickup_city);
var select_pickup_state = $("#pick_state" ).val();
//alert(select_pickup_state);
var select_pickup_country = $("#pick_country" ).val();
//alert(select_pickup_country);
//alert($("#pick_zip").val());
//alert($("#pick_zip").val().indexOf(','));

if ($("#pick_zip").val().indexOf(',') != -1 && $("#pick_zip").val().indexOf('USA') != -1 && $("#pick_zip").val().indexOf('Canada') != -1) {
	if(selected_zipcode != '' && select_pickup_city != '' && select_pickup_state != '' && select_pickup_country != '')
	{
		$("#pick_zip").val(selected_zipcode+', '+select_pickup_city+', '+select_pickup_state+', '+select_pickup_country);
	}
}
else
{
	if(selected_zipcode!=''){
	$.ajax({
            url: base_url+"org_transportation/get_zip_code2/" ,
            dataType: "json",
            data:
            {
                term: selected_zipcode,
				city: $("#pick_city" ).val(),
				state: $("#pick_state" ).val()
            },
			//async: false,
            success: function (data)
            {
				//alert(data);
				//alert(data.length);
				//console.log(data);
				//return false;
				if(data)
				{
				//alert('if');
				$("#pick_zip").val(data[0].label);
				$("#pick_country" ).val(data[0].st_country);
				//country_state(data[0].st_country,"pick");
				$("#pick_city" ).val(data[0].city);
				$("#pick_state" ).val(data[0].state_prefix);
				}
				else
				{
					//$("#pick_zip").val();
					//alert($("#pick_zip").val().indexOf(','));
					//return false;
					//if($("#pick_zip").val().indexOf(',') == -1)
					//{
						alert('Please enter valid from location');	
						$("#pick_zip").val('');
					//}
				}
            }
        });		
	}//!=''	
}
});

$(document).on('change','#drop_zip',function(){
//var selected_zipcode = $(this).val();
var selected_zipcode = $.trim($(this).val());
var str	= selected_zipcode; 

var letters = /^[a-zA-Z ]+$/;	
if(str.match(letters))
{
			 selected_zipcode = str; 
} else {
	var  comma_string = /,/;
	if(str.match(comma_string))
	{	
		var str2 = str.split(',');
        selected_zipcode = str2[0];		
	} else {			 
			 str = str.toUpperCase();
			 selected_zipcode = str.replace(/\s/g, ''); 
	}
		 
}

//selected_zipcode = str.replace(/\s/g, '');  
//alert(selected_zipcode);
//alert($("#drop_city" ).val());
var select_dropoff_city = $("#drop_city" ).val();
//alert(select_dropoff_city);
var select_dropoff_state = $("#drop_state" ).val();
//alert(select_dropoff_state);
var select_dropoff_country = $("#drop_country" ).val();
//alert(select_dropoff_country);

//alert($("#drop_zip").val().indexOf(','));
if ($("#drop_zip").val().indexOf(',') != -1 && $("#drop_zip").val().indexOf('USA') != -1 && $("#drop_zip").val().indexOf('Canada') != -1) {
	if(selected_zipcode != '' && select_dropoff_city != '' && select_dropoff_state != '' && select_dropoff_country != '')
	{
		$("#drop_zip").val(selected_zipcode+', '+select_dropoff_city+', '+select_dropoff_state+', '+select_dropoff_country);
	}
}
else
{
	if(selected_zipcode!=''){
	$.ajax({
            url: base_url+"org_transportation/get_zip_code2/" ,
            dataType: "json",
            data:
            {
                term: selected_zipcode,
				city: $("#drop_city" ).val(),
				state: $("#drop_state" ).val()
            },
			//async: false,
            success: function (data)
            {
				//alert(data);
				//alert(data.length);
				//console.log(data);
				if(data)
				{
				$("#drop_zip" ).val(data[0].label);
				$("#drop_country" ).val(data[0].st_country);
				//country_state(data[0].st_country,"drop");
				$("#drop_city" ).val(data[0].city);
				$("#drop_state" ).val(data[0].state_prefix);
				}
				else
				{
					//if($("#drop_zip").val().indexOf(',') == -1)
					//{
						alert('Please enter valid to location');
						$("#drop_zip").val('');						
					//}
				}
            }
        });	
	}//!=''		
}
});


		
var startDate = new Date('01/01/2012');
var FromEndDate = new Date();
var ToEndDate = new Date();
ToEndDate.setDate(ToEndDate.getDate()+365);

$('.from_date').datepicker({ 
    minDate: today_date,   
	//format: "mm/dd/yyyy",
	format: "D M d",
	showMeridian: true,
	autoclose: true
})
    .on('changeDate', function(selected){
		if(selected.date!='')
		{
			startDate = new Date(selected.date.valueOf());
			startDate.setDate(startDate.getDate(new Date(selected.date.valueOf())));
			if(new Date(selected.date.valueOf())>new Date($("#dateselect").val()))
			{
				$("#dateselect").val('');
			}
			//$('.to_date').datepicker('setStartDate', startDate);
		}
    });

$('.to_date').datepicker({
        minDate: today_date, 
		//format: "mm/dd/yyyy",
		format: "D M d",
		showMeridian: true,
		autoclose: true,
		todayBtn: false
		
    })
    .on('changeDate', function(selected){
		if(selected.date!='')
		{
			FromEndDate = new Date(today_date);
			FromEndDate.setDate(FromEndDate.getDate(new Date(today_date)));
			//FromEndDate = new Date(selected.date.valueOf());
			//FromEndDate.setDate(FromEndDate.getDate(new Date(selected.date.valueOf())));
			//$('.from_date').datepicker('setStartDate', FromEndDate);
		}
    });
		
});
$(document).ready(function(event){	
$('.datepicker-icon').find('.from-date-icon').on('click', function(){
	   		$('#pickupselect').trigger('focus');
		});
		
		$('.datepicker-icon').find('.to-date-icon').on('click', function(){
	   		$('#dateselect').trigger('focus');
		});
});	

$('#pick_city').autocomplete ({
	source:function (request, response){
        $.ajax({
            url: base_url+"org_transportation/get_city/",
            dataType: "json",
            data:{
                term: request.term,
				city: $("#pick_city" ).val(),
				state: $("#pick_state" ).val()
            },
            success: function (data) {
                response(data);
            }
        });
	},
	minLength:2,
	open: function() { $('.ui-menu').width($("#pick_city" ).width()) },
	autoFocus:true,
	focus: function( event, ui ) {
		var city = ui.item.label;
		$( "#pick_city" ).val(city);
		
		return false;
	},     
	select: function( event, ui ) {
		var city = ui.item.label;
		$( "#pick_city" ).val(city);
		
		return false;
	}
});

$(document).on('click','#submit,#save-draft,#save-data',function(){	
	$('#loader').show();
	clicked_btn = $(this).attr('id');
	if($('#transport_locations').valid() == false) {
		$('#loader').hide();
		return false;
	} else {		
		
	
		var from_date = $('#pickupselect').val();
		var to_date = $('#dateselect').val();
		  
		var start_time_date = new Date(from_date);
		var end_time_date = new Date(to_date);
		
		var end_date = new Date(end_time_date.getFullYear(), end_time_date.getMonth(), end_time_date.getDate()); 
		var start_date = new Date(start_time_date.getFullYear(), start_time_date.getMonth(), start_time_date.getDate());

		var sending_flag = '0';
		var receiving_flag = '0';	
		  
		if (start_date > end_date) {
			alert("Drop Off Date must be greather than or equal to Pick Up Date.");
			return false;
		} 
		if (end_date < start_date) {
			alert("Pick Up Date must be less than or equal to Drop Off Date.");
			return false;
		}
		
		var qtyxs =  $('#qtyxs').val();
		var qtys  =  $('#qtys').val();
		var qtym  =  $('#qtym').val();
		var qtyl  =  $('#qtyl').val();
		var qtyxl =  $('#qtyxl').val();		
		
		var crate_res = '';	
		
		if(qtyxs <= '0' && qtys <='0' && qtym <='0' && qtyl <='0' && qtyxl <='0')
		{
			$('#loader').hide();
			alert('Please specify available spaces for reservation.')
			return false;
		} else if (transport_id!='')
		{
			$('.create_reservation').each(function(){
				
				if($(this).attr('id')=='qtyxs')
				{
					var crate_type= 'XS';
				}
				if($(this).attr('id')=='qtys')
				{
					var crate_type= 'S';
				}
				
				if($(this).attr('id')=='qtym')
				{
					var crate_type= 'M';
				}
				if($(this).attr('id')=='qtyl')
				{
					var crate_type= 'L';
				}
				if($(this).attr('id')=='qtyxl')
				{
					var crate_type= 'XL';
				}
				var total_quantity = $(this).val();
				var transportdata_id = transport_id;	
				var filepath = base_url+"org_transportation/verify_total_quantity";
				var result=0;
				$.ajax({
					type: "POST",
					url: filepath,
					data: {
					total_quantity:total_quantity,
					crate_type:crate_type,
					transportdata_id:transportdata_id
					},
				  async:false,
				  success:function(response){
					  if(response==0)
					  {	  
						crate_res+= 'Qty must be greater then already reserved QTY '+crate_type+'.'
					  }	
				  }	
				});		
			});
			
			if(crate_res!='')
			{
				$('#loader').hide();
				alert(crate_res);
				return false;
			}		
		}
		
		if(cnt_org_particpate>0 && $('#in_org_invite').is(':checked'))
		{
			$('.invitation_type').each(function(){
				if($(this).val() == 'sending')
				{
					sending_flag = '1';	
				} else if($(this).val() == 'receiving') {
					receiving_flag = '1';
				} 
				
				/*if(sending_flag=='1' && receiving_flag=='1')
				{
					break;
				}*/		
			});
		
			if(sending_flag=='0' || receiving_flag=='0')
			{
				$('#loader').hide();
				$('#invitation_type_error_msg').modal('show');
				//alert('Please make sure you specify at least one SENDING and one RECEIVING organization.  Otherwise please turn off the invite function.');
				return false;
			}		
		} else if(cnt_org_particpate<=0 && $('#in_org_invite').is(':checked'))
		{
			$('#loader').hide();
			$('#invitation_type_error_msg').modal('show');
		}	else  {
			cnt_org_particpate = '0';
		}
		
		if(!$('#in_org_invite').is(':checked') && !$('#approvedpartners').is(':checked') && !$('#approvedcoalitions').is(':checked') && cnt_without_notify == '0')
		{
			$('#loader').hide();
			$('#notify_error_msg').modal('show');
			return false;
		}		
		

		if($("[name='transport_type_notify']:checked").val()=='1'&& cnt_without_notify == '0')
		{
			if(!$('#approvedpartners').is(':checked') && !$('#approvedcoalitions').is(':checked'))
			{
				
				$('#loader').hide();
				$('#notify_error_msg').modal('show');
				return false;
			}		
		}		
			
		if(($('#manage_vehicle').val()=='' || $('#manage_vehicle').val()=='0' || $('#manage_vehicle').val()=='Select') && $("#predefined_vehicle").is(':checked'))
		{  
			$('#loader').hide();
			$('#predefined_veh_type_error_msg').modal('show');
			return false;
		}	

		
		
		//$("#action").val("prespecify")
		if($(this).attr('id')=='submit' || $(this).attr('id')=='save-data')
		{	
			$('#in_status').val('1');
		} else {
			$('#in_status').val('4');
		}
		
		var xs_price  = '0';
		var s_price   = '0';
		var m_price   = '0';
		var l_price   = '0';
		var xl_price  = '0';
		
		if(qtyxs > '0')
		{	
			xs_price  = $('#private-cost-xs').html();
		}
		if(qtys > '0')
		{		
			s_price   = $('#private-cost-s').html();
		}
		if(qtym > '0')
		{		
			m_price   = $('#private-cost-m').html();
		}
		if(qtyl > '0')
		{		
			l_price   = $('#private-cost-l').html();
		}
		if(qtyxl > '0')
		{		
			xl_price  = $('#private-cost-xl').html();
		}
		
		var paypal_success = '0';
		if(xs_price>0 || s_price>0 || m_price>0 || l_price>0 || xl_price>0)
		{
			  $.ajax({
				url: base_url+"org_transportation/get_org_paypal/",
				async:false,
				data:{
					org_id:organization_id,
				},	
				success:function(data) 
					{
						console.log(data);
						if(data=='no_paypal')
						{
							paypal_success='1';
						}	
					}
				});
		}
		
		if(paypal_success=='1')
	    {
			$('#loader').hide();
			$('#paypal_email').modal('show');
			return false;
		}
		$('#cnt_org_participate').val(cnt_org_particpate);
		$('#submit').hide();
		$('#save-draft').hide();
		$('#cancel_route').hide();
		$('#save-data').hide();	
		/*if($.browser.msie) {
				$('.display_loader').html('<img id="loadimg" src="'+base_url+'assets/img/ajax-loading.gif" alt="loader" />');
		}*/
	
		
			//$('#transport_loader').modal('show');
			
		
		//$('#loadimg').show();
		$('#transport_locations').submit();
		return true;
	}
});
$(document).on('keyup','#paypal_emailid',function(){
	
	if($('#paypal_emailid').val()!='')
	{
		//$('#submit-term-condition').removeClass('disabled');
		$('#submit-paypal-email-unchecked').hide();
		$('#submit-paypal-email').show();
	} else {
		//$('#submit-term-condition').addClass('disabled');
		$('#submit-paypal-email-unchecked').show();
		$('#submit-paypal-email').hide();
	}	
	
});

$(document).on('click','#submit-paypal-email',function()
{
		if($('#paypal_emailid').val()!='')
		{
			var emailReg = /^([\w-\.\+]+@([\w-]+\.)+[\w-]{2,4})?$/;
			var useremail = $("#paypal_emailid").val();
			var error_message = '';	
			//if(!emailReg.test(useremail))
			if(emailReg.test(useremail))
			{
				$.ajax({
						type:'POST',
						 url: base_url+"org_transportation/update_org_paypal/",
						 dataType: "json",
						 async:false,
						 data:{
							paypal_emailid:useremail,
						 },
						 success:function(data) 
						 {
							$('#paypal_email').modal('hide');
							$('#loader').show();
							$('#submit').hide();
							$('#save-draft').hide();
							$('#cancel_route').hide();
							$('#save-data').hide();	
							$('#transport_locations').submit();	
						 }
					});	
			} else 
			{
				flag =0;
				error_message = 'Please enter valid email address. \n';
				alert(error_message);
			}										
		} else {
			alert('Please enter paypal email address');
		}	
});
	
$( "#leg_upload" ).change(function() {
	legs_file = $(this).val()
});
$(document).on('click','#driver_submit',function(){
	if(legs_file!='')
	{
		alert("Upload legs only for Pre-Specify Legs.");
		return false;
	}
	var file_name = '';
	$('#image_file').val('');
	$('.table-striped tr').each(function() {
    var image_files = $(this).find('td p a').text(); 
	if(image_files!='')
	{  
		if (file_name == '') {
				file_name += image_files;
		}else{
				file_name += ',' + image_files; 
		}
	}
	});
	$('#image_file').val(file_name);
	if($('#transport_locations').valid() == false) {
		return false;
	} else {
		
		var from_date = $('#pickupselect').val();
		var to_date = $('#dateselect').val();
		  
		var start_time_date = new Date(from_date);
		var end_time_date = new Date(to_date);
		
		var end_date = new Date(end_time_date.getFullYear(), end_time_date.getMonth(), end_time_date.getDate()); 
		var start_date = new Date(start_time_date.getFullYear(), start_time_date.getMonth(), start_time_date.getDate()); 
		  
		if (start_date > end_date) {
			alert("Drop Off Date must be greather than Pick Up Date.");
			return false;
		} 
		if (end_date < start_date) {
			alert("Pick Up Date must be less than Drop Off Date.");
			return false;
		}
		
		$("#action").val("driverspecify")
		$('#submit').hide();
		$('#driver_submit').hide();
		$('#system_submit').hide();
		$('#system_submit1').hide();
		$('#transport_locations').submit();
		/*if($.browser.msie) {
				$('.display_loader').html('<img id="driver_loadimg" src='+base_url+'"assets/img/ajax-loading.gif" alt="loader" />');
		}*/
		//$('.display_loader').show();
		
		//$('#driver_loadimg').show();
		//return true;
	}
});	

var q=2;
$(document).on('click','.add_more',function() {
		if(q<=5)
		{					
		var row = '<div class="fileinput fileinput-new " data-provides="fileinput">';
			row+= '<div class="input-group">';
			row+= '<div class="form-control uneditable-input span3" data-trigger="fileinput"> <i class="fa fa-file fileinput-exists"></i>&nbsp; <span class="fileinput-filename"> </span> </div>';
			row+= '<span class="input-group-addon btn default btn-file light-green"> <span class="fileinput-new"> Browse... </span> <span class="fileinput-exists"> Change </span>';
			row+= '<input type="file" id="attachfiles_'+q+'" name="attachfiles_'+q+'">';
			row+= '</span> <a href="#" class="input-group-addon btn default fileinput-exists hidden-480" data-dismiss="fileinput"> Remove </a> </div>';
			row+= '<a title="Add More" class="cost-footer-btn btn light-green margin-top-10 add_more" href="javascript:void(0);"><i class="fa fa-plus"></i> Add More</a> ';                           
			row+= '</div>';
		$('.more_upload').append(row); 
		q++;	
		$(this).hide();
		}
		else
		{
			alert("Only 5 files are allow.");
		}
	
});

$(document).on('change','#zipcode_list',function(){
var selected_zipcode = $(this).val();
//alert(selected_zipcode);
$("#"+zip).val(selected_zipcode);
});

$(document).on('click','#transport_close',function(){
	var url = base_url;   
	var new_url = url+'org-dashboard'; 
	$(location).attr('href',new_url);
});	

function get_zip(city,state,zip)
{
	//alert($("#"+city).val());
	//alert($("#"+state).val());
	if($("#"+state).val()!='' && $("#"+city).val()!='')
	{
	 	jQuery.post(base_url+"org_transportation/get_zip_code/",{state:$("#"+state).val(),city:$("#"+city).val(),action:"zip"}, function( data ) {
			//$("#"+zip).val(data);
			if(data)
			{
				if(data=="1")
				{
					window.location.href="<?php echo base_url() ?>";
				}
				else
				{
					var newdaata = data.split("#*#"); 
					$("#"+zip).val(newdaata[0]);
					$("#"+city).val(newdaata[1]);
				}
			}
			
		});
	}
}

function get_zipcode(city,state,zip,country)
{
	//alert($("#"+city).val());
	//alert($("#"+state).val());
	if($("#"+city).val() == '')
	{
		alert('Please enter city name.');
		return false;
	}
	if($("#"+state).val() == '')
	{
		alert('Please select state name.');
		return false;
	}
	if($("#"+state).val()!='' && $("#"+city).val()!='')
	{
		
		$.ajax({
			  type: "POST",
			  url: base_url+'org_transportation/get_zip_code_data/',
			  beforeSend: function(){
				 $('#loader').show();
			  },
			  data: {
				  state:$("#"+state).val(),
				  city:$("#"+city).val(),
				  action:"zip"
			  },
			  dataType:"json",
			  
			  complete: function(){
				$('#loader').hide();
			  },
			  success:function(data){
					var arr_zipcodes = data.zipcodes;												
					//alert(arr_zipcodes.length);
					//return false;
					var str_zipcode = '';
					
					if(arr_zipcodes.length > 0) {
					str_zipcode += "<select name='zipcode_list' id='zipcode_list' class='form-control' style='width:77%;'>";	
						$.each( arr_zipcodes, function( key, value ) {	
							
							str_zipcode += "<option";
							str_zipcode += " value = "+value.zip_code+">";
							str_zipcode += value.zip_code;
							str_zipcode += "</option>";	
						});
						str_zipcode += "</select>";	
						//alert(str_zipcode);
						$('#popup_zip_div').html(str_zipcode);					
					} else {
						alert('Zip code not found for provided city/state.');
				return false;
					}
			  }	
		   });
	}
}

function change_origin_details()
{
	if($("#pick_city").val() == '')
	{
		alert('Please enter city name.');
		return false;
	}
	if($("#pick_state").val() == '')
	{
		alert('Please select state name.');
		return false;
	}
	if($("#popup_zipcode").val() == '')
	{
		alert('Origin zip code is required.');
		return false;
	}
	//alert($('#pick_country').val());
	//$('#pick_zip').val($('#popup_zipcode').val()+", "+$('#pick_city').val()+", "+$('#pick_state').val()+", "+$('#pick_country').val());
	$('#pick_zip').val($('#zipcode_list').val()+", "+$('#pick_city').val()+", "+$('#pick_state').val()+", "+$('#pick_country').val());	
	$('#zip-search').modal('hide');
	//$('#pick_city').val('');
	//$('#pick_state').val('');
	//$('#pick_country').val('');
	$('#popup_zipcode').val('');
	$('#popup_zip_div').show();
	var str_zipcode1 = '<input type="text" readonly="" name="popup_zipcode" id="popup_zipcode" class="form-control display-zipcode" placeholder="Zip code will appear here">';
	$('#popup_zip_div').html(str_zipcode1);	
	
}

function change_destination_details()
{
	if($("#pick_city").val() == '')
	{
		alert('Please enter city name.');
		return false;
	}
	if($("#pick_state").val() == '')
	{
		alert('Please select state name.');
		return false;
	}
	if($("#popup_zipcode").val() == '')
	{
		alert('Destination zip code is required.');
		return false;
	}
	//$('#drop_zip').val($('#popup_zipcode').val()+", "+$('#pick_city').val()+", "+$('#pick_state').val()+", "+$('#pick_country').val());
	$('#drop_zip').val($('#zipcode_list').val()+", "+$('#pick_city').val()+", "+$('#pick_state').val()+", "+$('#pick_country').val());
	$('#zip-search').modal('hide');
	//$('#pick_city').val('');
	//$('#pick_state').val('');
	//$('#pick_country').val('');
	$('#popup_zipcode').val('');
	$('#popup_zip_div').show();
	var str_zipcode1 = '<input type="text" readonly="" name="popup_zipcode" id="popup_zipcode" class="form-control display-zipcode" placeholder="Zip code will appear here">';
	$('#popup_zip_div').html(str_zipcode1);	
	
}

function transport_agree(transport_btn)
{

	if(transport_btn.id == 'transport_cancel')
	{
		var url = base_url;   
		var new_url = url+'org-dashboard'; 
		$(location).attr('href',new_url);
	}
	if(transport_btn.id == 'transport_iagree')
	{
		
		$.ajax({
			  type: "POST",
			  url: base_url+'org_transportation/update_user_transport_agreement/',
			  beforeSend: function(){
				 $('#loader').show();
			  },
			  data: {},
			  dataType:"json",			  
			  complete: function(){
				$('#loader').hide();
			  },
			  success:function(data)
			  	{
					if(data)
					{
						alert('Agreement accepted.');
					}
				}
		   });
	}
	
}


$(window).resize(function() {
	$('.ui-autocomplete').hide();
});

            (function() {
                /* matchHeight example */
                $(function() {
                    // apply your matchHeight on DOM ready (they will be automatically re-applied on load or resize)
                    // get test settings
                    var byRow = $('body').hasClass('test-rows');
                    // apply matchHeight to each item container's items
                    $('.dobt-form').each(function() {
                        $(this).children('.gr-wrap').matchHeight(byRow);
                    });
                    // Reset Height on Submit form
                    $('#driver_submit').click(function() {
                      setTimeout(function(){
                        $('.dobt-form').each(function() {
                            $(this).children('.gr-wrap').matchHeight(byRow);
                        });
                      }, 10);
                    });
                });
            })();		
     
$(document).ready(function(){
	jQuery('.title-tipso').tipso();
});



//Start media Gallery 
$(document).ready(function(){
$("area[rel^='prettyPhoto']").prettyPhoto();
$(".gallery:first a[rel^='prettyPhoto']").prettyPhoto({animation_speed:'normal',theme:'light_square',slideshow:3000, autoplay_slideshow: false});
$(".gallery:gt(0) a[rel^='prettyPhoto']").prettyPhoto({animation_speed:'fast',slideshow:10000, hideflash: true});
});
$('#receiving_organization_name').autocomplete ({
		source: function (request, response)
   		 {
			request = $.trim(request.term);
			$.ajax(
			{ 
				//url: "<?php echo base_url(); ?>org_transportation/get_airports_by_zipcode/" ,
				url: base_url+"org_transportation/get_all_organization/" ,
				dataType: "json",
				data:
				{
					term: request
				},
				success: function (data)
				{
					//alert(data);
					//return false;
					//response(data);
					if(data=="1")
					{
						window.location.href=base_url;
					}
					/*if(data == null || data === '')
					{
						alert('Please enter valid from Zipcode/Airport ID');
						$("#pickup_airport").val('');
					}*/
					//else
					if(1)
					{
						response(data);
					}
					
				}
			});
  	  	},
		minLength:1,
		open: function() { $('.ui-menu').width($("#receiving_organization_name" ).width()) },
		focus: function( event, ui ) {
			var id = ui.item.label;
			var name = ui.item.label;
			var person =  ui.item.director;
			var email =  ui.item.email;
			var tel_num =  ui.item.telephone;
			var cert = ui.item.st_has_501c3;
			var zip = ui.item.st_zip;
			if(cert=='Y')
			{
				$('#receiving-501c3-certified').prop("checked",true);
				$('#receiving-501c3-certified').next('.slider').html('<span class="yes">Yes</span>');
			}
			if(cert=='N')
			{
				$('#receiving-501c3-certified').prop("checked",false);
				$('#receiving-501c3-certified').next('.slider').html('<span class="no">No</span>');
			}	
			$("#receiving_organization_name" ).val(name);
			$("#receiving_contact_name" ).val(person);
			$("#receiving_contact_email" ).val(email);
			$("#receiving_contact_phone_no" ).val(tel_num);
			get_zip_code(zip,'#drop_zip');
				return false;
		},     
		select: function( event, ui ) {
			var id = ui.item.label;
			var name = ui.item.label;
			var person =  ui.item.director;
			var email =  ui.item.email;
			var tel_num =  ui.item.telephone;
			var cert = ui.item.st_has_501c3;
			var zip = ui.item.st_zip;
			if(cert=='Y')
			{
				$('#receiving-501c3-certified').prop("checked",true);
				//$('#receiving-501c3-certified').parent('span').addClass("checked");
			}
			
			if(cert=='N')
			{
				$('#receiving-501c3-certified').prop("checked",false);
				//$('#receiving-501c3-certified').parent('span').removeClass("checked");
			}
			
			$("#receiving_organization_name" ).val(name);
			$("#receiving_contact_name" ).val(person);
			$("#receiving_contact_email" ).val(email);
			$("#receiving_contact_phone_no" ).val(tel_num);
			get_zip_code(zip,'#drop_zip');
			return false;
		}
	});	

equalheight = function(container){

var currentTallest = 0,
     currentRowStart = 0,
     rowDivs = new Array(),
     $el,
     topPosition = 0;
 $(container).each(function() {

   $el = $(this);
   $($el).height('auto')
   topPostion = $el.position().top;

   if (currentRowStart != topPostion) {
     for (currentDiv = 0 ; currentDiv < rowDivs.length ; currentDiv++) {
       rowDivs[currentDiv].height(currentTallest);
     }
     rowDivs.length = 0; // empty the array
     currentRowStart = topPostion;
     currentTallest = $el.height();
     rowDivs.push($el);
   } else {
     rowDivs.push($el);
     currentTallest = (currentTallest < $el.height()) ? ($el.height()) : (currentTallest);
  }
   for (currentDiv = 0 ; currentDiv < rowDivs.length ; currentDiv++) {
     rowDivs[currentDiv].height(currentTallest);
   }
 });
}

$(window).on('load',function() {
  equalheight('.org-trans-detail .transport-steps');
  //setTimeout(function(){ $(window).trigger('resize'); }, 200);
});


$(window).resize(function(){
  equalheight('.org-trans-detail .transport-steps');
  //setTimeout(function(){ $(window).trigger('resize'); }, 200);
});


$(document).on('click','.empty_dates',function()
{
	$('#animal_listing_loader').modal('hide');
}); 

	
var id;	
$(document).on('click','.image-button',function(){
    $('#my-file').click();
	id = $(this).attr('id');
});

$(document).on('click','#publish-transport-org',function()
{
	$('#transport_loader').modal('show');
});



function onlyNumbers(evt) {
        var e = event || evt; // for trans-browser compatibility
        var charCode = e.which || e.keyCode;	
        var flag = true;
        //
        if (charCode > 47 && charCode < 58)
        {   
			if (len(e.target.id))
				flag = true;
            else
			{	
				alert("Value should be not more the 3 Digit Number");	
				flag = false;
			}	
		} else {
			alert("Value should be not more the 3 Digit Number");
			flag = false;
		}
        return flag;
    }
    function len(id) {
        var flag = false;
        var val = document.getElementById(id).value.length;
        val = val + 1;
        if (val <= 3)
            flag = true;
        return flag;
    }



function get_zip_code(zipcode,textfield)
{
	 $.ajax(
        {
            url: base_url+"org_transportation/get_zip_code2/" ,
            dataType: "json",
            data:
            {
                term:zipcode,
            },
            success: function (data)
            {
				//console.log(data[0].label)
				if(data=="1")
				{
					//window.location.href=base_url;
				}
				else
				{
					$(textfield).val(data[0].label);
                	//response(data);
				}
            }
        });
}

$(document).ready(function()
{
	$(document).on('click','#xs_price,#s_price,#m_price,#l_price,#xl_price',function()
	{
			
			if($(this).attr('id')=='xs_price')
			{
				var public_price = $('#public-cost-xs').html();	
				$('#txtpubliccost').val(public_price);
				var private_price = $('#private-cost-xs').html();	
				$('#txtorgcost').val(private_price);
				$('#size_type').val('xs');
			}
			
			if($(this).attr('id')=='s_price')
			{
				var public_price = $('#public-cost-s').html();	
				$('#txtpubliccost').val(public_price);
				var private_price = $('#private-cost-s').html();	
				$('#txtorgcost').val(private_price);
				$('#size_type').val('s');
			}
			
			if($(this).attr('id')=='m_price')
			{
				var public_price = $('#public-cost-m').html();	
				$('#txtpubliccost').val(public_price);
				var private_price = $('#private-cost-m').html();	
				$('#txtorgcost').val(private_price);
				$('#size_type').val('m');
			}
			
			if($(this).attr('id')=='l_price')
			{
				var public_price = $('#public-cost-l').html();	
				$('#txtpubliccost').val(public_price);
				var private_price = $('#private-cost-l').html();	
				$('#txtorgcost').val(private_price);
				$('#size_type').val('l');
			}
			
			if($(this).attr('id')=='xl_price')
			{
				var public_price = $('#public-cost-xl').html();	
				$('#txtpubliccost').val(public_price);
				var private_price = $('#private-cost-xl').html();	
				$('#txtorgcost').val(private_price);
				$('#size_type').val('xl');
			}
			
			
			$('#change-cost').modal('show');
			
	});
	
	$(document).on('click','#update_price',function(){ 
		
		var size_type = $('#size_type').val();
		var error_reporting = '0';
		var error_display = '';
		if($('#txtpubliccost').val()<0)
		{
			error_display += 'Public cost value should be greater then zero\n'; 
			error_reporting = '1';
		}
		if($('#txtorgcost').val()<0)
		{
			error_display += 'Doobert org cost value should be greater then zero'; 
			error_reporting = '1';
		}
		if(error_reporting == '1')
		{
			alert(error_display);
			return false;
		}	
		if(size_type == 'xs')
		{
			var public_price = $('#txtpubliccost').val();
			$('#public-cost-xs').html(public_price);
			$('#qtyxs_cst_public').val(public_price);
			
			
			
			var private_price = $('#txtorgcost').val();
			$('#private-cost-xs').html(private_price);
			$('#qtyxs_cst_private').val(private_price);
			
			
			
		}
		if(size_type == 's')
		{
			var public_price = $('#txtpubliccost').val();
			$('#public-cost-s').html(public_price);
			$('#qtys_cst_public').val(public_price);
			var private_price = $('#txtorgcost').val();
			$('#private-cost-s').html(private_price);
			$('#qtys_cst_private').val(private_price);
		}
		
		if(size_type == 'm')
		{
			var public_price = $('#txtpubliccost').val();
			$('#public-cost-m').html(public_price);
			$('#qtym_cst_public').val(public_price);
			var private_price = $('#txtorgcost').val();
			$('#private-cost-m').html(private_price);
			$('#qtym_cst_private').val(private_price);
		}
		
		if(size_type == 'l')
		{
			var public_price = $('#txtpubliccost').val();
			$('#public-cost-l').html(public_price);
			$('#qtyl_cst_public').val(public_price);
			var private_price = $('#txtorgcost').val();
			$('#private-cost-l').html(private_price);
			$('#qtyl_cst_private').val(private_price);
		}
		
		if(size_type == 'xl')
		{
			var public_price = $('#txtpubliccost').val();
			$('#public-cost-xl').html(public_price);
			$('#qtyxl_cst_public').val(public_price);
			var private_price = $('#txtorgcost').val();
			$('#private-cost-xl').html(private_price);
			$('#qtyxl_cst_private').val(private_price);
		}

		$('#change-cost').modal('hide');	
		
	});
	
});

$(document).ready(function(){
	$("[name='transport_type_notify']").on('change',function(){
		var notify_type = $(this).val();
		if(notify_type=='0')
		{
			$('#approvedpartners').closest('div.switch-container').addClass('fadein');
			$('#approvedcoalitions').closest('div.switch-container').addClass('fadein');
			$('#approvedpartners').attr('disabled', 'disabled');
			$('#approvedcoalitions').attr('disabled', 'disabled');
			$('#approvedpartners').prop('checked', false);
			$('#approvedpartners').next('.slider').html('<span class="no">No</span>');
			$('#approvedcoalitions').prop('checked', false);
			$('#approvedcoalitions').next('.slider').html('<span class="no">No</span>');
		} else {
			$('#approvedpartners').closest('div.switch-container').removeClass('fadein');
			$('#approvedcoalitions').closest('div.switch-container').removeClass('fadein');
			$('#approvedpartners').attr('disabled', false);
			$('#approvedcoalitions').attr('disabled', false);
			$('#approvedcoalitions').prop('checked',true);
			$('#approvedcoalitions').next('.slider').html('<span class="yes">Yes</span>');
		
		}		
	});

	$('#approvedcoalitions').on('change',function(){
			
		if($('#approvedpartners').is(':checked') && $('#approvedcoalitions').is(':checked'))
		{
			$('#approvedpartners').prop('checked', false);
			$('#approvedpartners').next('.slider').html('<span class="no">No</span>');
			console.log($('#approvedpartners').is(':checked'));	
		}
	});

	$('#approvedpartners').on('change',function(){
			
		if($('#approvedpartners').is(':checked') && $('#approvedcoalitions').is(':checked'))
		{
			$('#approvedcoalitions').prop('checked', false);
			$('#approvedcoalitions').next('.slider').html('<span class="no">No</span>');	
		}
	});

		
	$("#in_org_invite").on('change',function(){
			
		if($("#in_org_invite").is(':checked'))
		{
			$('.searching').show();
			$('#added_org_listing').show();
			
			$('.panel-title a').each(function(e){
				$("[href='"+$(this).attr('href')+"'] .material-icons").html('add_circle_outline');
				$('[href="'+$(this).attr('href')+'"]').attr('aria-expanded','false');
				$('[href="'+$(this).attr('href')+'"]').addClass('collapsed');
				$($(this).attr('href')).removeClass('in');
				$($(this).attr('href')).attr('aria-expanded','false');
				$($(this).attr('href')).attr('style','height: 0px;');					
			});
			
			$('[href="#inviteorg"]').attr('aria-expanded','true');
			$('[href="#inviteorg"]').removeClass('collapsed');
			$("[href='#inviteorg'] .material-icons").html('remove_circle_outline');
			$("#inviteorg").addClass('in');
			$("#inviteorg").attr('aria-expanded','true');
			$('#inviteorg').attr('style','');
			
		} else {
			
			if($('[href="#inviteorg"]').attr('aria-expanded')=='true')
			{
				$("[href='#inviteorg'] .material-icons").html('add_circle_outline');
				$('[href="#inviteorg"]').attr('aria-expanded','false');
				$('[href="#inviteorg"]').addClass('collapsed');
				$('#inviteorg').removeClass('in');
				$('#inviteorg').attr('aria-expanded','false');
				$('#inviteorg').attr('style','height: 0px;');	
			}
			
			$('.searching').hide();
			$('#added_org_listing').hide();		
		}	
		
	});	
	
	
	$('#searching_org').autocomplete({ 
	source: function (request, response)
    {
    	 var term= request.term;
			term = $.trim(term);
			var str	= term;
			var letters = /^[a-zA-Z ]+$/;	
			if(str.match(letters))
			{
				request.term = str; 
			} else {
				str = str.toUpperCase();
				request.term = str.replace(/\s/g, ''); 
			}		
		$.ajax(
        {
            url: base_url+'org_animal/get_org/',
            dataType: "json",
            data:
            {
				term: request.term				
            },
            success: function (data)
            {  
            	if(data=="1")
				{
					window.location.href=base_url;
				}
				else
				{
                	response(data);
				}
            }
        });
    },
	minLength:1,
	delay: 0,
	open: function() { $('.ui-menu').width($("#searching_org").width())},
	focus: function( event, ui ){
			var org_name = ui.item.value;	
			var org_id = ui.item.org_id;	
			var org_email_address = ui.item.org_email_address;	
			var invite_user_id = ui.item.in_user_id;
			$("#searching_org" ).val(org_name);	
			$("#searching_org_id" ).val(org_id);			
			return false;
	},     
	select: function( event, ui ) {
		var org_name = ui.item.value;			
		$("#searching_org" ).val(org_name);		
		return false;
	}
	});
	
$(document).on('change','#searching_org',function(){
	var selected_zipcode = $.trim($(this).val());
	if(selected_zipcode!='')
	{
	  $.ajax({
            url: base_url+'org_animal/get_org/',
            dataType: "json",
            data:
            {
                term: selected_zipcode,
            },
            success: function (data)
            {
				if(data)
				{
					var org_name = data[0].value;	
					var org_id = data[0].org_id;
					$("#searching_org").val(org_name);	
					$("#searching_org_id").val(org_id);

					var current_value  = $('#searching_org').val();			
					//check for duplicate organization		
					if($(".orglist").length > 0)
					{ 
						$('.orglist').each(function(){ 							
							var value = $(this).find("p").text();
							if(current_value == value)
							{																				
								$("#searching_org" ).val('');	
								$("#searching_org_id" ).val('');
								return false;

							}
						}); 
					}
		
				}
				else
				{
					if($("#searching_org").val().indexOf(',') == -1)
					{
						alert('Please enter valid doobert organization');
						$("#searching_org" ).val('');	
						$("#searching_org_id" ).val('');
					}
				}
				
            }
        });
	} else {
		//alert('Please enter valid doobert organization');
						$("#pick_org" ).val('');	
						$("#searching_org_id" ).val('');
						
	}		

	});
	
	$('#add_org').on('click',function(){	
		$("#add_org").prop('disabled',true);//not clickable
		var err  = 0;
		var current_value  = $('#searching_org').val();			
		//check for duplicate organization		
		if($(".orglist").length > 0)
		{ 
			$('.orglist').each(function(){ 
				console.log( $(this).find("p").text()); 
				var value = $(this).find("p").text();
				if(current_value == value)
				{						
					err = 1;
					alert("This Organization is already selected.");
					$("#searching_org" ).val('');	
					$("#searching_org_id" ).val('');
					$("#add_org").prop('disabled',false);//clickable
					return false;


				}
			}); 
		}

		if($('#searching_org').val()!='' && $('#searching_org_id').val()!='' && err != 1)
		{			
			
			cnt_org_particpate = parseInt(cnt_org_particpate) + parseInt(1);
			$.ajax({
				type:'POST',	
	            url: base_url+'transport_summary/get_org_details/',
	            data:
	            {
	                org_id:$('#searching_org_id').val(),
					cnt:cnt_org_particpate,
	            },
	            success: function (data)
	            {
	            	           	
					if(data!='')
					{

						$('#added_org_listing').append(data);
						$("#searching_org" ).val('');	
						$("#searching_org_id" ).val('');
						$("#add_org").prop('disabled',false);
						//organization you've added test hide-show
						if($(".orglist").length > 0)
						{
							$(".orgadd").show();
						}
					}
					else
					{
						alert('Please enter doobert organization');
						$("#searching_org" ).val('');	
						$("#searching_org_id" ).val('');
						$("#add_org").prop('disabled',false);	
					}
					
	            }
			});
		} else {
			if(err == 0){
				alert('Please enter doobert organization');							
			}
			$("#searching_org" ).val('');	
			$("#searching_org_id" ).val('');
			$("#add_org").prop('disabled',false);
			
		}

	});
	
	
	$(document).on('change',"[name='send_receive[]']",function(){
		var org_id = $(this).attr('data-orgid');
		if($(this).is(':checked'))
		{
			$('#invitation_type_'+org_id).val('receiving');
			$( ".choose" ).addClass( "receiving" );
			$( ".choose" ).removeClass( "sending" );
			$(".send").removeClass("select");
			$(".receive").addClass("select");
		} else {
			$('#invitation_type_'+org_id).val('sending');
			$( ".choose" ).addClass( "sending" );
			$( ".choose" ).removeClass( "receiving" );
			$(".send").addClass("select");
			$(".receive").removeClass("select");
		}		
	});
	
	
	$(document).on('change',"#predefined_vehicle",function(){		
		/*if(typeof(veh_id) !== 'undefined' && veh_id!='' && veh_id!='0')
		{
			var vehicle_id = veh_id;
				veh_id = '';
		} else {
			vehicle_id = '';
		}*/		
	
		if($(this).is(':checked'))
		{
			$('.vehiclecrate').addClass('disableddiv');
			//$('.select-style').show();
			$("#qtyxs, #qtys, #qtym, #qtyl, #qtyxl").attr('readonly', true);
			$.ajax({
			type:'POST',	
            url: base_url+'transport_summary/get_manage_vehicle/',
			data:{
				org_id:organization_id,
					
			},	
            success: function(data)
            {
				console.log(data);
				if(data!='')
				{  
					$('.select-style').show();
					$('#manage_vehicle').show();
					$('#manage_vehicle').html(data);
					//if(vehicle_id!='')
					if(typeof(veh_id) !== 'undefined' && veh_id!='' && veh_id!='0')	
					{	
						$('#manage_vehicle').val(veh_id);
					}		
				}
				else
				{	
					$('.select-style').hide();
					$('#predefined_veh_type_error_msg').modal('show');
					$('.vehiclecrate').removeClass('disableddiv');
					$("#predefined_vehicle").prop('checked',false);
					$("#qtyxs, #qtys, #qtym, #qtyl, #qtyxl").attr('readonly', false);
					$("#manage_vehicle").hide();
					$("#manage_vehicle").html('');
					$('#manage_vehicle').hide();
				}
				
            }
			});
			
		} else {	
			$("#qtyxs, #qtys, #qtym, #qtyl, #qtyxl").attr('readonly', false);
			$('.vehiclecrate').removeClass('disableddiv');
			//$("#qtyxs, #qtys, #qtym, #qtyl, #qtyxl").val('');				
			$('.select-style').hide();
		}		
	});
	
	$(document).on('change',"#manage_vehicle",function()
	{
		//var x= $(this).val();
		
		if($(this).val()!='' && $(this).val()!='0' && $(this).val()!='Select')
		{	
			var vehicle_detail = $(this).val();
			$.ajax({
				type:'POST',	
				url: base_url+'transport_summary/get_manage_vehicle_detail/',
				data:{
					veh_id:$(this).val()	
				},	
				success: function(data)
				{
					if(data!='')
					{
						$('.vehiclecrate').removeClass('disableddiv');
						veh_id = vehicle_detail;
						var veh_detail = JSON.parse(data);
						$('#qtyxs').val(veh_detail.in_qtyxs);
						$('#qtys').val(veh_detail.in_qtys);
						$('#qtym').val(veh_detail.in_qtym);
						$('#qtyl').val(veh_detail.in_qtyl);
						$('#qtyxl').val(veh_detail.in_qtyxl);	
						
						$('#public-cost-xs').html(veh_detail.qtyxs_cst_public);
						$('#private-cost-xs').html(veh_detail.qtyxs_cst_private);
						
						$('#public-cost-s').html(veh_detail.qtys_cst_public);
						$('#private-cost-s').html(veh_detail.qtys_cst_private);
						
						$('#public-cost-m').html(veh_detail.qtym_cst_public);
						$('#private-cost-m').html(veh_detail.qtym_cst_private);
						
						$('#public-cost-l').html(veh_detail.qtyl_cst_public);
						$('#private-cost-l').html(veh_detail.qtyl_cst_private);
						
						$('#public-cost-xl').html(veh_detail.qtyxl_cst_public);
						$('#private-cost-xl').html(veh_detail.qtyxl_cst_private);
						$("#qtyxs, #qtys, #qtym, #qtyl, #qtyxl").attr('readonly', false);
					}
					else
					{	
						alert('You do not have a vehicle defined.');
						if(typeof(veh_id) !== 'undefined' && veh_id!='' && veh_id!='0')	
						{	
							$('#manage_vehicle').val(veh_id);
						}	
					}
				}
			});
		} else {
			alert('You do not have a vehicle defined.');			
			if(typeof(veh_id) !== 'undefined' && veh_id!='' && veh_id!='0')	
			{	
				$('#manage_vehicle').val(veh_id);
			}
		}		
	});
	
	$(document).on('click','#cnt_without_notify',function(){
		cnt_without_notify = '1';
		$('#'+clicked_btn).trigger('click');
	});
	
});

//rajashri Mahapure

//at the time of adding new organization
function delete_org_list(id)
{
	if(!confirm('Are you sure, you want to remove selected organization?'))
    {
        return false;
    }else{
		$(".participate_in_id_"+id).remove();	
		if($(".orglist").length == 0)
		{
			$(".orgadd").hide();
		}
		alert("Selected organization is deleted successfully.");
		return false;
	}
	
}


//if organization is from the database
function delete_org_list_db(id)
{
	var org_id = $("input[name=participate_org_id_"+id+"]").val();
	var transport_id = $("#transport_id").val();
	//console.log(org_id+"||"+transport_id);
	if(org_id && transport_id)
	{
		if(!confirm('Are you sure, you want to remove selected organization?'))
	    {
	        return false;
	    }else{

			$.ajax({
				type:'POST',	
	            url: base_url+'transport_summary/delete_participant_org',
	            dataType: "json",
	            data:
	            {
	                org_id :org_id,
	                transport_id:transport_id,
	            },
	            success: function (data)
	            {
	            	//console.log(data);
					if(data == 'success')
					{
						$(".participate_in_id_"+id).remove();
											
						if($(".orglist").length == 0)
						{
							$(".orgadd").hide();
						}
						alert("Selected organization is deleted successfully.");
						return false;
					}
					else
					{
						alert("Not able to remove this participant organization");
						return false;
					}
					
	            }
	        });
		}
	}
	else{
		return false;
	}

	
}


//sending organization name
$(document).on('change','#st_sendOrg',function(){
	var selected_zipcode = $.trim($(this).val());
	if(selected_zipcode!='')
	{
	  $.ajax({
            url: base_url+'transport_summary/orgdetails/',
            dataType: "json",
            data:
            {
                term: selected_zipcode,
            },
            success: function (data)
            {
				if(data)
				{
					var org_name = data[0].value;	
					var org_id = data[0].org_id;
					var st_sendStreet = data[0].st_address1;
					if(data[0].st_address2)
					{
						var st_sendStreet = data[0].st_address1+", "+data[0].st_address2;
					}
					var pick_zip = data[0].st_zip+", "+data[0].st_city+", "+data[0].st_state+", "+data[0].st_country;
					$("#st_sendOrg").val(org_name);	
					$("#in_sendOrg").val(org_id);	
					$("#st_sendStreet").val(st_sendStreet);
					$("#pick_zip").val(pick_zip);
				}
				else
				{
					if($("#st_sendOrg").val().indexOf(',') == -1)
					{
						alert('Please enter valid doobert organization');
						$("#st_sendOrg" ).val('');	
						$("#in_sendOrg" ).val('');
						$("#st_sendStreet").val('');
						$("#pick_zip").val('');
					}
				}
				
            }
        });
	} else 
	{
		$("#st_sendOrg" ).val('');	
		$("#in_sendOrg" ).val('');
		$("#st_sendStreet").val('');
		$("#pick_zip").val('');
	}		

});


$('#st_sendOrg').autocomplete({ 
	source: function (request, response)
    {
    	 var term= request.term;
			term = $.trim(term);
			var str	= term;
			var letters = /^[a-zA-Z ]+$/;	
			if(str.match(letters))
			{
				request.term = str; 
			} else {
				str = str.toUpperCase();
				request.term = str.replace(/\s/g, ''); 
			}		
		$.ajax(
        {
            url: base_url+'transport_summary/orgdetails/',
            dataType: "json",
            data:
            {
				term: request.term				
            },
            success: function (data)
            {  
            	if(data=="1")
				{
					window.location.href=base_url;
				}
				else
				{
                	response(data);
				}
            }
        });
    },
	minLength:1,
	delay: 0,
	open: function() { $('.ui-menu').width($("#st_sendOrg").width())},
	focus: function( event, ui ){
			var org_name = ui.item.value;	
			var org_id = ui.item.org_id;	
			var org_email_address = ui.item.org_email_address;	
			var invite_user_id = ui.item.in_user_id;
			var st_sendStreet = ui.item.st_address1;
			if(ui.item.st_address2)
			{
				st_sendStreet = ui.item.st_address1+", "+ui.item.st_address2;
			}
			var pick_zip = ui.item.st_zip+", "+ui.item.st_city+", "+ui.item.st_state+", "+ui.item.st_country;
			$("#st_sendOrg").val(org_name);	
			$("#in_sendOrg").val(org_id);	
			$("#st_sendStreet").val(st_sendStreet);
			$("#pick_zip").val(pick_zip);
	
			return false;
	},     
	select: function( event, ui ) {

		var org_name = ui.item.value;			
		$("#st_sendOrg" ).val(org_name);
		var from = $("#st_sendOrg").val();
        var to = $("#st_receiveOrg").val();
        if(from != '' && to != ''){
            if(from == to){
            	$("#st_sendOrg").val('');
            	$("#in_sendOrg" ).val('');
				$("#st_sendStreet").val('');
				$("#pick_zip").val('');
            	alert("Sending and receiving party organization name should be different.");	
			}
		}else{
			return true;
		}
		return false;
	}
});


//receiving organization name


$(document).on('change','#st_receiveOrg',function(){
	var selected_zipcode = $.trim($(this).val());
	if(selected_zipcode!='')
	{
	  $.ajax({
            url: base_url+'transport_summary/orgdetails/',
            dataType: "json",
            data:
            {
                term: selected_zipcode,
            },
            success: function (data)
            {
				if(data)
				{
					var org_name = data[0].value;	
					var org_id = data[0].org_id;
					var st_receiveStreet = data[0].st_address1;
					if(data[0].st_address2)
					{
						st_receiveStreet = data[0].st_address1+", "+data[0].st_address2;
					}
					var drop_zip = data[0].st_zip+", "+data[0].st_city+", "+data[0].st_state+", "+data[0].st_country;
					$("#st_receiveOrg").val(org_name);	
					$("#in_receiveOrg").val(org_id);
					$("#st_receiveStreet").val(st_receiveStreet);
					$("#drop_zip").val(drop_zip);
				}
				else
				{
					if($("#st_receiveOrg").val().indexOf(',') == -1)
					{
						alert('Please enter valid doobert organization');
						$("#st_receiveOrg" ).val('');	
						$("#in_receiveOrg" ).val('');
						$("#st_receiveStreet").val('');
						$("#drop_zip").val('');
					}
				}
				
            }
        });
	} else 
	{
		$("#st_receiveOrg" ).val('');	
		$("#in_receiveOrg" ).val('');
		$("#st_receiveStreet").val('');
		$("#drop_zip").val('');
	}		

});


$('#st_receiveOrg').autocomplete({ 
	source: function (request, response)
    {
    	 var term= request.term;
			term = $.trim(term);
			var str	= term;
			var letters = /^[a-zA-Z ]+$/;	
			if(str.match(letters))
			{
				request.term = str; 
			} else {
				str = str.toUpperCase();
				request.term = str.replace(/\s/g, ''); 
			}		
		$.ajax(
        {
            url: base_url+'transport_summary/orgdetails/',
            dataType: "json",
            data:
            {
				term: request.term				
            },
            success: function (data)
            {  
            	if(data=="1")
				{
					window.location.href=base_url;
				}
				else
				{
                	response(data);
				}
            }
        });
    },
	minLength:1,
	delay: 0,
	open: function() { $('.ui-menu').width($("#st_receiveOrg").width())},
	focus: function( event, ui ){
			var org_name = ui.item.value;	
			var org_id = ui.item.org_id;	
			var org_email_address = ui.item.org_email_address;	
			var invite_user_id = ui.item.in_user_id;
			var st_receiveStreet = ui.item.st_address1;
			if(ui.item.st_address2)
			{
				st_receiveStreet = ui.item.st_address1+", "+ui.item.st_address2;
			}
			var drop_zip = ui.item.st_zip+", "+ui.item.st_city+", "+ui.item.st_state+", "+ui.item.st_country;
			$("#st_receiveOrg").val(org_name);	
			$("#in_receiveOrg").val(org_id);
			$("#st_receiveStreet").val(st_receiveStreet);
			$("#drop_zip").val(drop_zip);				
			return false;
	},     
	select: function( event, ui ) {
		var org_name = ui.item.value;			
		$("#st_receiveOrg" ).val(org_name);
		var from = $("#st_sendOrg").val();
        var to = $("#st_receiveOrg").val();
        if(from != '' && to != ''){
            if(from == to){
            	$("#st_receiveOrg").val('');
            	$("#in_receiveOrg" ).val('');
				$("#st_receiveStreet").val('');
				$("#drop_zip").val('');
            	alert("Sending and receiving party organization name should be different.");			 	
			}
		}else{
			return true;
		}		
		return false;
	}
});
