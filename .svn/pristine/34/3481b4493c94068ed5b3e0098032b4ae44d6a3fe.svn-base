<?php $base_url = $this->config->item('base_url');?>
<!DOCTYPE html>
<!--[if IE 8]> <html lang="en" class="ie8 no-js"> <![endif]-->
<!--[if IE 9]> <html lang="en" class="ie9 no-js"> <![endif]-->
<!--[if !IE]><!-->
<html lang="en" class="no-js">
<!--<![endif]-->
<!-- BEGIN HEAD -->
<head>
<meta charset="utf-8"/>
<title>Edit Product - Doobert</title>
<link rel="icon" href="<?php echo $base_url;?>img/favicon.ico">
<?php include APPPATH."views/inc/header-css-js.php";?>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<meta content="" name="description"/>
<meta content="" name="author"/>
<link href="<?php echo $base_url; ?>assets/plugins/fullcalendar/fullcalendar/fullcalendar.css" rel="stylesheet" type="text/css"/>
<link rel="stylesheet" href="<?php echo base_url(); ?>assets/plugins/jquery-file-upload/css/style.css">
<!-- CSS to style the file input field as button and adjust the Bootstrap progress bars -->
<link rel="stylesheet" type="text/css"  href="<?php echo base_url(); ?>assets/css/tipso.css">
<link rel="stylesheet" href="<?php echo base_url(); ?>assets/plugins/jquery-file-upload/css/jquery.fileupload.css">
<link rel="stylesheet" href="<?php echo base_url(); ?>assets/plugins/jquery-file-upload/css/jquery.fileupload-ui.css">
<!-- CSS adjustments for browsers with JavaScript disabled -->
</head>
<!-- BEGIN BODY -->
<body class="page-header-fixed">

<!--Menu Active Link-->
<?php $tab = 6; $subtab = "6.1"; $display_menu = 2; ?>

<!-- BEGIN HEADER -->
<?php include 'inc/header-myaccount.php';?>
<!-- END HEADER -->
<div class="clearfix"> </div>
<section class="breadcrumb inner-breadcrumb">
	<div class="container">
		<div class="text-left">			
			<a href="<?php echo $base_url;?>dashboard/">My Dashboard</a><i class="material-icons">chevron_right</i><a href="<?php echo base_url(); ?>org-dashboard/<?php echo $this->session->userdata('org_id'); ?>/">Org Dashboard</a><i class="material-icons">chevron_right</i><a href="<?php echo base_url(); ?>products/woocommerce_product/">Products and Auctions</a><i class="material-icons">chevron_right</i>Edit Product</div>
	</div>
</section>

<!-- BEGIN CONTAINER -->

  <!-- BEGIN CONTENT -->
  
     <section class="main-content-wrapper inner-wrapper">
        <div class="container">
         	<div class="row">
                <div class="col-md-12 col-sm-12 col-xs-12">
	                <article>
						<div class="entry-content">
							<div class="sub-content main-container clearfix">
								<div class="col-md-12 col-sm-12 col-xs-12">
									<!-- Main content start -->
									<!------------------------ Add content here ---------------------->
  	
 									 <div class="page-content-wrapper">
   <form  name="product-edit" id="product-edit" action="" method="post" enctype="multipart/form-data">
   <input type="hidden" name="frm_action" id="frm_action" value="EDIT" />
   <input type="hidden" name="product_id" value="<?php echo isset($product_detail['in_prod_id']) ? $product_detail['in_prod_id']:'';?>" />
    <div class="page-content woocommerce-product-info"> 
      <!-- BEING PAGE CONTENT-->
      <div class="row content-wrapper"> 
      
      <?php include 'includes/woocommerce-tab.php';?>
    
        
        
                  <?php 
	  				if($this->session->flashdata('upload_error')) {
			 	   ?> 
                  <div class="alert alert-danger"><strong>Error!</strong><br><br>
				   <?php
                   echo $this->session->flashdata('upload_error');
                   ?></div>
                  <?php } ?>    
               
        		<?php 
                    if(isset($Err_Msg) && !empty($Err_Msg)) {
                ?>
                <div class="alert alert-danger"><strong>Error!</strong><br><br>
                <?php 
                        echo $Err_Msg; 
                ?></div>
                <?php } ?>
                
                <?php 
	  				if($this->session->flashdata('success')) {
			 	 ?>
				<div class="alert alert-success">
                <strong>
			  	<?php 
						echo $this->session->flashdata('success'); 
			  	?></strong></div>
			  	<?php } ?>
<!--Dashboard Top part end-->
<div class="content-bdr wocommerce-product-info">
        <div class="row no-margin">
          <div class="title-patch"><!--<i class="fa fa-edit"></i>--><h1 class="in_block">Edit Product</h1>
          <button class="btn orange-small save-product" type="submit" id="btnpink">Save Product</button> <span class="display_loader" style="display:none;"> <img id="loadimg1" src="<?php echo base_url();?>/assets/img/ajax-loading.gif" alt="loader"> </span><div class="clearfix"></div></div>
        </div>
        <!--End Section Title-->
        <div class="row no-space">
          <div class="col-md-12 no-space">
		  <?php if($paypal_email_address=='') { ?>
		  <p>We noticed your PayPal email is not populated for your organization. In order to add products for sale in the Rescue Store we need your PayPal email so we can route the payments to you. Please populate your <a href="<?php echo base_url(); ?>org_info/edit_organization_profile#paypal_email" target="_blank">PayPal email address</a>.</p>
		  <?php } ?>
          <div class="col-md-9 no-space">
          	<div class="col-md-12 no-space-left">
            	<div class="col-md-10 no-space-left">
                <div class="form-group">
                                  <label class="control-label" for="product_name">Product Name </label>
                                 <input type="text" name="product_name" value="<?php echo isset($product_detail['st_product']) ? $product_detail['st_product'] : '';?>" id="product_name" maxlength="100" class="form-control">
                                  
                </div>
                </div>
            <div class="col-md-2 no-space-right">
            <div class="form-group">
                                  <label class="control-label" for="product_sku">SKU 
										<span class="title-tipso general-profile-detail" title="Please create a unique, short (10 chars or less) name for your product (Ex: SmTShirt1) so the system can keep track of your products."><i class="material-icons">info</i></span>
								  </label>
                                  <input type="text" name="product_sku" value="<?php echo isset($product_detail['st_sku'])?$product_detail['st_sku']:'';?>" id="product_sku" maxlength="10" class="form-control">
                                  
                </div>
            </div>
            </div>
            
                       <div class="col-md-12 no-space-left">
                        <div class="form-group">
                        <label for="product_description" class="control-label">Product Description</label>                       
                        <textarea class="ckeditor form-control" id="product_description" name="product_description"  rows="10"><?php echo isset($product_detail['st_desc'])? $product_detail['st_desc']:'';?></textarea>
                        </div>
                        </div>                           
         
            
            
            <div class="col-md-12 no-space-left">
            <div class="col-md-3 no-space-left">
            <div class="form-group">
                                  <label class="control-label" for="prod_regular_price">Regular Price ($): </label>
                                  <div class="reg-price"><input type="text" name="prod_regular_price" id="prod_regular_price" maxlength="10" class="form-control" value="<?php echo isset($product_detail['fl_regular_price'])?$product_detail['fl_regular_price']:'';?>" ></div>
                                  
                </div>
             </div>
             <div class="col-md-3 dis-price-prod no-space-left">
            <div class="form-group">
                                  <label class="control-label" for="prod_discount_price">Discounted Price ($):</label>
                                <div class="reg-price"> <input type="text" name="prod_discount_price" maxlength="10" id="prod_discount_price" class="form-control" value="<?php echo isset($product_detail['fl_discount_price']) ? $product_detail['fl_discount_price'] : '0.00';?>"></div>
                                  
                </div>
             </div>
             
             
            <div class="col-md-3 no-space-left dis-price-prod">
            <div class="form-group">
                                  <label class="control-label" for="prod_shipping_cost">Shipping Price ($):</label>
                                  <div class="reg-price"><input type="text" name="prod_shipping_cost" maxlength="10" id="prod_shipping_cost" class="form-control" value="<?php echo isset($product_detail['fl_shipping_cost']) ? $product_detail['fl_shipping_cost'] : '0.00';?>"></div>
                                  
                </div>
             </div>
             
             
             
             <div class="col-md-3 no-space-left">
            <div class="form-group">
                                  <label class="control-label" for="prod_stock_status">Stock Status: </label>
                                   <div class="select-style">
                                  <select id="prod_stock_status" name="prod_stock_status" class="form-control">
                                                          <option value="">Select status</option>
                                                          <option value="1" <?php echo ($product_detail['in_stock_status']=='1') ? 'selected' : '';?> >In stock</option>
                                                          <option value="2" <?php echo ($product_detail['in_stock_status']=='2') ? 'selected' : '';?>>Out of stock</option>
                                  </select>
				</div>
                                  
                </div>
             </div>
             
			
			  <div class="col-lg-6 col-md-6 col-sm-12 hidden-field no-space-left no-space-right br">
			    
				<div class="form-group" id="prodimg">
				 <label class="control-label" for="product_image">Product Image: </label>
                    <div id='product_file_input' class="fileinput-new fullwidth" data-provides="fileinput">
                      <div class="input-group certified-uploader" style="display:table;">
                        <div class="form-control uneditable-input span3" data-trigger="fileinput"> <i class="fa fa-file fileinput-exists"></i>&nbsp; 
						<span class="fileinput-filename"> 
                        <?php echo ($product_detail['st_prod_image']!='' && file_exists($this->config->item('upload')."product/110x110/".$product_detail['st_prod_image'])) ? $product_detail['st_prod_image']:''; ?>	
						</span> </div>
                       <div class="file-upload-btn">
                        <span class="input-group-addon btn default btn-file orange-small woocommerce-prod-img">  <span class="fileinput-new"> Add Files... </span> <span class="fileinput-exists"> Change </span>
						 <input type="file"  name="product_image" id="product_image" data-badge="false" title="Add Files...">
                         <input type="hidden" name="image_file" id="image_file">
           				 <input type="hidden" name="file_to_upload" id="file_to_upload">
                        </span>                        
                         <a href="javascript:void(0)" id="delete_product_image" class="input-group-addon btn default fileinput-exists black remove-btn" title="Delete"><i class="material-icons">delete</i></a>
						  </div>                          
					   </div>
					    <span id="image_upload_error"></span>
                    </div>
                  </div>
				  
				  <?php if($product_detail['in_affiliate'] == 0){?>
                  <?php 
					if(isset($product_detail['st_prod_image']) && $product_detail['st_prod_image'] != '0'){ 
					
					if($product_detail['st_prod_image']!='' && file_exists($this->config->item('upload')."product/110x110/".$product_detail['st_prod_image'])) {
						$product_photo = $product_detail['st_prod_image'];
					} else {
						$product_photo = 'no-image.jpg';
					}
				?>
                <img src="<?php echo $this->config->item('upload_url'); ?>product/190x190/<?php echo $product_photo; ?>" title="<?php echo $product_detail['st_product']; ?>" alt="<?php echo $product_detail['st_product']; ?>">
                <?php 
					} else {
				?>
                <img src="<?php echo $this->config->item('upload_url'); ?>product/27x27/<?php echo isset($product_photo) ? $product_photo:''; ?>" title="<?php echo isset($product_detail['st_product']) ? $product_detail['st_product']:''; ?>" alt="<?php echo isset($product_detail['st_product']) ? $product_detail['st_product']:''; ?>">
				<?php
					}
				?>
				  <?php } ?>
				</div> 
            </div>
            
            
             
            
            
            <div class="col-md-12 no-space-left">
            
             
             
            <div class="col-md-9 no-space-right no-space-left">              
            
                  
               <?php if(isset($product_image) && count($product_image) > 0){  ?> 
               <div class="form-group prod-gallery-img" id="galleryimg">
               <label class="control-label" for="product-gallery-imge">Product Gallery Images:</label>
              <ul>
             <?php foreach($product_image as $image){?> 
             <li>           
                <a id="<?php echo $image['in_img_id']; ?>" href="<?php echo base_url().'products/delete_product_photos';?>/<?php echo $image['in_img_id']; ?>/<?php echo $image['in_product_id'];?>" onClick="javascript:return confirm('Are you sure you want to delete it?');" class="story_pic_del"><i class="material-icons">close</i></a>
                
               <span><img src="<?php echo $this->config->item('upload_url'); ?>product/110x110/<?php echo $image['st_image']; ?>"></span>
                </li>              
             <?php } ?>
              </ul>             
             </div>             
               <?php } ?>
               <div class="form-group mart16" id="galleryimg">
                    <label class="control-label" for="add-gallery-imge">Add Gallery Images:</label>
                    <div class="gr-wrap col-lg-12 no-space">
                      <div class="form-group no-margin"> 
                        <!-- The fileupload-buttonbar contains buttons to add/delete files and start/cancel the upload -->
                        <div class="row fileupload-buttonbar">
                          <div class="col-lg-12 no-space"> 
                            <!-- The fileinput-button span is used to style the file input field as button --> 
                            <span class="custom-file-input btn btn-success fileinput-button add-profile-files marr10"> 
                            <input type="file" name="files" multiple>
                            </span>
                           <!-- <button type="submit" class="btn btn-primary start"> <i class="glyphicon glyphicon-upload"></i> <span>Start upload</span> </button>-->
                           
                             <span>(Upload a .jpg, .jpe, .jpeg, .gif, .png, .doc, .docx, .xls, .xlsx, .pdf file, 5MB Maximum)</span>
                            <!-- The global file processing state --> 
                            <span class="fileupload-process"></span> </div>
                          <!-- The global progress state -->
                          <div class="col-lg-12 fileupload-progress fade"> 
                            <!-- The global progress bar -->
                            <div class="progress progress-striped active" role="progressbar" aria-valuemin="0" aria-valuemax="100">
                              <div class="progress-bar progress-bar-success" style="width:0%;"></div>
                            </div>
                            <!-- The extended global progress state -->
                            <div class="progress-extended">&nbsp;</div>
                          </div>
                        </div>
                        <!-- The table listing the files available for upload/download -->
                        <table role="presentation" class="table table-striped">
                          <tbody class="files">
                          </tbody>
                        </table>
                      </div>
                      <!-- The template to display files available for upload --> 
                      <script id="template-upload" type="text/x-tmpl">
                    {% for (var i=0, file; file=o.files[i]; i++) { %}
                        <tr class="template-upload fade">
                            <td>
                                <span class="preview"></span>
                            </td>
                            <td>
                                <p class="name">{%=file.name%}</p>
                                <strong class="error text-danger"></strong>
                            </td>
                            <td>
                                <p class="size">Processing...</p>
                                <div class="progress progress-striped active" role="progressbar" aria-valuemin="0" aria-valuemax="100" aria-valuenow="0"><div class="progress-bar progress-bar-success" style="width:0%;"></div></div>
                            </td>
                            <td>
                                {% if (!i && !o.options.autoUpload) { %}
                                    <button class="btn btn-primary start" disabled>
                                        <i class="glyphicon glyphicon-upload"></i>
                                        <span>Start</span>
                                    </button>
                                {% } %}
                                {% if (!i) { %}
                                    <button class="btn btn-warning black cancel">
                                        <i class="glyphicon glyphicon-ban-circle"></i>
                                        <span>Cancel</span>
                                    </button>
                                {% } %}
                            </td>
                        </tr>
                    {% } %}
                    </script> 
                      <!-- The template to display files available for download --> 
                      <script id="template-download" type="text/x-tmpl">
                    {% for (var i=0, file; file=o.files[i]; i++) { %}
                        <tr class="template-download fade">
                            <td>
                                <span class="preview">
                                    {% if (file.thumbnailUrl) { %}
                                        <a href="{%=file.url%}" title="{%=file.name%}" download="{%=file.name%}" data-gallery><img src="{%=file.thumbnailUrl%}"></a>
                                    {% } %}
                                </span>
                            </td>
                            <td>
                                <p class="name">
                                    {% if (file.url) { %}
                                        <a href="{%=file.url%}" title="{%=file.name%}" download="{%=file.name%}" {%=file.thumbnailUrl?'data-gallery':''%}>{%=file.name+","%}</a>
                                    {% } else { %}
                                        <span>{%=file.name+","%}</span>
                                    {% } %}
                                </p>
                                {% if (file.error) { %}
                                    <div><span class="label label-danger">Error</span> {%=file.error%}</div>
                                {% } %}
                            </td>
                            <td>
                                <span class="size">{%=o.formatFileSize(file.size)%}</span>
                            </td>
                            <td>
                                {% if (file.deleteUrl) { %}
                                    <button class="btn btn-danger black delete" data-type="{%=file.deleteType%}" data-url="{%=file.deleteUrl%}"{% if (file.deleteWithCredentials) { %} data-xhr-fields='{"withCredentials":true}'{% } %}>
                                        <i class="glyphicon glyphicon-trash"></i>
                                        <span>Cancel</span>
                                    </button>
                                    <input type="checkbox" name="delete" value="1" class="toggle">
                                {% } else { %}
                                    <button class="btn btn-warning black cancel">
                                        <i class="glyphicon glyphicon-ban-circle"></i>
                                        <span>Cancel</span>
                                    </button>
                                {% } %}
                            </td>
                        </tr>
                    {% } %}
                    </script> 
                    </div>
                  </div>          
             </div>                
             
            </div>
			
			
			<div class="no-space-left dis-price-prod">
				<div class="form-group custom-checkbox">
				  <input type="checkbox" name="flg_affiliate" value="1" id="flg_affiliate" <?php echo isset($product_detail['in_affiliate']) && $product_detail['in_affiliate'] == 1   ? 'checked' : ''?>><label class="control-label" for="flg_affiliate">Affiliate Product (Yes/No):</label>
				</div>
				<div class="col-md-6 no-space-left form-group">
					<label class="control-label" for="affiliate_url" id="affiliate_url_label" style="display:none;">Affiliate Product URL:</label>
					<div class="reg-price" style="display:none;" id="affiliate_url"><input type="text" name="affiliate_url" id="affiliate_url" class="form-control" value="<?php echo $product_detail['st_affiliate_url'];?>"></div>	
				</div>
				<div class="col-md-6 no-space-left form-group">
					<label class="control-label" for="affiliate_image_url" id="affiliate_image_url_label" style="display:none;">Affiliate Product image URL:</label>
					<div class="reg-price" style="display:none;" id="affiliate_image_url"><input type="text" name="affiliate_image_url" id="affiliate_image_url" value="<?php echo $product_detail['st_affiliate_image_url'];?>" class="form-control"></div>
				</div>
				<div class="br"></div>
			</div>
            </div>
			
			
            <div class="col-md-3 right no-space product-category">
            <div class="form-group">
                                  <h4>Product Category 
								   <span class="title-tipso general-profile-detail" title="Please select which categories this product should be listed under."><i class="material-icons">info</i></span>
								  </h4>
                                  	
                                 			<div class="category-labels">
                                               
                                            
                                            <?php if(isset($category_list) && count($category_list) > 0){ $catArr	=	@(explode(',',$product_detail['st_selected_category'])); ?>
                                            
                                            <?php  foreach($category_list as $cat){  
											
											
											
											?>
                                            
                                            <div class="custom-checkbox">   
											<input type="checkbox" name="sel_cat[]" id="inlineCheckbox_<?php echo $cat['in_cat_id'];?>" value="<?php echo $cat['in_cat_id']; ?>" <?php if(in_array($cat['in_cat_id'], $catArr)){ echo 'checked';};?>><label class="checkbox-inline" for="inlineCheckbox_<?php echo $cat['in_cat_id'];?>"><?php echo $cat['st_category']; ?></label></div>       
                                             <?php } ?> 
                                                                             
                                            <?php } ?>
                                            <div id="cat_error">
                                            </div>
                                  
                                  
                </div>
            </div> 
            </div>
          </div>      
        </div>
        
</div>
					<div class="form-group tab-save-btn">
                      <div class="no-left-space">
					  <button aria-hidden="true" name="cancel" id="cancel" class="btn black" type="button" onClick="window.location='<?php echo base_url();?>products/woocommerce_product/'">Cancel</button>
                        <button aria-hidden="true" name="submit" id="submit_1" class="btn orange-small marr5" type="submit">Save Product</button>                        
                       <span class="display_loader" style="display:none;"> <img id="loadimg1" src="<?php echo base_url();?>assets/img/ajax-loading.gif" alt="loader"> </span>
                      </div>
                    </div>
    </div>
      
      <!-- END PAGE CONTENT--> 
    </div>
    
    </form>
  </div>
  
  </div>
					  		</div>
						</div><!-- .entry-content -->
					</article><!-- #post-## -->
                </div>
            </div>
        </div>
</section>

  <!-- END CONTENT --> 

<!-- END CONTAINER --> 

<?php if($this->session->flashdata('success_mail')): ?>
<!-- BEGIN THANK YOU MODAL POPUP-->
<div class="modal fade" id="success_mail" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header"> 
        <button aria-hidden="true" data-dismiss="modal" class="close" type="button"></button>
        <h4 class="modal-title">Information</h4>
      </div>
      <div class="modal-body"><p><?php echo $this->session->flashdata('success_mail'); ?></p></div>
      <div class="modal-footer text-center no-margin"><a class="btn orange" data-dismiss="modal">Close</a> </div>
    </div>
    <!-- /.modal-content --> 
  </div>
  <!-- /.modal-dialog --> 
</div>
<!-- END THANK YOU MODAL POPUP-->
<?php endif; ?>

<!-- -->
<div id="responsive">
<div class="modal fade" id="subscribe_ical" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" data-backdrop="static" data-keyboard="false">
      <div class="modal-dialog message-modal">
        <div class="modal-content">
          <div class="modal-header"> 
            <button aria-hidden="true" data-dismiss="modal" class="close cancel_close1" type="button"></button>
            <h4 class="modal-title">Subscribe to Calendar</h4>
          </div>
          <div class="modal-body">
          	<div class="col-lg-12">
											<div class="input-icon right">
												<input type="text" class="form-control" name="ical_url" id="ical_url" value="<?php echo base_url().'ical/doobert_events_'.$this->session->userdata('org_id').'.ics'; ?>">
											</div>
											<div class="help-block">
												 You can copy and paste above mentioned link into Google, Outlook and Apple iCal.</div></div>
            <div class="clearfix"></div>	
          </div>
          <div class="modal-footer text-center no-margin"> 
          <button class="btn orange org_save_popup1" style="display:none;" data-dismiss="modal" onClick="javascript:void(0);" type="button">Save Photo</button>
          <button class="btn black cancel_popup1" data-dismiss="modal" onClick="javascript:void(0);" type="button">OK</button>
          </div>
         </div>
        <!-- /.modal-content --> 
      </div>
      <!-- /.modal-dialog --> 
</div>
</div>
<!-- -->

<div class="modal fade bs-modal-lg in" id="email-config" tabindex="-1" role="basic" aria-labelledby="myModalLabel" aria-hidden="true">
                            <form class="horizontal-form" role="form" name="tell_a_friend" id="tell_a_friend" action="<?php echo base_url() ?>transportation/tell_a_friend" method="post">
                              <div class="modal-dialog">
                                <div class="modal-content">
                                	<input type="hidden" id="share_transport_id" name="share_transport_id" value="">
                                    
                                    <div class="modal-header">
                                        <button aria-hidden="true" data-dismiss="modal" class="close" type="button"></button>
                                        <h4 class="modal-title">Send Email</h4>
                                    </div>
                            
                                  <div class="modal-body">
                                   <div class="form-group "><label class="control-label" for="txttoname">To Name: </label><input type="text" class="form-control" id="txttoname" name="txttoname"></div>
                                    
                            <div class="form-group "><label class="control-label" for="txtemail">To Email: </label><input type="text" class="form-control" id="txtemail" name="txtemail"></div>
                            
                           <?php /*?> <div class="form-group "><label class="control-label" for="txtfrom">From </label><input type="text" class="form-control" id="txtfrom" name="txtfrom" value="<?php echo $this->session->userdata('user_name').' '.$this->session->userdata('last_name'); ?>"></div><?php */?>
                           <input type="hidden" class="form-control" id="txtfrom" name="txtfrom" value="<?php echo $this->session->userdata('user_name').' '.$this->session->userdata('last_name'); ?>">
                            
                            <?php /*?><div class="form-group ">
                            <label class="control-label" for="txtsubject">Subject </label>
                            <input type="text" class="form-control" id="txtsubject" name="txtsubject" value="">
                            </div><?php */?>
                            
                            <input type="hidden" class="form-control" id="txtsubject" name="txtsubject" value="">
                            
                            <div class="form-group no-margin"><label class="control-label " for="txtMessage">Message </label><textarea id="txtMessage" name="txtMessage" class="form-control" rows="10"></textarea></div>
                            <input type="hidden" name="frm_action" id="frm_action" value="submit" />
                                  </div>
                                  <div class="modal-footer no-margin no-border no-top-space text-center"><button aria-hidden="true" name="send_mail" id="send_mail" class="btn orange-small waves-effect waves-light" type="submit">Send Email</button>
                                  <span class="display_loader" style="display:none;"> <img id="loadimg_mail" src="<?php echo base_url(); ?>assets/img/ajax-loading.gif" alt="loader" /> </span>
                                  </div>
                                </div>
                                <!-- /.modal-content --> 
                              </div>
                              <!-- /.modal-dialog --> 
                              </form>
                            </div>
							
		<div class="modal fade" id="paypal_email" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
		<div class="modal-dialog">
			<div class="modal-content">
				<div class="modal-header none">
					<button aria-hidden="true" data-dismiss="modal" class="close" type="button"  title="Close"></button>
					<h4 class="modal-title marb0">PayPal Email Address</h4>
				</div>
				<div class="modal-body">
					<p>Please enter your PayPal email so we can send you payments for purchases. This is required to list items in the Rescue Store.</p>
					 <div class="form-group col-md-12 padl0 padr0">
                            <input type='email' id="paypal_emailid" name="paypal_emailid"  class="form-control" Placeholder="Enter PayPal email address" />
                    </div>
					<div class="modal-footer text-center no-margin lesser">
						<a class="btn black" data-dismiss="modal" href="javascript:void(0);">CANCEL</a>
						<a class="btn orange" style='opacity: .65;' id='submit-paypal-email-unchecked' onClick='alert("Please enter PayPal email address");' href="javascript:void(0);">Save</a>
						<a class="btn orange" style='display:none' id='submit-paypal-email' href="javascript:void(0);">Save</a>  
					</div>
		
				</div> 
			</div>
		</div>
	</div>						
                            
<?php include 'inc/footer-dashboard.php';?>
<script src="<?php echo $base_url; ?>assets/tinymce/js/tinymce/tinymce.min.js"></script>
<script src="<?php echo $base_url; ?>assets/tinymce/js/tinymce/jquery.tinymce.min.js"></script>
<script type="text/javascript">
  tinymce.init({
    selector: '#product_description',
	plugins : 'advlist autolink link lists image charmap',
	toolbar1: 'bold italic underline strikethrough | link | numlist bullist charmap | removeformat',
	menubar: ""
  });
  </script>


<?php /*?><script src="<?php echo $base_url; ?>assets/plugins/fullcalendar/fullcalendar/fullcalendar.min.js" type="text/javascript"></script><?php */?>

<script src="<?php echo $base_url; ?>assets/scripts/index.js" type="text/javascript"></script> 

<script src="<?php echo base_url(); ?>assets/plugins/jquery-validation/dist/jquery.validate.min.js" type="text/javascript"></script> 

<script type="text/javascript">
var upload_link= '<?php echo base_url(); ?>products/product_add_files';
var file_divid = 'product-edit';
</script>

<!-- The jQuery UI widget factory, can be omitted if jQuery UI is already included --> 
<script src="<?php echo base_url(); ?>assets/plugins/jquery-file-upload/js/vendor/jquery.ui.widget.js"></script> 
<!-- The Templates plugin is included to render the upload/download listings --> 
<script src="<?php echo base_url(); ?>assets/plugins/multi-files-upload/tmpl.min.js"></script> 
<!-- The Load Image plugin is included for the preview images and image resizing functionality --> 
<script src="<?php echo base_url(); ?>assets/plugins/multi-files-upload/load-image.min.js"></script> 
<!-- The Canvas to Blob plugin is included for image resizing functionality --> 
<script src="<?php echo base_url(); ?>assets/plugins/multi-files-upload/canvas-to-blob.min.js"></script> 
<!-- Bootstrap JS is not required, but included for the responsive demo navigation --> 
<?php /*?><script src="//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script> <?php */?>
<!-- blueimp Gallery script --> 
<script src="<?php echo base_url(); ?>assets/plugins/multi-files-upload/jquery.blueimp-gallery.min.js"></script> 
<!-- The Iframe Transport is required for browsers without support for XHR file uploads --> 
<script src="<?php echo base_url(); ?>assets/plugins/jquery-file-upload/js/jquery.iframe-transport.js"></script> 
<!-- The basic File Upload plugin --> 
<script src="<?php echo base_url(); ?>assets/plugins/jquery-file-upload/js/jquery.fileupload.js"></script> 
<!-- The File Upload processing plugin --> 
<script src="<?php echo base_url(); ?>assets/plugins/jquery-file-upload/js/jquery.fileupload-process.js"></script> 
<!-- The File Upload image preview & resize plugin --> 
<script src="<?php echo base_url(); ?>assets/plugins/jquery-file-upload/js/jquery.fileupload-image.js"></script> 
<?php /*?><!-- The File Upload audio preview plugin --> 
<script src="<?php echo base_url(); ?>assets/plugins/jquery-file-upload/js/jquery.fileupload-audio.js"></script> 
<!-- The File Upload video preview plugin --> 
<script src="<?php echo base_url(); ?>assets/plugins/jquery-file-upload/js/jquery.fileupload-video.js"></script> <?php */?>
<!-- The File Upload validation plugin --> 
<script src="<?php echo base_url(); ?>assets/plugins/jquery-file-upload/js/jquery.fileupload-validate.js"></script> 
<!-- The File Upload user interface plugin --> 
<script src="<?php echo base_url(); ?>assets/plugins/jquery-file-upload/js/jquery.fileupload-ui.js"></script> 
<!-- The main application script --> 
<script src="<?php echo base_url(); ?>assets/plugins/jquery-file-upload/js/file_upload_main.js"></script>

<script src="<?php echo base_url(); ?>assets/scripts/tipso.js" type="text/javascript" charset="utf-8"></script>

<script>
$(document).ready(function(){
	jQuery('.title-tipso').tipso();
});
</script>


<script>

$(document).ready(function(){
	$('#'+file_divid).fileupload({
		  url: upload_link,
		  maxNumberOfFiles: 10,
		  maxFileSize : 5242880,
		   acceptFileTypes :/(\.|\/)(jpe?g|doc|docx|xls|xlsx|pdf|gif|png)$/i,
		  sequentialUploads: true,
		  autoUpload :true,
		  disableImageResize:true
	});
});
    </script> 

<script>

function display_share_email_popup()
	{
		$('#email-config').modal('show');
		//val=document.getElementById('txtMessage').value;
		//val = val.replace(/<br\s*\/?>/mg,"\n");
		//alert(val);
		//$('#txtMessage').html(val);
		
	}
	
		jQuery(document).ready(function() {    
		   //Index.initCalendar(); // init index page's custom scripts
		   
		     $('#tell_a_friend').validate({
					errorElement: 'span', //default input error message container
					errorClass: 'help-block', // default input error message class
					focusInvalid: true, // do not focus the last invalid input
					rules: {
						txttoname: {
							required: true
						},
						txtemail: {
							required: true,
							email:true
						},
						txtMessage: {
							required: true
						}
					},
			
					messages: {
						txttoname: {
							required: 'Please enter receiver name.'
						},
						txtemail: {
							required: 'Please enter receiver email.',
							emauil: 'Please enter valid receiver email.'
						},
						txtMessage: {
							required: 'Please enter message.'
						}
						
					},
			
					invalidHandler: function (event, validator) { //display error alert on form submit   
						$('#tell_a_friend').show();
						
						var errors = validator.numberOfInvalids();
						if (errors) {
						  var message = errors == 1
							? 'You missed 1 field. It has been highlighted'
							: 'You missed ' + errors + ' fields. They have been highlighted';
						    alert(message);
						}
					},
			
					highlight: function (element) { // hightlight error inputs
						$(element)
							.closest('.form-group').addClass('has-error'); // set error class to the control group
					},
			
					success: function (label) { //alert(label);
						label.closest('.form-group').removeClass('has-error');
						label.remove();
					},
			
					errorPlacement: function (error, element) { 
						error.addClass('help-block').insertAfter(element.closest('.form-control'));
					}
			
				});
        });   
		
		$('#send_mail').click(function(){
	if($('#tell_a_friend').valid() == false) {
		return false;
	} else {
		$('#send_mail').hide();
		
		if($.browser.msie) {
				$('.display_loader').html('<img id="loadimg" src="<?php echo base_url(); ?>assets/img/ajax-loading.gif" alt="loader" />');
			}
		$('.display_loader').show();
		
		$('#loadimg_mail').show();
		$('#email-config').modal('hide');
		
		if($.browser.msie) {
			$('.display_loader').html('<div id="loader" style="display: none;"><img src="<?php echo base_url(); ?>assets/img/ajax-modal-loading.gif" width="32" height="32" align="absmiddle">&nbsp;<span id="loadertext">Loading...</span></div>');
		}
		
		$('.display_loader').show();
		$('#loader').show();
	}
	}); 
	</script>
    
<script type="text/javascript">
	$(document).ready(function(){
        var date = new Date();
		var d = date.getDate();
		var m = date.getMonth();
		var y = date.getFullYear();
		
		var h = {};

            if ($('#calendar').width() <= 400) {
                $('#calendar').addClass("mobile");
                h = {
                    left: 'title, prev, next',
                    center: '',
                    right: 'today,month,agendaWeek,agendaDay'
                };
            } else {
                $('#calendar').removeClass("mobile");
                if (App.isRTL()) {
                    h = {
                        right: 'title',
                        center: '',
                        left: 'prev,next,today,month,agendaWeek,agendaDay'
                    };
                } else {
                    h = {
                        left: 'title',
                        center: '',
                        right: 'prev,next,today,month,agendaWeek,agendaDay'
                    };
                }               
            }
		
		$('#calendar').fullCalendar({
				disableDragging: false,
                header: h,
                editable: false,
                events: [
				<?php  $replace_array = array(",","'","\n");$replace_with = array("");
					if(isset($event_data) && !empty($events)) {
						foreach($event_data as $row) { 
							if($row['start_date']!='0000-00-00 00:00:00' && $row['end_date']!='0000-00-00 00:00:00') {
								$y = date('Y',strtotime($row['start_date']));
								$m = date('m',strtotime($row['start_date']));
								$j = date('j',strtotime($row['start_date']));
								$h = date('g',strtotime($row['start_date']));
								$i = date('i',strtotime($row['start_date']));
								
								$ye = date('Y',strtotime($row['end_date']));
								$me = date('m',strtotime($row['end_date']));
								$je = date('j',strtotime($row['end_date']));
								$he = date('g',strtotime($row['end_date']));
								$ie = date('i',strtotime($row['end_date']));
								
				?>
							{
								<?php if(isset($row['tr_title'])) { ?>
								title: '<?php echo 'DBT#'.str_replace('12p','',$row['tr_title']); ?>',
								<?php } else { ?>
								//title: "<php echo ($this->common_function->get_filtered_name_ucfirst(strip_tags( ($row['title'])))); ?>",
								title: "<?php echo (strip_tags(addslashes($row['title']))); ?>",
								<?php } ?>
								start: new Date(<?php echo $y; ?>,<?php echo $m-1; ?>, <?php echo $j; ?>, <?php echo $h; ?>, <?php echo $i; ?>),
								<?php if(!isset($row['tr_title'])) { ?>
								end: new Date(<?php echo $ye; ?>,<?php echo $me-1; ?>, <?php echo $je; ?>,<?php echo $he; ?>, <?php echo $ie; ?>),
								<?php } ?>
								<?php 
									if(isset($row['tr_title'])) {
										if($row['in_status'] == 1) {
										$tr_url = base_url().'org-transportation-scheduled/'.$row['tr_title'];
										} else if($row['in_status'] == 2) {
										$tr_url = base_url().'org-confirm-transport/'.$row['tr_title'];
										} else if($row['in_status'] == 3) {
										$tr_url = base_url().'org-cancel-transport/'.$row['tr_title'];
										}
								?>
								url  : '<?php echo $tr_url; ?>',
								color:'09F'
								<?php } else { ?>
								url  : '<?php echo base_url().'organization-event-detail/'.$row['in_event_id'] ?>',
								color:'#378006'
								<?php } ?>
							},
				<?php
						}
					}
				}
				?>  
            ],
		});

	});
	</script>
 <script type="text/javascript" src="<?php echo base_url();?>assets/plugins/bootstrap-fileinput/bootstrap-fileinput.js"></script> 
<script>
$(document).ready(function() {
      $( '<a href="<?php echo base_url().'org_dashboard/create_ical/' ?>" id="ical" class="ical-info"><img src="<?php echo $base_url; ?>assets/img/ical.png" alt="iCal">iCal</a>' ).insertAfter( $( ".fc-button-agendaDay" ) );
	  $('#ical').click(function(){
		  $('#subscribe_ical').modal('show');
	  });
});
</script>



<script>
var validation_form = '0';
var alert_trans_loc = '1';
$('#product-edit').validate({ 
		errorElement: 'label', //default input error message container
		errorClass: 'help-block', // default input error message class
		focusInvalid: false, // do not focus the last invalid input
		rules: {			
			product_name: {
				required: true
			},
			product_sku: {
				required: true
			},
			product_description: {
				required: false
			},	
			prod_regular_price: {
				required: true,
				number:true
			},
			prod_discount_price: {
				required: false,
				number:true
			},
			product_imge: {
				required: true
			},			
			'sel_cat[]':{
				required:true
			},			
			prod_stock_status: {
				required: true
			},
			product_image: {
				required: false
			},
			affiliate_url:{
					required: {
								depends: function(){
									if(($('#flg_affiliate').val()=='1')){ 
										return true
									}else{
										return false
									}
								}
							}
				},
			affiliate_image_url:{
					required: {
								depends: function(){
									if(($('#flg_affiliate').val()=='1')){ 
										return true
									}else{
										return false
									}
								}
							}
				}
			
		},

		messages: {			
			product_name: {
				required: 'Please enter product name.'
			},
			product_sku: {
				required: 'Please enter SKU.'
			},
			product_description: {
				required: 'Please enter product description.'
			},		
				
			prod_regular_price: {
				required: 'Please enter regular price.',
				number:'Please enter numeric value'
			},	
			prod_discount_price: {
				required: 'Please enter discounted price.'
			},	
			product_imge: {
				required: 'Please upload product image.'
			},	
			'sel_cat[]':{
				required: 'Please select atleast one category.'
			},	
			prod_stock_status: {
				required: 'Please select stock status.'
			},
			product_image: {
				required: 'Please upload product image.'
			},
			affiliate_url: {
				required: 'Please enter affiliate product URL.'
			},
			affiliate_image_url: {
				required: 'Please enter affiliate product image URL.'
			}
		},

		invalidHandler: function (event, validator) { //display error alert on form submit   
			$('#product-edit').show();
			
			var errors = validator.numberOfInvalids();
			if (errors && alert_trans_loc=='1') {
			  var message = errors == 1
				? 'You missed 1 field. It has been highlighted'
				: 'You missed ' + errors + ' fields. They have been highlighted';
			    alert(message);
			}		
		},

		highlight: function (element) { // hightlight error inputs
			$(element)
				.closest('.form-group').addClass('has-error'); // set error class to the control group
		},

		success: function (label) { //alert(label);
			label.closest('.form-group').removeClass('has-error');
			label.remove();			
		},
		
		errorPlacement: function (error, element) { 
			//error.addClass('help-block').insertAfter(element.closest('.form-control'));//For Other Normal Fileds
			//error.addClass('help-block').insertAfter(element.closest('.input-group'));//For HTTP Filed
			 if (element.attr("name") == "sel_cat[]") { // insert checkbox errors after the container                  
	                    error.insertAfter($('#cat_error'));
	                } else if(element.attr("name") == "product_image"){
						 error.insertAfter($('#image_upload_error'));
					}else{
			error.addClass('help-block').insertAfter(element.closest('.form-control'));
			}
		}

	});	
</script>
<script>
$('#submit_1,#btnpink').click(function(){
		alert_trans_loc = '1';
		if($('#product-edit').valid() == false) {
			validation_form = '1';	
			return false;
		} else { 
		
		
			$('tbody.files tr').each(function(i, e) {
				$("#image_file").attr("value",$.trim($('.template-download').find('td .name').text()));
			});
			
			var get_image_length = $("#image_file").val().split(',');
				
			if(get_image_length.length > 11) {
				$('#uploadimage_count_err').show();
				$('html, body').animate({ scrollTop: 0 }, 'slow');
				return false;
			}		
		
			var paypal_success = '0';
			$.ajax({
				url: base_url+"products/get_org_paypal/",
				async:false,
				success:function(data) 
					{
						if(data=='no_paypal')
						{
							paypal_success='1';
						}	
					}
				});
				
			if(paypal_success=='1')
			{
				$('#paypal_email').modal('show');
				return false;
			}
		
			$('#submit').hide();
			$('#submit_1').hide();	
			$('#cancel').hide();	
			$('#btnpink').hide();	
			
			if($.browser.msie) { 
				$('.display_loader').html('<img id="loadimg1" src="<?php echo base_url(); ?>assets/img/ajax-loading.gif" alt="loader" />');
			}
			
			$('.display_loader').show();
			$('#loadimg1').show();
			//$('#loadimg').hide();			
							
			return true;
		}		
	});	
</script>
<script>
$(document).on('keyup','#paypal_emailid',function(){
	
	if($('#paypal_emailid').val()!='')
	{
		//$('#submit-term-condition').removeClass('disabled');
		$('#submit-paypal-email-unchecked').hide();
		$('#submit-paypal-email').show();
	} else {
		//$('#submit-term-condition').addClass('disabled');
		$('#submit-paypal-email-unchecked').show();
		$('#submit-paypal-email').hide();
	}	
	
});

$(document).on('click','#submit-paypal-email',function()
{
		if($('#paypal_emailid').val()!='')
		{
			var emailReg = /^([\w-\.\+]+@([\w-]+\.)+[\w-]{2,4})?$/;
			var useremail = $("#paypal_emailid").val();
			var error_message = '';	
			//if(!emailReg.test(useremail))
			if(emailReg.test(useremail))
			{
				$.ajax({
						type:'POST',
						 url: base_url+"products/update_org_paypal/",
						 dataType: "json",
						 async:false,
						 data:{
							paypal_emailid:useremail,
						 },
						 success:function(data) 
						 {
							$('#paypal_email').modal('hide');
							$('#submit_1').trigger('click');
						 }
					});	
			} else 
			{
				flag =0;
				error_message = 'Please enter valid email address. \n';
				alert(error_message);
			}										
		} else {
			alert('Please enter paypal email address');
		}	
});
</script>
<script>
$(document).ready(function(){
	
	
	var chkval2	=	 $("input[name='flg_affiliate']:checked").val();
if(chkval2=='1')
 { 	
	$("#affiliate_url").show();	
	$("#affiliate_url_label").show();	
	$("#affiliate_image_url").show();	
	$("#affiliate_image_url_label").show();
	$("#prodimg").hide();	  
	$("#galleryimg").hide();
 }
	
	
	$(document).on('click','#delete_product_image',function()
	{	
		$('#product_image').val('');	
		$('.fileinput-filename').html('');				
		$('#product_image').prop('title','Add Files...');				
		$("#delete_product_image").hide();	
		$('#product_file_input').addClass('fileinput-new').removeClass('fileinput-exists');			
	});	
	
	$(document).on('change','#product_image',function(e) {		
	$("#delete_product_image").show();
	});							
							
	$(document).on('change','#product_image',function(){
	if($('#product_image').val()!='') {
		$('#product_image').prop('title','Change');
		if(validation_form == '1')
		{
			alert_trans_loc = '0';
			$('#product-edit').valid();
		}	
	}else {
		$('#product_image').prop('title','Add Files...');
	}
	});
	
		$('#flg_affiliate').click(function(){
	var checked_status = this.checked;
	if(checked_status == true) {
	$('#affiliate_url').show();
	$('#affiliate_url_label').show();
	
	$('#affiliate_image_url').show();
	$('#affiliate_image_url_label').show();
	
	$('#prodimg').hide();
	$('#galleryimg').hide()
	}
	else{
		$('#affiliate_url').hide();
		$('#affiliate_url_label').hide();
		
		$('#affiliate_image_url').hide();
	    $('#affiliate_image_url_label').hide();
		$('#prodimg').show();
		$('#galleryimg').show()
	}
	});
});
</script>
<!-- END JAVASCRIPTS -->
</body>
<!-- END BODY -->
</html>